<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>063_DLbyABr_07-ReinforcementLearning - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/7f9cefa92f0da43a505f7213ef5a6bb5d4a409ec4e0540a0a55701946063455d/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/7f9cefa92f0da43a505f7213ef5a6bb5d4a409ec4e0540a0a55701946063455d/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/7f9cefa92f0da43a505f7213ef5a6bb5d4a409ec4e0540a0a55701946063455d/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":true,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":false,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"class-node","description":"Class Node","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"r3.xlarge","node_type_id":"r3.xlarge","description":"r3.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"r3.xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":13.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"r3.2xlarge","node_type_id":"r3.2xlarge","description":"r3.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Memory Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"r3.4xlarge","node_type_id":"r3.4xlarge","description":"r3.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"r3.4xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":52.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Memory Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"r3.8xlarge","node_type_id":"r3.8xlarge","description":"r3.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"r3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":104.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Memory Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":8079,"instance_type_id":"c3.2xlarge","node_type_id":"c3.2xlarge","description":"c3.2xlarge","support_cluster_tags":true,"container_memory_mb":10099,"node_instance_type":{"instance_type_id":"c3.2xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":28.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":15360,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":false,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":19998,"instance_type_id":"c3.4xlarge","node_type_id":"c3.4xlarge","description":"c3.4xlarge","support_cluster_tags":true,"container_memory_mb":24998,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":false,"category":"Compute Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":43837,"instance_type_id":"c3.8xlarge","node_type_id":"c3.8xlarge","description":"c3.8xlarge","support_cluster_tags":true,"container_memory_mb":54796,"node_instance_type":{"instance_type_id":"c3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":108.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":61440,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":61440,"is_hidden":false,"category":"Compute Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"i2.xlarge","node_type_id":"i2.xlarge","description":"i2.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"i2.xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":14.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Storage Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"i2.2xlarge","node_type_id":"i2.2xlarge","description":"i2.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"i2.2xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":27.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Storage Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"i2.4xlarge","node_type_id":"i2.4xlarge","description":"i2.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"i2.4xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":53.0,"number_of_ips":4,"local_disks":4,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Storage Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"i2.8xlarge","node_type_id":"i2.8xlarge","description":"i2.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"i2.8xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":104.0,"number_of_ips":4,"local_disks":8,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Storage Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"support_ssh":false,"spark_heap_memory":23800,"instance_type_id":"r3.2xlarge","node_type_id":"memory-optimized","description":"Memory Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":28000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":true,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true},{"support_ssh":false,"spark_heap_memory":9702,"instance_type_id":"c3.4xlarge","node_type_id":"compute-optimized","description":"Compute Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":12128,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":true,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true}],"default_node_type_id":"class-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":false,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2a","isDefault":true},{"id":"us-west-2c","isDefault":false},{"id":"us-west-2b","isDefault":false}],"enableCustomSpotPricingUIByTier":true,"serverlessClustersEnabled":true,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":false,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"class-node","spark_version":"3.5.x-scala2.11","num_workers":8,"autoscale":null,"aws_attributes":{"availability":"SPOT_WITH_FALLBACK","instance_profile_arn":null,"first_on_demand":5.0,"spot_bid_price_percent":100,"zone_id":"us-west-2a"},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":false,"enableBitbucketCloud":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"allowRunOnPendingClusters":true,"applications":false,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":true,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":false,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-86b4917bb6586289ca64e65f64fd23678c297274be6cd6aa6aa01d7b91fed29c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d7df74e188103a4093ff4467dbf0d32886366c984097f6997e0cd87d0f6b2fa5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-71e2fd18fdbbb732d6adec03e171846687b6ec85a572e5931e8a9ed9b62e7c32","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-a5615cb1adf0d2305f2b93188c6720174ec3e782d100fcbfa96ff870392861df","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.0, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-3961e9af697e7e97441ff848e1cc7f314c9fe21660cd2169b469dd1bbe3460f0","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-cb1b0de48b4337b75cd84f4827454e6f226f78b43fd3c31720fbfe25269244e5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (Scala 2.10)","packageLabel":"spark-image-cb1b0de48b4337b75cd84f4827454e6f226f78b43fd3c31720fbfe25269244e5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-613a129fcaa93423a4de06407c9f93e341ed5c6b02d69179d2703c8bb47e2b99","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-35a005aa7f84e9ff56e735fe14744e1835f1d4b89b8df81f936ad1d00d79561e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-0badc3d8dfc8cddd55795d02c0b31c76330cfe687d588414f91278197fbc9416","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-877b9d158b8820a94d954b4f280eb2200b22218dc153731d1e1765abc6dfaafd","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-3961e9af697e7e97441ff848e1cc7f314c9fe21660cd2169b469dd1bbe3460f0","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-6483f1872dafe4471df05d012a2836eab7b44ee6ae4080f6db4d397c0f3e647c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.0, gpu-scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-b768d65de82a89fbfabff8ec1d2f279ced527c0ec05e83c3ae0c206d2e97edc0","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":true,"enableRestrictedClusterCreation":false,"enableFeedback":false,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","tableAclsDisabledMap":{"spark.databricks.acl.dfAclsEnabled":"false"},"driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":true,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":true,"enableNotebookHistoryDiffing":true,"branch":"2.66.997","accountsLimit":-1,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":true,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":true,"enableCreateClusterOnAttach":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":true,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-4f5f9fb3a7177ac43f84a20f819e8ad76833e356707ed0b79812a2f837ac0a06","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":true,"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":false,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":true,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":false,"enableSparkConfUI":true,"enableClusterEventsUI":false,"featureTier":"UNKNOWN_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"SPOT_WITH_FALLBACK","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2a","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":true,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":false,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":-1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":true,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":false,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":true,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":true,"enableMiniClusters":false,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/7f9cefa92f0da43a505f7213ef5a6bb5d4a409ec4e0540a0a55701946063455d/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":true,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":true,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":true,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":true,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":false,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":true,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":false,"useOnDemandClustersByDefault":false,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":226754,"name":"063_DLbyABr_07-ReinforcementLearning","language":"python","commands":[{"version":"CommandV1","origId":226788,"guid":"0e43e5ee-1797-427e-a318-ba53d76b6a20","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n# [SDS-2.2, Scalable Data Science](https://lamastex.github.io/scalable-data-science/sds/2/2/)\n\nThis is used in a non-profit educational setting with kind permission of [Adam Breindel](https://www.linkedin.com/in/adbreind).\nThis is not licensed by Adam for use in a for-profit setting. Please contact Adam directly at `adbreind@gmail.com` to request or report such use cases or abuses. \nA few minor modifications and additional mathematical statistical pointers have been added by Raazesh Sainudiin when teaching PhD students in Uppsala University.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"90639f37-32b6-46e2-870e-15eef315ca54"},{"version":"CommandV1","origId":226755,"guid":"2c8c4987-95a3-4b8c-abb1-92eb9756ecb9","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Playing Games and Driving Cars: Reinforcement Learning\n\n<img src=\"https://i.imgur.com/VKEJsy6.jpg\" width=900>\n\n## In a Nutshell\n\n__In reinforcement learning, an agent takes multiple actions, and the positive or negative outcome of those actions serves as a loss function for subsequent training.__\n\n## Training an Agent\n\nWhat is an agent?\n\nHow is training an agent different from training the models we've used so far?\n\nMost things stay the same, and we can use all of the knowledge we've built:\n\n* We can use any or all of the network models, including feed-forward, convolutional, recurrent, and combinations of those.\n* We will still train in batches using some variant of gradient descent\n* As before, the model will ideally learn a complex non-obvious function of many parameters\n\nA few things change ... well, not really change, but \"specialize\":\n\n* The inputs may start out as entire frames (or frame deltas) of a video feed\n    * We may feature engineer more explicitly (or not)\n* The ouputs may be a low-cardinality set of categories that represent actions (e.g., direction of a digital joystick, or input to a small number of control systems)\n* We may model state explicitly (outside the network) as well as implicitly (inside the network)\n* The function we're learning is one which will \"tell our agent what to do\" or -- assuming there is no disconnect between knowing what to do and doing it, the function will essentially be the agent\n* __The loss function depends on the outcome of the game, and the game requires many actions to reach an outcome, and so requires some slightly different approaches from the ones we've used before.__\n\n","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973246,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"c0d8c44f-d877-49f9-b1a0-0f8602e322c4"},{"version":"CommandV1","origId":226756,"guid":"b98f5388-b597-42ba-a040-a4eefd6d3273","subtype":"command","commandType":"auto","position":2.0,"command":"%md \n# Principal Approaches: Deep Q-Learning and Policy Gradient Learning\n\n* Policy Gradient is straightforward and shows a lot of research promise, but can be quite difficult to use. The challenge is less in the math, code, or concepts, and more in terms of effective training. We'll look very briefly at PG.\n\n\n* Deep Q-Learning is more constrained and a little more complex mathematically. These factors would seem to cut against the use of DQL, but they allow for relatively fast and effective training, so they are very widely used. We'll go deeper into DQL and work with an example.\n\nThere are, of course, many variants on these as well as some other strategies.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973256,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"60bc27a4-f307-43fa-b345-74ae26c07485"},{"version":"CommandV1","origId":226757,"guid":"317fac14-a965-4045-b048-f2ae9c686f4d","subtype":"command","commandType":"auto","position":3.0,"command":"%md \n## Policy Gradient Learning\n\nWith Policy Gradient Learning, we directly try to learn a \"policy\" function that selects a (possibly continuous-valued) move for an agent to make given the current state of the \"world.\"\n\nWe want to maximize total discounted future reward, but we do not need discrete actions to take or a model that tells us a specific \"next reward.\"\n\nInstead, we can make fine-grained moves and we can collect all the moves that lead to a reward, and then apply that reward to all of them.\n\n---\n\n> __ASIDE:__ The term *gradient* here comes from a formula which indicates the gradient (or steepest direction) to improve the policy parameters with respect to the loss function. That is, which direction to adjust the parameters to maximize improvement in expected total reward.\n\n---\n\nIn some sense, this is a more straightforward, direct approach than the other approach we'll work with, Deep Q-Learning. \n\n### Challenges with Policy Gradients\n\nPolicy gradients, despite achieving remarkable results, are a form of brute-force solution.\n\nThus they require a large amount of input data and extraordinary amounts of training time.\n\nSome of these challenges come down to the *credit assignment problem* -- properly attributing reward to actions in the past which may (or may not) be responsible for the reward -- and thus some mitigations include more complex reward functions, adding more frequent reward training into the system, and adding domain knowledge to the policy, or adding an entire separate network, called a \"critic network\" to learn to provide feedback to the actor network.\n\nAnother challenge is the size of the search space, and tractable approaches to exploring it.\n\nPG is challenging to use in practice, though there are a number of \"tricks\" in various publications that you can try.\n\n### Next Steps\n\n* Great post by Andrej Karpathy on policy gradient learning: http://karpathy.github.io/2016/05/31/rl/\n\n* A nice first step on policy gradients with real code: *Using Keras and Deep Deterministic Policy Gradient to play TORCS*: https://yanpanlau.github.io/2016/10/11/Torcs-Keras.html\n\nIf you'd like to explore a variety of reinforcement learning techniques, Mattias Lappert at the Karlsruhe Institute of Technology, has created an add-on framework for Keras that implements a variety of state-of-the-art RL techniques, including discussed today.\n\nHis framework, KerasRL is at https://github.com/matthiasplappert/keras-rl and includes examples that integrate with OpenAI gym.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973267,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"15b660c6-6140-4534-9590-1c86406de4cb"},{"version":"CommandV1","origId":226758,"guid":"216b93eb-0c24-4999-a7aa-66e6a0fc209a","subtype":"command","commandType":"auto","position":4.0,"command":"%md \n## Deep Q-Learning\n\nDeep Q-Learning is deep learning applied to \"Q-Learning.\" \n\nSo what is Q-Learning?\n\nQ-Learning is a model that posits a map for optimal actions for each possible state in a game.\n\nSpecifically, given a state and an action, there is a \"Q-function\" that provides the value or quality (the Q stands for quality) of that action taken in that state.\n\nSo, if an agent is in state s, choosing an action could be as simple as looking at Q(s, a) for all a, and choosing the highest \"quality value\" -- aka <img src=\"https://i.imgur.com/RerRQzk.png\" width=110>\n\nThere are some other considerations, such as explore-exploit tradeoff, but let's focus on this Q function.\n\nIn small state spaces, this function can be represented as a table, a bit like basic strategy blackjack tables.\n\n<img src=\"http://i.imgur.com/rfxLSls.png\" width=400>\n\nEven a simple Atari-style video game may have hundreds of thousands of states, though. This is where the neural network comes in.\n\n__What we need is a way to learn a Q function, when we don't know what the error of a particular move is, since the error (loss) may be dependent on many future actions and can also be non-deterministic (e.g., if there are randomly generated enemies or conditions in the game).__\n\nThe tricks -- or insights -- here are:\n\n[1] Model the total future reward -- what we're really after -- as a recursive calculation from the immediate reward (*r*) and future outcomes:\n\n<img src=\"https://i.imgur.com/ePXoQfR.png\" width=250>\n    \n* \\\\({\\gamma}\\\\) is a \"discount factor\" on future reward\n* Assume the game terminates or \"effectively terminates\" to make the recursion tractable\n* This equation is a simplified case of the Bellman Equation\n    \n[2] Assume that if you iteratively run this process starting with an arbitrary Q model, and you train the Q model with actual outcomes, your Q model will eventually converge toward the \"true\" Q function\n* This seems intuitively to resemble various Monte Carlo sampling methods (if that helps at all)\n\n#### As improbable as this might seem at first for teaching an agent a complex game or task, it actually works, and in a straightforward way.\n\nHow do we apply this to our neural network code?\n\nUnlike before, when we called \"fit\" to train a network automatically, here we'll need some interplay between the agent's behavior in the game and the training. That is, we need the agent to play some moves in order to get actual numbers to train with. And as soon as we have some actual numbers, we want to do a little training with them right away so that our Q function improves. So we'll alternate one or more in-game actions with a manual call to train on a single batch of data.\n\nThe algorithm looks like this (credit for the nice summary to Tambet Matiisen; read his longer explanation at https://neuro.cs.ut.ee/demystifying-deep-reinforcement-learning/ for review):\n\n1. Do a feedforward pass for the current state s to get predicted Q-values for all actions.\n2. Do a feedforward pass for the next state s and calculate maximum over all network outputs <img src=\"https://i.imgur.com/3QiH4Z1.png\" width=110>\n3. Set Q-value target for action a to <img src=\"https://i.imgur.com/2RNmkl6.png\" width=140> (use the max calculated in step 2). For all other actions, set the Q-value target to the same as originally returned from step 1, making the error 0 for those outputs.\n4. Update the weights using backpropagation.\n\nIf there is \"reward\" throughout the game, we can model the loss as \n\n<img src=\"https://i.imgur.com/OojwPbJ.png\" width=350>\n\nIf the game is win/lose only ... most of the r's go away and the entire loss is based on a 0/1 or -1/1 score at the end of a game.\n\n### Practical Consideration 1: Experience Replay\n\nTo improve training, we cache all (or as much as possible) of the agent's state/move/reward/next-state data. Then, when we go to perform a training run, we can build a batch out of a subset of all previous moves. This provides diversity in the training data, whose value we discussed earlier.\n\n### Practical Consideration 2: Explore-Exploit Balance\n\nIn order to add more diversity to the agent's actions, we set a threshold (\"epsilon\") which represents the probability that the agent ignores its experience-based model and just chooses a random action. This also add diversity, by preventing the agent from taking an overly-narrow, 100% greedy (best-perfomance-so-far) path.\n\n### Let's Look at the Code!\n\nReinforcement learning code examples are a bit more complex than the other examples we've seen so far, because in the other examples, the data sets (training and test) exist outside the program as assets (e.g., the MNIST digit data).\n\nIn reinforcement learning, the training and reward data come from some environment that the agent is supposed to learn. Typically, the environment is simulated by local code, or *represented by local code* even if the real environment is remote or comes from the physical world via sensors. \n\n#### So the code contains not just the neural net and training logic, but part (or all) of a game world itself.\n\nOne of the most elegant small, but complete, examples comes courtesy of former Ph.D. researcher (Univ. of Florida) and Apple rockstar Eder Santana. It's a simplified catch-the-falling-brick game (a bit like Atari Kaboom! but even simpler) that nevertheless is complex enough to illustrate DQL and to be impressive in action.\n\nWhen we're done, we'll basically have a game, and an agent that plays, which run like this:\n\n<img src=\"http://i.imgur.com/PB6OgNF.gif\">","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973288,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"54d15f62-5bfe-44cd-a6e7-0120e590205d"},{"version":"CommandV1","origId":226759,"guid":"90bfdc29-567e-43bc-a277-fc92f7a155a7","subtype":"command","commandType":"auto","position":4.25,"command":"%md\n\nFirst, let's get familiar with the game environment itself, since we'll need to see how it works, before we can focus on the reinforcement learning part of the program.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973298,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3216b079-250d-470c-a914-876001939495"},{"version":"CommandV1","origId":226760,"guid":"cf6d65b5-66c3-4227-a155-ee3a2078c5c8","subtype":"command","commandType":"auto","position":5.0,"command":"class Catch(object):\n    def __init__(self, grid_size=10):\n        self.grid_size = grid_size\n        self.reset()\n\n    def _update_state(self, action):\n        \"\"\"\n        Input: action and states\n        Ouput: new states and reward\n        \"\"\"\n        state = self.state\n        if action == 0:  # left\n            action = -1\n        elif action == 1:  # stay\n            action = 0\n        else:\n            action = 1  # right\n        f0, f1, basket = state[0]\n        new_basket = min(max(1, basket + action), self.grid_size-1)\n        f0 += 1\n        out = np.asarray([f0, f1, new_basket])\n        out = out[np.newaxis]\n\n        assert len(out.shape) == 2\n        self.state = out\n\n    def _draw_state(self):\n        im_size = (self.grid_size,)*2\n        state = self.state[0]\n        canvas = np.zeros(im_size)\n        canvas[state[0], state[1]] = 1  # draw fruit\n        canvas[-1, state[2]-1:state[2] + 2] = 1  # draw basket\n        return canvas\n\n    def _get_reward(self):\n        fruit_row, fruit_col, basket = self.state[0]\n        if fruit_row == self.grid_size-1:\n            if abs(fruit_col - basket) <= 1:\n                return 1\n            else:\n                return -1\n        else:\n            return 0\n\n    def _is_over(self):\n        if self.state[0, 0] == self.grid_size-1:\n            return True\n        else:\n            return False\n\n    def observe(self):\n        canvas = self._draw_state()\n        return canvas.reshape((1, -1))\n\n    def act(self, action):\n        self._update_state(action)\n        reward = self._get_reward()\n        game_over = self._is_over()\n        return self.observe(), reward, game_over\n\n    def reset(self):\n        n = np.random.randint(0, self.grid_size-1, size=1)\n        m = np.random.randint(1, self.grid_size-2, size=1)\n        self.state = np.asarray([0, n, m])[np.newaxis]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506125973662,"submitTime":1506125973308,"finishTime":1506125973804,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":true,"deletable":true,"editable":true},"streamStates":{},"nuid":"ce908463-8514-45d3-83ef-92cb84ade34a"},{"version":"CommandV1","origId":226761,"guid":"8f8b867b-e37e-4c39-a91d-d497cc757e52","subtype":"command","commandType":"auto","position":6.0,"command":"%md \nNext, let's look at the network itself -- it's super simple, so we can get that out of the way too:\n\n```\nmodel = Sequential()\nmodel.add(Dense(hidden_size, input_shape=(grid_size**2,), activation='relu'))\nmodel.add(Dense(hidden_size, activation='relu'))\nmodel.add(Dense(num_actions))\nmodel.compile(sgd(lr=.2), \"mse\")\n```","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973312,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"a3db1a2b-4c2a-46a7-8ea0-0d9bd2b4132f"},{"version":"CommandV1","origId":226762,"guid":"9d2115e9-0a06-4762-9f33-ea3d8aa4caf7","subtype":"command","commandType":"auto","position":8.0,"command":"%md \nNote that the output layer has `num_actions` neurons. \n\nWe are going to implement the training target as \n\n* the estimated reward for the one action taken when the game doesn't conclude, or \n* error/reward for the specific action that loses/wins a game\n\nIn any case, we only train with an error/reward for actions the agent actually chose. We neutralize the hypothetical rewards for other actions, as they are not causally chained to any ground truth.\n\nNext, let's zoom in on at the main game training loop:\n\n```\nwin_cnt = 0\nfor e in range(epoch):\n    loss = 0.\n    env.reset()\n    game_over = False\n    # get initial input\n    input_t = env.observe()\n\n    while not game_over:\n        input_tm1 = input_t\n        # get next action\n        if np.random.rand() <= epsilon:\n            action = np.random.randint(0, num_actions, size=1)\n        else:\n            q = model.predict(input_tm1)\n            action = np.argmax(q[0])\n\n        # apply action, get rewards and new state\n        input_t, reward, game_over = env.act(action)\n        if reward == 1:\n            win_cnt += 1\n\n        # store experience\n        exp_replay.remember([input_tm1, action, reward, input_t], game_over)\n\n        # adapt model\n        inputs, targets = exp_replay.get_batch(model, batch_size=batch_size)\n\n        loss += model.train_on_batch(inputs, targets)\n    print(\"Epoch {:03d}/{:d} | Loss {:.4f} | Win count {}\".format(e, epoch - 1, loss, win_cnt))\n```","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973331,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"af86b293-1c07-42e6-abd9-430f2b9c2220"},{"version":"CommandV1","origId":226763,"guid":"876bd285-8a3a-4159-a5fb-d2a04666a7a9","subtype":"command","commandType":"auto","position":10.0,"command":"%md \nThe key bits are:\n\n* Choose an action\n* Act and collect the reward and new state\n* Cache previous state, action, reward, and new state in \"Experience Replay\" buffer\n* Ask buffer for a batch of action data to train on\n* Call `model.train_on_batch` to perform one training batch\n\nLast, let's dive into where the actual Q-Learning calculations occur, which happen, in this code to be in the `get_batch` call to the experience replay buffer object:","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973350,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"1b79bfae-6fbc-44e4-830c-8cfe65de02c4"},{"version":"CommandV1","origId":226764,"guid":"4124143f-e38c-44e3-95e4-3e29c0a7b500","subtype":"command","commandType":"auto","position":11.0,"command":"class ExperienceReplay(object):\n    def __init__(self, max_memory=100, discount=.9):\n        self.max_memory = max_memory\n        self.memory = list()\n        self.discount = discount\n\n    def remember(self, states, game_over):\n        # memory[i] = [[state_t, action_t, reward_t, state_t+1], game_over?]\n        self.memory.append([states, game_over])\n        if len(self.memory) > self.max_memory:\n            del self.memory[0]\n\n    def get_batch(self, model, batch_size=10):\n        len_memory = len(self.memory)\n        num_actions = model.output_shape[-1]\n        env_dim = self.memory[0][0][0].shape[1]\n        inputs = np.zeros((min(len_memory, batch_size), env_dim))\n        targets = np.zeros((inputs.shape[0], num_actions))\n        for i, idx in enumerate(np.random.randint(0, len_memory,\n                                                  size=inputs.shape[0])):\n            state_t, action_t, reward_t, state_tp1 = self.memory[idx][0]\n            game_over = self.memory[idx][1]\n\n            inputs[i:i+1] = state_t\n            # There should be no target values for actions not taken.\n            # Thou shalt not correct actions not taken #deep\n            targets[i] = model.predict(state_t)[0]\n            Q_sa = np.max(model.predict(state_tp1)[0])\n            if game_over:  # if game_over is True\n                targets[i, action_t] = reward_t\n            else:\n                # reward_t + gamma * max_a' Q(s', a')\n                targets[i, action_t] = reward_t + self.discount * Q_sa\n        return inputs, targets","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506125973809,"submitTime":1506125973359,"finishTime":1506125973846,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":true,"deletable":true,"editable":true},"streamStates":{},"nuid":"1461b0c7-0901-450a-83e4-beb61bb5e644"},{"version":"CommandV1","origId":226765,"guid":"ab9e72c9-2364-47d9-86ae-eb820f6a3e7d","subtype":"command","commandType":"auto","position":12.0,"command":"%md \nThe key bits here are:\n\n* Set up \"blank\" buffers for a set of items of the requested batch size, or all memory, whichever is less (in case we don't have much data yet)\n    * one buffer is `inputs` -- it will contain the game state or screen before the agent acted\n    * the other buffer is `targets` -- it will contain a vector of rewards-per-action (with just one non-zero entry, for the action the agent actually took)\n* Based on that batch size, randomly select records from memory\n* For each of those cached records (which contain initial state, action, next state, and reward),\n    * Insert the initial game state into the proper place in the `inputs` buffer\n    * If the action ended the game then:\n        * Insert a vector into `targets` with the real reward in the position of the action chosen\n    * Else (if the action did not end the game):\n        * Insert a vector into `targets` with the following value in the position of the action taken:\n            * *(real reward)*\n            * __+__ *(discount factor)(predicted-reward-for-best-action-in-the-next-state)*\n        * __Note__: although the Q-Learning formula is implemented in the general version here, this specific game only produces reward when the game is over, so the \"real reward\" in this branch will always be zero\n        \n","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973363,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"7e69941c-7cf8-4ee3-acc5-d845fdfeed9e"},{"version":"CommandV1","origId":226766,"guid":"8c70e05b-44bd-4e6e-8025-048ce6616a6e","subtype":"command","commandType":"auto","position":12.125,"command":"mkdir /dbfs/keras_rl","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">notebook:1: error: value mkdir is not a member of com.databricks.dbutils_v1.DbfsUtils\ndbutils.fs.mkdir(&quot;/keral_rl&quot;, &quot;%fs&quot;, &quot;mkdir&quot;, &quot;/keras_rl/images&quot;)\n           ^\n</div>","error":null,"workflows":[],"startTime":1506126277370,"submitTime":1506126277355,"finishTime":1506126277599,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8de94c52-2bb4-4c5b-921a-e8168b5e9c02"},{"version":"CommandV1","origId":226767,"guid":"a769f8ea-6d12-4c38-93d8-01d743249f40","subtype":"command","commandType":"auto","position":12.1875,"command":"mkdir /dbfs/keras_rl/images","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506126281549,"submitTime":1506126281533,"finishTime":1506126281824,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a31bcfb9-4445-4042-a161-3f5ddf9c1752"},{"version":"CommandV1","origId":226768,"guid":"3eb78bfa-ea10-4b5b-8f97-a007b6737a7b","subtype":"command","commandType":"auto","position":12.25,"command":"%md \nOk, now let's run the main training script and teach Keras to play Catch:","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973373,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0ba78d62-28d3-4fa9-a715-6ca443336884"},{"version":"CommandV1","origId":226769,"guid":"1d442e6b-f67a-44d5-bc64-436c60937f6d","subtype":"command","commandType":"auto","position":12.375,"command":"import json\nimport numpy as np\nfrom keras.models import Sequential\nfrom keras.layers.core import Dense\nfrom keras.optimizers import sgd\nimport collections\n\nepsilon = .1  # exploration\nnum_actions = 3  # [move_left, stay, move_right]\nepoch = 400\nmax_memory = 500\nhidden_size = 100\nbatch_size = 50\ngrid_size = 10\n\nmodel = Sequential()\nmodel.add(Dense(hidden_size, input_shape=(grid_size**2,), activation='relu'))\nmodel.add(Dense(hidden_size, activation='relu'))\nmodel.add(Dense(num_actions))\nmodel.compile(loss='mse', optimizer='adam')\n\n# Define environment/game\nenv = Catch(grid_size)\n\n# Initialize experience replay object\nexp_replay = ExperienceReplay(max_memory=max_memory)\n\n# Train\nwin_cnt = 0\nlast_ten = collections.deque(maxlen=10)\n\nfor e in range(epoch):\n    loss = 0.\n    env.reset()\n    game_over = False\n    # get initial input\n    input_t = env.observe()\n\n    while not game_over:\n        input_tm1 = input_t\n        # get next action\n        if np.random.rand() <= epsilon:\n            action = np.random.randint(0, num_actions, size=1)\n        else:\n            q = model.predict(input_tm1)\n            action = np.argmax(q[0])\n\n        # apply action, get rewards and new state\n        input_t, reward, game_over = env.act(action)\n        if reward == 1:\n            win_cnt += 1            \n\n        # store experience\n        exp_replay.remember([input_tm1, action, reward, input_t], game_over)\n\n        # adapt model\n        inputs, targets = exp_replay.get_batch(model, batch_size=batch_size)\n\n        loss += model.train_on_batch(inputs, targets)\n        \n    last_ten.append((reward+1)/2)\n    print(\"Epoch {:03d}/{:d} | Loss {:.4f} | Win count {} | Last 10 win rate {}\".format(e, epoch - 1, loss, win_cnt, sum(last_ten)/10.0))\n\n# Save trained model weights and architecture\nmodel.save_weights(\"/dbfs/keras_rl/model.h5\", overwrite=True)\nwith open(\"/dbfs/keras_rl/model.json\", \"w\") as outfile:\n    json.dump(model.to_json(), outfile)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Epoch 000/399 | Loss 0.0045 | Win count 0 | Last 10 win rate 0.0\nEpoch 001/399 | Loss 0.1900 | Win count 0 | Last 10 win rate 0.0\nEpoch 002/399 | Loss 0.1805 | Win count 1 | Last 10 win rate 0.1\nEpoch 003/399 | Loss 0.1129 | Win count 2 | Last 10 win rate 0.2\nEpoch 004/399 | Loss 0.1337 | Win count 2 | Last 10 win rate 0.2\nEpoch 005/399 | Loss 0.0792 | Win count 2 | Last 10 win rate 0.2\nEpoch 006/399 | Loss 0.0973 | Win count 2 | Last 10 win rate 0.2\nEpoch 007/399 | Loss 0.1345 | Win count 2 | Last 10 win rate 0.2\nEpoch 008/399 | Loss 0.1037 | Win count 2 | Last 10 win rate 0.2\nEpoch 009/399 | Loss 0.1151 | Win count 2 | Last 10 win rate 0.2\nEpoch 010/399 | Loss 0.1187 | Win count 2 | Last 10 win rate 0.2\nEpoch 011/399 | Loss 0.1733 | Win count 2 | Last 10 win rate 0.2\nEpoch 012/399 | Loss 0.1186 | Win count 2 | Last 10 win rate 0.1\nEpoch 013/399 | Loss 0.0900 | Win count 3 | Last 10 win rate 0.1\nEpoch 014/399 | Loss 0.0824 | Win count 3 | Last 10 win rate 0.1\nEpoch 015/399 | Loss 0.0650 | Win count 4 | Last 10 win rate 0.2\nEpoch 016/399 | Loss 0.0463 | Win count 4 | Last 10 win rate 0.2\nEpoch 017/399 | Loss 0.0521 | Win count 4 | Last 10 win rate 0.2\nEpoch 018/399 | Loss 0.0642 | Win count 4 | Last 10 win rate 0.2\nEpoch 019/399 | Loss 0.0674 | Win count 5 | Last 10 win rate 0.3\nEpoch 020/399 | Loss 0.0573 | Win count 5 | Last 10 win rate 0.3\nEpoch 021/399 | Loss 0.0599 | Win count 5 | Last 10 win rate 0.3\nEpoch 022/399 | Loss 0.0568 | Win count 6 | Last 10 win rate 0.4\nEpoch 023/399 | Loss 0.0732 | Win count 6 | Last 10 win rate 0.3\nEpoch 024/399 | Loss 0.0603 | Win count 6 | Last 10 win rate 0.3\nEpoch 025/399 | Loss 0.0554 | Win count 6 | Last 10 win rate 0.2\nEpoch 026/399 | Loss 0.0619 | Win count 6 | Last 10 win rate 0.2\nEpoch 027/399 | Loss 0.0397 | Win count 6 | Last 10 win rate 0.2\nEpoch 028/399 | Loss 0.0417 | Win count 6 | Last 10 win rate 0.2\nEpoch 029/399 | Loss 0.0541 | Win count 6 | Last 10 win rate 0.1\nEpoch 030/399 | Loss 0.0303 | Win count 6 | Last 10 win rate 0.1\nEpoch 031/399 | Loss 0.0263 | Win count 7 | Last 10 win rate 0.2\nEpoch 032/399 | Loss 0.0183 | Win count 7 | Last 10 win rate 0.1\nEpoch 033/399 | Loss 0.0232 | Win count 8 | Last 10 win rate 0.2\nEpoch 034/399 | Loss 0.0203 | Win count 8 | Last 10 win rate 0.2\nEpoch 035/399 | Loss 0.0198 | Win count 8 | Last 10 win rate 0.2\nEpoch 036/399 | Loss 0.0178 | Win count 8 | Last 10 win rate 0.2\nEpoch 037/399 | Loss 0.0234 | Win count 8 | Last 10 win rate 0.2\nEpoch 038/399 | Loss 0.0260 | Win count 9 | Last 10 win rate 0.3\nEpoch 039/399 | Loss 0.0911 | Win count 10 | Last 10 win rate 0.4\nEpoch 040/399 | Loss 0.0904 | Win count 10 | Last 10 win rate 0.4\nEpoch 041/399 | Loss 0.0636 | Win count 11 | Last 10 win rate 0.4\nEpoch 042/399 | Loss 0.0539 | Win count 11 | Last 10 win rate 0.4\nEpoch 043/399 | Loss 0.0503 | Win count 11 | Last 10 win rate 0.3\nEpoch 044/399 | Loss 0.0507 | Win count 12 | Last 10 win rate 0.4\nEpoch 045/399 | Loss 0.0959 | Win count 12 | Last 10 win rate 0.4\nEpoch 046/399 | Loss 0.0415 | Win count 12 | Last 10 win rate 0.4\nEpoch 047/399 | Loss 0.0503 | Win count 13 | Last 10 win rate 0.5\nEpoch 048/399 | Loss 0.0627 | Win count 13 | Last 10 win rate 0.4\nEpoch 049/399 | Loss 0.0569 | Win count 13 | Last 10 win rate 0.3\nEpoch 050/399 | Loss 0.0659 | Win count 14 | Last 10 win rate 0.4\nEpoch 051/399 | Loss 0.0629 | Win count 14 | Last 10 win rate 0.3\nEpoch 052/399 | Loss 0.0543 | Win count 15 | Last 10 win rate 0.4\nEpoch 053/399 | Loss 0.0309 | Win count 16 | Last 10 win rate 0.5\nEpoch 054/399 | Loss 0.0497 | Win count 17 | Last 10 win rate 0.5\nEpoch 055/399 | Loss 0.0215 | Win count 18 | Last 10 win rate 0.6\nEpoch 056/399 | Loss 0.0631 | Win count 18 | Last 10 win rate 0.6\nEpoch 057/399 | Loss 0.0329 | Win count 19 | Last 10 win rate 0.6\nEpoch 058/399 | Loss 0.0481 | Win count 19 | Last 10 win rate 0.6\nEpoch 059/399 | Loss 0.0282 | Win count 19 | Last 10 win rate 0.6\nEpoch 060/399 | Loss 0.0253 | Win count 19 | Last 10 win rate 0.5\nEpoch 061/399 | Loss 0.0304 | Win count 20 | Last 10 win rate 0.6\nEpoch 062/399 | Loss 0.0490 | Win count 21 | Last 10 win rate 0.6\nEpoch 063/399 | Loss 0.0416 | Win count 21 | Last 10 win rate 0.5\nEpoch 064/399 | Loss 0.0414 | Win count 22 | Last 10 win rate 0.5\nEpoch 065/399 | Loss 0.0308 | Win count 22 | Last 10 win rate 0.4\nEpoch 066/399 | Loss 0.0462 | Win count 23 | Last 10 win rate 0.5\nEpoch 067/399 | Loss 0.0333 | Win count 24 | Last 10 win rate 0.5\nEpoch 068/399 | Loss 0.0482 | Win count 25 | Last 10 win rate 0.6\nEpoch 069/399 | Loss 0.0359 | Win count 26 | Last 10 win rate 0.7\nEpoch 070/399 | Loss 0.0506 | Win count 27 | Last 10 win rate 0.8\nEpoch 071/399 | Loss 0.0424 | Win count 27 | Last 10 win rate 0.7\nEpoch 072/399 | Loss 0.0423 | Win count 28 | Last 10 win rate 0.7\nEpoch 073/399 | Loss 0.0531 | Win count 28 | Last 10 win rate 0.7\nEpoch 074/399 | Loss 0.0606 | Win count 29 | Last 10 win rate 0.7\nEpoch 075/399 | Loss 0.0381 | Win count 29 | Last 10 win rate 0.7\nEpoch 076/399 | Loss 0.0580 | Win count 30 | Last 10 win rate 0.7\nEpoch 077/399 | Loss 0.0548 | Win count 30 | Last 10 win rate 0.6\nEpoch 078/399 | Loss 0.0511 | Win count 30 | Last 10 win rate 0.5\nEpoch 079/399 | Loss 0.0362 | Win count 31 | Last 10 win rate 0.5\nEpoch 080/399 | Loss 0.0326 | Win count 32 | Last 10 win rate 0.5\nEpoch 081/399 | Loss 0.0731 | Win count 33 | Last 10 win rate 0.6\nEpoch 082/399 | Loss 0.0619 | Win count 34 | Last 10 win rate 0.6\nEpoch 083/399 | Loss 0.0462 | Win count 34 | Last 10 win rate 0.6\nEpoch 084/399 | Loss 0.0442 | Win count 35 | Last 10 win rate 0.6\nEpoch 085/399 | Loss 0.0463 | Win count 35 | Last 10 win rate 0.6\nEpoch 086/399 | Loss 0.0309 | Win count 35 | Last 10 win rate 0.5\nEpoch 087/399 | Loss 0.0505 | Win count 35 | Last 10 win rate 0.5\nEpoch 088/399 | Loss 0.0317 | Win count 36 | Last 10 win rate 0.6\nEpoch 089/399 | Loss 0.0357 | Win count 36 | Last 10 win rate 0.5\nEpoch 090/399 | Loss 0.0367 | Win count 36 | Last 10 win rate 0.4\nEpoch 091/399 | Loss 0.0445 | Win count 36 | Last 10 win rate 0.3\nEpoch 092/399 | Loss 0.0501 | Win count 37 | Last 10 win rate 0.3\nEpoch 093/399 | Loss 0.0396 | Win count 38 | Last 10 win rate 0.4\nEpoch 094/399 | Loss 0.0432 | Win count 39 | Last 10 win rate 0.4\nEpoch 095/399 | Loss 0.0402 | Win count 40 | Last 10 win rate 0.5\nEpoch 096/399 | Loss 0.0384 | Win count 41 | Last 10 win rate 0.6\nEpoch 097/399 | Loss 0.0394 | Win count 41 | Last 10 win rate 0.6\nEpoch 098/399 | Loss 0.0357 | Win count 41 | Last 10 win rate 0.5\nEpoch 099/399 | Loss 0.0835 | Win count 41 | Last 10 win rate 0.5\nEpoch 100/399 | Loss 0.0511 | Win count 42 | Last 10 win rate 0.6\nEpoch 101/399 | Loss 0.0407 | Win count 43 | Last 10 win rate 0.7\nEpoch 102/399 | Loss 0.0512 | Win count 44 | Last 10 win rate 0.7\nEpoch 103/399 | Loss 0.0591 | Win count 45 | Last 10 win rate 0.7\nEpoch 104/399 | Loss 0.0528 | Win count 46 | Last 10 win rate 0.7\nEpoch 105/399 | Loss 0.0395 | Win count 47 | Last 10 win rate 0.7\nEpoch 106/399 | Loss 0.0425 | Win count 48 | Last 10 win rate 0.7\nEpoch 107/399 | Loss 0.0343 | Win count 49 | Last 10 win rate 0.8\nEpoch 108/399 | Loss 0.0261 | Win count 49 | Last 10 win rate 0.8\nEpoch 109/399 | Loss 0.0483 | Win count 50 | Last 10 win rate 0.9\nEpoch 110/399 | Loss 0.0345 | Win count 51 | Last 10 win rate 0.9\nEpoch 111/399 | Loss 0.0197 | Win count 52 | Last 10 win rate 0.9\nEpoch 112/399 | Loss 0.0268 | Win count 53 | Last 10 win rate 0.9\nEpoch 113/399 | Loss 0.0211 | Win count 54 | Last 10 win rate 0.9\nEpoch 114/399 | Loss 0.0496 | Win count 55 | Last 10 win rate 0.9\nEpoch 115/399 | Loss 0.0308 | Win count 56 | Last 10 win rate 0.9\nEpoch 116/399 | Loss 0.0335 | Win count 56 | Last 10 win rate 0.8\nEpoch 117/399 | Loss 0.0232 | Win count 56 | Last 10 win rate 0.7\nEpoch 118/399 | Loss 0.0375 | Win count 57 | Last 10 win rate 0.8\nEpoch 119/399 | Loss 0.0338 | Win count 58 | Last 10 win rate 0.8\nEpoch 120/399 | Loss 0.0230 | Win count 58 | Last 10 win rate 0.7\nEpoch 121/399 | Loss 0.0271 | Win count 59 | Last 10 win rate 0.7\nEpoch 122/399 | Loss 0.0239 | Win count 59 | Last 10 win rate 0.6\nEpoch 123/399 | Loss 0.0269 | Win count 60 | Last 10 win rate 0.6\nEpoch 124/399 | Loss 0.0190 | Win count 60 | Last 10 win rate 0.5\nEpoch 125/399 | Loss 0.0229 | Win count 61 | Last 10 win rate 0.5\nEpoch 126/399 | Loss 0.0446 | Win count 61 | Last 10 win rate 0.5\nEpoch 127/399 | Loss 0.0436 | Win count 62 | Last 10 win rate 0.6\nEpoch 128/399 | Loss 0.0150 | Win count 63 | Last 10 win rate 0.6\nEpoch 129/399 | Loss 0.0115 | Win count 64 | Last 10 win rate 0.6\nEpoch 130/399 | Loss 0.0299 | Win count 64 | Last 10 win rate 0.6\nEpoch 131/399 | Loss 0.0246 | Win count 65 | Last 10 win rate 0.6\nEpoch 132/399 | Loss 0.0349 | Win count 65 | Last 10 win rate 0.6\nEpoch 133/399 | Loss 0.0355 | Win count 66 | Last 10 win rate 0.6\nEpoch 134/399 | Loss 0.0308 | Win count 67 | Last 10 win rate 0.7\nEpoch 135/399 | Loss 0.0190 | Win count 68 | Last 10 win rate 0.7\nEpoch 136/399 | Loss 0.0224 | Win count 69 | Last 10 win rate 0.8\nEpoch 137/399 | Loss 0.0223 | Win count 70 | Last 10 win rate 0.8\nEpoch 138/399 | Loss 0.0165 | Win count 71 | Last 10 win rate 0.8\nEpoch 139/399 | Loss 0.0179 | Win count 72 | Last 10 win rate 0.8\nEpoch 140/399 | Loss 0.0197 | Win count 73 | Last 10 win rate 0.9\nEpoch 141/399 | Loss 0.0184 | Win count 74 | Last 10 win rate 0.9\nEpoch 142/399 | Loss 0.0133 | Win count 75 | Last 10 win rate 1.0\nEpoch 143/399 | Loss 0.0144 | Win count 75 | Last 10 win rate 0.9\nEpoch 144/399 | Loss 0.0133 | Win count 76 | Last 10 win rate 0.9\nEpoch 145/399 | Loss 0.0114 | Win count 77 | Last 10 win rate 0.9\nEpoch 146/399 | Loss 0.0161 | Win count 77 | Last 10 win rate 0.8\nEpoch 147/399 | Loss 0.0098 | Win count 78 | Last 10 win rate 0.8\nEpoch 148/399 | Loss 0.0096 | Win count 79 | Last 10 win rate 0.8\nEpoch 149/399 | Loss 0.0081 | Win count 80 | Last 10 win rate 0.8\nEpoch 150/399 | Loss 0.0138 | Win count 81 | Last 10 win rate 0.8\nEpoch 151/399 | Loss 0.0092 | Win count 82 | Last 10 win rate 0.8\nEpoch 152/399 | Loss 0.0054 | Win count 83 | Last 10 win rate 0.8\nEpoch 153/399 | Loss 0.0103 | Win count 84 | Last 10 win rate 0.9\nEpoch 154/399 | Loss 0.0081 | Win count 85 | Last 10 win rate 0.9\nEpoch 155/399 | Loss 0.0070 | Win count 86 | Last 10 win rate 0.9\nEpoch 156/399 | Loss 0.0057 | Win count 87 | Last 10 win rate 1.0\nEpoch 157/399 | Loss 0.0070 | Win count 88 | Last 10 win rate 1.0\nEpoch 158/399 | Loss 0.0057 | Win count 89 | Last 10 win rate 1.0\nEpoch 159/399 | Loss 0.0062 | Win count 89 | Last 10 win rate 0.9\nEpoch 160/399 | Loss 0.0061 | Win count 90 | Last 10 win rate 0.9\nEpoch 161/399 | Loss 0.0272 | Win count 91 | Last 10 win rate 0.9\nEpoch 162/399 | Loss 0.0384 | Win count 92 | Last 10 win rate 0.9\nEpoch 163/399 | Loss 0.0477 | Win count 92 | Last 10 win rate 0.8\nEpoch 164/399 | Loss 0.0253 | Win count 93 | Last 10 win rate 0.8\nEpoch 165/399 | Loss 0.0402 | Win count 94 | Last 10 win rate 0.8\nEpoch 166/399 | Loss 0.0296 | Win count 95 | Last 10 win rate 0.8\nEpoch 167/399 | Loss 0.0295 | Win count 96 | Last 10 win rate 0.8\nEpoch 168/399 | Loss 0.0253 | Win count 97 | Last 10 win rate 0.8\nEpoch 169/399 | Loss 0.0148 | Win count 98 | Last 10 win rate 0.9\nEpoch 170/399 | Loss 0.0234 | Win count 98 | Last 10 win rate 0.8\nEpoch 171/399 | Loss 0.0184 | Win count 98 | Last 10 win rate 0.7\nEpoch 172/399 | Loss 0.0251 | Win count 99 | Last 10 win rate 0.7\nEpoch 173/399 | Loss 0.0122 | Win count 100 | Last 10 win rate 0.8\nEpoch 174/399 | Loss 0.0150 | Win count 101 | Last 10 win rate 0.8\nEpoch 175/399 | Loss 0.0154 | Win count 101 | Last 10 win rate 0.7\nEpoch 176/399 | Loss 0.0168 | Win count 102 | Last 10 win rate 0.7\nEpoch 177/399 | Loss 0.0354 | Win count 103 | Last 10 win rate 0.7\nEpoch 178/399 | Loss 0.0297 | Win count 104 | Last 10 win rate 0.7\nEpoch 179/399 | Loss 0.0131 | Win count 105 | Last 10 win rate 0.7\nEpoch 180/399 | Loss 0.0118 | Win count 106 | Last 10 win rate 0.8\nEpoch 181/399 | Loss 0.0097 | Win count 107 | Last 10 win rate 0.9\nEpoch 182/399 | Loss 0.0101 | Win count 108 | Last 10 win rate 0.9\nEpoch 183/399 | Loss 0.0185 | Win count 109 | Last 10 win rate 0.9\nEpoch 184/399 | Loss 0.0078 | Win count 110 | Last 10 win rate 0.9\nEpoch 185/399 | Loss 0.0072 | Win count 111 | Last 10 win rate 1.0\nEpoch 186/399 | Loss 0.0140 | Win count 112 | Last 10 win rate 1.0\nEpoch 187/399 | Loss 0.0130 | Win count 113 | Last 10 win rate 1.0\nEpoch 188/399 | Loss 0.0163 | Win count 114 | Last 10 win rate 1.0\nEpoch 189/399 | Loss 0.0136 | Win count 115 | Last 10 win rate 1.0\nEpoch 190/399 | Loss 0.0190 | Win count 116 | Last 10 win rate 1.0\nEpoch 191/399 | Loss 0.0265 | Win count 117 | Last 10 win rate 1.0\nEpoch 192/399 | Loss 0.0175 | Win count 118 | Last 10 win rate 1.0\nEpoch 193/399 | Loss 0.0116 | Win count 119 | Last 10 win rate 1.0\nEpoch 194/399 | Loss 0.0125 | Win count 120 | Last 10 win rate 1.0\nEpoch 195/399 | Loss 0.0122 | Win count 120 | Last 10 win rate 0.9\nEpoch 196/399 | Loss 0.0085 | Win count 121 | Last 10 win rate 0.9\nEpoch 197/399 | Loss 0.0064 | Win count 122 | Last 10 win rate 0.9\nEpoch 198/399 | Loss 0.0106 | Win count 123 | Last 10 win rate 0.9\nEpoch 199/399 | Loss 0.0079 | Win count 123 | Last 10 win rate 0.8\nEpoch 200/399 | Loss 0.0185 | Win count 124 | Last 10 win rate 0.8\nEpoch 201/399 | Loss 0.0117 | Win count 124 | Last 10 win rate 0.7\nEpoch 202/399 | Loss 0.0134 | Win count 125 | Last 10 win rate 0.7\nEpoch 203/399 | Loss 0.0094 | Win count 125 | Last 10 win rate 0.6\nEpoch 204/399 | Loss 0.0197 | Win count 126 | Last 10 win rate 0.6\nEpoch 205/399 | Loss 0.0123 | Win count 127 | Last 10 win rate 0.7\nEpoch 206/399 | Loss 0.0121 | Win count 128 | Last 10 win rate 0.7\nEpoch 207/399 | Loss 0.0076 | Win count 129 | Last 10 win rate 0.7\nEpoch 208/399 | Loss 0.0071 | Win count 130 | Last 10 win rate 0.7\nEpoch 209/399 | Loss 0.0037 | Win count 131 | Last 10 win rate 0.8\nEpoch 210/399 | Loss 0.0034 | Win count 132 | Last 10 win rate 0.8\nEpoch 211/399 | Loss 0.0045 | Win count 133 | Last 10 win rate 0.9\nEpoch 212/399 | Loss 0.0040 | Win count 134 | Last 10 win rate 0.9\nEpoch 213/399 | Loss 0.0025 | Win count 135 | Last 10 win rate 1.0\nEpoch 214/399 | Loss 0.0045 | Win count 136 | Last 10 win rate 1.0\nEpoch 215/399 | Loss 0.0043 | Win count 137 | Last 10 win rate 1.0\nEpoch 216/399 | Loss 0.0053 | Win count 138 | Last 10 win rate 1.0\nEpoch 217/399 | Loss 0.0031 | Win count 138 | Last 10 win rate 0.9\nEpoch 218/399 | Loss 0.0030 | Win count 139 | Last 10 win rate 0.9\nEpoch 219/399 | Loss 0.0055 | Win count 140 | Last 10 win rate 0.9\nEpoch 220/399 | Loss 0.0079 | Win count 141 | Last 10 win rate 0.9\nEpoch 221/399 | Loss 0.0057 | Win count 142 | Last 10 win rate 0.9\nEpoch 222/399 | Loss 0.0041 | Win count 143 | Last 10 win rate 0.9\nEpoch 223/399 | Loss 0.0114 | Win count 144 | Last 10 win rate 0.9\nEpoch 224/399 | Loss 0.0051 | Win count 145 | Last 10 win rate 0.9\nEpoch 225/399 | Loss 0.0070 | Win count 146 | Last 10 win rate 0.9\nEpoch 226/399 | Loss 0.0061 | Win count 147 | Last 10 win rate 0.9\nEpoch 227/399 | Loss 0.0046 | Win count 148 | Last 10 win rate 1.0\nEpoch 228/399 | Loss 0.0063 | Win count 149 | Last 10 win rate 1.0\nEpoch 229/399 | Loss 0.0045 | Win count 150 | Last 10 win rate 1.0\nEpoch 230/399 | Loss 0.0027 | Win count 151 | Last 10 win rate 1.0\nEpoch 231/399 | Loss 0.0024 | Win count 151 | Last 10 win rate 0.9\nEpoch 232/399 | Loss 0.0215 | Win count 151 | Last 10 win rate 0.8\nEpoch 233/399 | Loss 0.0223 | Win count 152 | Last 10 win rate 0.8\nEpoch 234/399 | Loss 0.0164 | Win count 153 | Last 10 win rate 0.8\nEpoch 235/399 | Loss 0.0135 | Win count 154 | Last 10 win rate 0.8\nEpoch 236/399 | Loss 0.0223 | Win count 155 | Last 10 win rate 0.8\nEpoch 237/399 | Loss 0.0247 | Win count 156 | Last 10 win rate 0.8\nEpoch 238/399 | Loss 0.0128 | Win count 157 | Last 10 win rate 0.8\nEpoch 239/399 | Loss 0.0091 | Win count 158 | Last 10 win rate 0.8\nEpoch 240/399 | Loss 0.0184 | Win count 158 | Last 10 win rate 0.7\nEpoch 241/399 | Loss 0.0158 | Win count 159 | Last 10 win rate 0.8\nEpoch 242/399 | Loss 0.0525 | Win count 160 | Last 10 win rate 0.9\nEpoch 243/399 | Loss 0.0275 | Win count 161 | Last 10 win rate 0.9\nEpoch 244/399 | Loss 0.0271 | Win count 162 | Last 10 win rate 0.9\nEpoch 245/399 | Loss 0.0208 | Win count 163 | Last 10 win rate 0.9\nEpoch 246/399 | Loss 0.0177 | Win count 164 | Last 10 win rate 0.9\nEpoch 247/399 | Loss 0.0269 | Win count 164 | Last 10 win rate 0.8\nEpoch 248/399 | Loss 0.0165 | Win count 164 | Last 10 win rate 0.7\nEpoch 249/399 | Loss 0.0458 | Win count 164 | Last 10 win rate 0.6\nEpoch 250/399 | Loss 0.0469 | Win count 165 | Last 10 win rate 0.7\nEpoch 251/399 | Loss 0.0230 | Win count 166 | Last 10 win rate 0.7\nEpoch 252/399 | Loss 0.0219 | Win count 167 | Last 10 win rate 0.7\nEpoch 253/399 | Loss 0.0168 | Win count 168 | Last 10 win rate 0.7\nEpoch 254/399 | Loss 0.0218 | Win count 169 | Last 10 win rate 0.7\nEpoch 255/399 | Loss 0.0132 | Win count 170 | Last 10 win rate 0.7\nEpoch 256/399 | Loss 0.0239 | Win count 171 | Last 10 win rate 0.7\nEpoch 257/399 | Loss 0.0150 | Win count 172 | Last 10 win rate 0.8\nEpoch 258/399 | Loss 0.0167 | Win count 173 | Last 10 win rate 0.9\nEpoch 259/399 | Loss 0.0091 | Win count 173 | Last 10 win rate 0.9\nEpoch 260/399 | Loss 0.0336 | Win count 174 | Last 10 win rate 0.9\nEpoch 261/399 | Loss 0.0083 | Win count 175 | Last 10 win rate 0.9\nEpoch 262/399 | Loss 0.0098 | Win count 176 | Last 10 win rate 0.9\nEpoch 263/399 | Loss 0.0251 | Win count 177 | Last 10 win rate 0.9\nEpoch 264/399 | Loss 0.0211 | Win count 177 | Last 10 win rate 0.8\nEpoch 265/399 | Loss 0.0494 | Win count 178 | Last 10 win rate 0.8\nEpoch 266/399 | Loss 0.0476 | Win count 179 | Last 10 win rate 0.8\nEpoch 267/399 | Loss 0.0116 | Win count 180 | Last 10 win rate 0.8\nEpoch 268/399 | Loss 0.0357 | Win count 181 | Last 10 win rate 0.8\nEpoch 269/399 | Loss 0.0184 | Win count 182 | Last 10 win rate 0.9\nEpoch 270/399 | Loss 0.0241 | Win count 183 | Last 10 win rate 0.9\nEpoch 271/399 | Loss 0.0243 | Win count 184 | Last 10 win rate 0.9\nEpoch 272/399 | Loss 0.0153 | Win count 185 | Last 10 win rate 0.9\nEpoch 273/399 | Loss 0.0164 | Win count 186 | Last 10 win rate 0.9\nEpoch 274/399 | Loss 0.0115 | Win count 187 | Last 10 win rate 1.0\nEpoch 275/399 | Loss 0.0072 | Win count 188 | Last 10 win rate 1.0\nEpoch 276/399 | Loss 0.0156 | Win count 189 | Last 10 win rate 1.0\nEpoch 277/399 | Loss 0.0133 | Win count 189 | Last 10 win rate 0.9\nEpoch 278/399 | Loss 0.0067 | Win count 190 | Last 10 win rate 0.9\nEpoch 279/399 | Loss 0.0224 | Win count 191 | Last 10 win rate 0.9\nEpoch 280/399 | Loss 0.0273 | Win count 192 | Last 10 win rate 0.9\nEpoch 281/399 | Loss 0.0089 | Win count 193 | Last 10 win rate 0.9\nEpoch 282/399 | Loss 0.0087 | Win count 194 | Last 10 win rate 0.9\nEpoch 283/399 | Loss 0.0051 | Win count 195 | Last 10 win rate 0.9\nEpoch 284/399 | Loss 0.0096 | Win count 196 | Last 10 win rate 0.9\nEpoch 285/399 | Loss 0.0112 | Win count 197 | Last 10 win rate 0.9\nEpoch 286/399 | Loss 0.0158 | Win count 198 | Last 10 win rate 0.9\nEpoch 287/399 | Loss 0.0112 | Win count 199 | Last 10 win rate 1.0\nEpoch 288/399 | Loss 0.0139 | Win count 200 | Last 10 win rate 1.0\nEpoch 289/399 | Loss 0.0081 | Win count 201 | Last 10 win rate 1.0\nEpoch 290/399 | Loss 0.0107 | Win count 202 | Last 10 win rate 1.0\nEpoch 291/399 | Loss 0.0095 | Win count 203 | Last 10 win rate 1.0\nEpoch 292/399 | Loss 0.0091 | Win count 204 | Last 10 win rate 1.0\nEpoch 293/399 | Loss 0.0105 | Win count 205 | Last 10 win rate 1.0\nEpoch 294/399 | Loss 0.0071 | Win count 205 | Last 10 win rate 0.9\nEpoch 295/399 | Loss 0.0081 | Win count 206 | Last 10 win rate 0.9\nEpoch 296/399 | Loss 0.0059 | Win count 207 | Last 10 win rate 0.9\nEpoch 297/399 | Loss 0.0027 | Win count 208 | Last 10 win rate 0.9\nEpoch 298/399 | Loss 0.0060 | Win count 209 | Last 10 win rate 0.9\nEpoch 299/399 | Loss 0.0039 | Win count 210 | Last 10 win rate 0.9\nEpoch 300/399 | Loss 0.0039 | Win count 211 | Last 10 win rate 0.9\nEpoch 301/399 | Loss 0.0037 | Win count 212 | Last 10 win rate 0.9\nEpoch 302/399 | Loss 0.0043 | Win count 213 | Last 10 win rate 0.9\nEpoch 303/399 | Loss 0.0050 | Win count 214 | Last 10 win rate 0.9\nEpoch 304/399 | Loss 0.0083 | Win count 215 | Last 10 win rate 1.0\nEpoch 305/399 | Loss 0.0088 | Win count 215 | Last 10 win rate 0.9\nEpoch 306/399 | Loss 0.0086 | Win count 216 | Last 10 win rate 0.9\nEpoch 307/399 | Loss 0.0063 | Win count 217 | Last 10 win rate 0.9\nEpoch 308/399 | Loss 0.0057 | Win count 218 | Last 10 win rate 0.9\nEpoch 309/399 | Loss 0.0064 | Win count 219 | Last 10 win rate 0.9\nEpoch 310/399 | Loss 0.0060 | Win count 220 | Last 10 win rate 0.9\nEpoch 311/399 | Loss 0.0049 | Win count 221 | Last 10 win rate 0.9\nEpoch 312/399 | Loss 0.0043 | Win count 222 | Last 10 win rate 0.9\nEpoch 313/399 | Loss 0.0031 | Win count 223 | Last 10 win rate 0.9\nEpoch 314/399 | Loss 0.0032 | Win count 224 | Last 10 win rate 0.9\nEpoch 315/399 | Loss 0.0028 | Win count 225 | Last 10 win rate 1.0\nEpoch 316/399 | Loss 0.0030 | Win count 226 | Last 10 win rate 1.0\nEpoch 317/399 | Loss 0.0022 | Win count 226 | Last 10 win rate 0.9\nEpoch 318/399 | Loss 0.0021 | Win count 227 | Last 10 win rate 0.9\nEpoch 319/399 | Loss 0.0021 | Win count 228 | Last 10 win rate 0.9\nEpoch 320/399 | Loss 0.0116 | Win count 229 | Last 10 win rate 0.9\nEpoch 321/399 | Loss 0.0055 | Win count 230 | Last 10 win rate 0.9\nEpoch 322/399 | Loss 0.0041 | Win count 231 | Last 10 win rate 0.9\nEpoch 323/399 | Loss 0.0041 | Win count 232 | Last 10 win rate 0.9\nEpoch 324/399 | Loss 0.0043 | Win count 233 | Last 10 win rate 0.9\nEpoch 325/399 | Loss 0.0023 | Win count 234 | Last 10 win rate 0.9\nEpoch 326/399 | Loss 0.0041 | Win count 234 | Last 10 win rate 0.8\nEpoch 327/399 | Loss 0.0048 | Win count 235 | Last 10 win rate 0.9\nEpoch 328/399 | Loss 0.0082 | Win count 236 | Last 10 win rate 0.9\nEpoch 329/399 | Loss 0.0054 | Win count 237 | Last 10 win rate 0.9\nEpoch 330/399 | Loss 0.0027 | Win count 238 | Last 10 win rate 0.9\nEpoch 331/399 | Loss 0.0068 | Win count 239 | Last 10 win rate 0.9\nEpoch 332/399 | Loss 0.0081 | Win count 240 | Last 10 win rate 0.9\nEpoch 333/399 | Loss 0.0126 | Win count 241 | Last 10 win rate 0.9\nEpoch 334/399 | Loss 0.0097 | Win count 242 | Last 10 win rate 0.9\nEpoch 335/399 | Loss 0.0083 | Win count 243 | Last 10 win rate 0.9\nEpoch 336/399 | Loss 0.0073 | Win count 244 | Last 10 win rate 1.0\nEpoch 337/399 | Loss 0.0108 | Win count 245 | Last 10 win rate 1.0\nEpoch 338/399 | Loss 0.0184 | Win count 246 | Last 10 win rate 1.0\nEpoch 339/399 | Loss 0.0087 | Win count 247 | Last 10 win rate 1.0\nEpoch 340/399 | Loss 0.0082 | Win count 247 | Last 10 win rate 0.9\nEpoch 341/399 | Loss 0.0080 | Win count 248 | Last 10 win rate 0.9\nEpoch 342/399 | Loss 0.0080 | Win count 249 | Last 10 win rate 0.9\nEpoch 343/399 | Loss 0.0100 | Win count 250 | Last 10 win rate 0.9\nEpoch 344/399 | Loss 0.0077 | Win count 251 | Last 10 win rate 0.9\nEpoch 345/399 | Loss 0.0081 | Win count 252 | Last 10 win rate 0.9\nEpoch 346/399 | Loss 0.0078 | Win count 253 | Last 10 win rate 0.9\nEpoch 347/399 | Loss 0.0107 | Win count 253 | Last 10 win rate 0.8\nEpoch 348/399 | Loss 0.0088 | Win count 253 | Last 10 win rate 0.7\nEpoch 349/399 | Loss 0.0077 | Win count 254 | Last 10 win rate 0.7\nEpoch 350/399 | Loss 0.0154 | Win count 255 | Last 10 win rate 0.8\nEpoch 351/399 | Loss 0.0089 | Win count 256 | Last 10 win rate 0.8\nEpoch 352/399 | Loss 0.0131 | Win count 257 | Last 10 win rate 0.8\nEpoch 353/399 | Loss 0.0159 | Win count 258 | Last 10 win rate 0.8\nEpoch 354/399 | Loss 0.0103 | Win count 259 | Last 10 win rate 0.8\nEpoch 355/399 | Loss 0.0074 | Win count 260 | Last 10 win rate 0.8\nEpoch 356/399 | Loss 0.0051 | Win count 261 | Last 10 win rate 0.8\nEpoch 357/399 | Loss 0.0051 | Win count 262 | Last 10 win rate 0.9\nEpoch 358/399 | Loss 0.0051 | Win count 263 | Last 10 win rate 1.0\nEpoch 359/399 | Loss 0.0082 | Win count 264 | Last 10 win rate 1.0\nEpoch 360/399 | Loss 0.0175 | Win count 265 | Last 10 win rate 1.0\nEpoch 361/399 | Loss 0.0089 | Win count 266 | Last 10 win rate 1.0\nEpoch 362/399 | Loss 0.0069 | Win count 267 | Last 10 win rate 1.0\nEpoch 363/399 | Loss 0.0062 | Win count 268 | Last 10 win rate 1.0\nEpoch 364/399 | Loss 0.0063 | Win count 269 | Last 10 win rate 1.0\nEpoch 365/399 | Loss 0.0089 | Win count 270 | Last 10 win rate 1.0\nEpoch 366/399 | Loss 0.0073 | Win count 271 | Last 10 win rate 1.0\nEpoch 367/399 | Loss 0.0048 | Win count 272 | Last 10 win rate 1.0\nEpoch 368/399 | Loss 0.0053 | Win count 273 | Last 10 win rate 1.0\nEpoch 369/399 | Loss 0.0041 | Win count 273 | Last 10 win rate 0.9\nEpoch 370/399 | Loss 0.0054 | Win count 274 | Last 10 win rate 0.9\nEpoch 371/399 | Loss 0.0370 | Win count 275 | Last 10 win rate 0.9\nEpoch 372/399 | Loss 0.0404 | Win count 276 | Last 10 win rate 0.9\nEpoch 373/399 | Loss 0.0178 | Win count 277 | Last 10 win rate 0.9\nEpoch 374/399 | Loss 0.0075 | Win count 278 | Last 10 win rate 0.9\nEpoch 375/399 | Loss 0.0064 | Win count 279 | Last 10 win rate 0.9\nEpoch 376/399 | Loss 0.0050 | Win count 280 | Last 10 win rate 0.9\nEpoch 377/399 | Loss 0.0046 | Win count 281 | Last 10 win rate 0.9\nEpoch 378/399 | Loss 0.0039 | Win count 282 | Last 10 win rate 0.9\nEpoch 379/399 | Loss 0.0030 | Win count 283 | Last 10 win rate 1.0\nEpoch 380/399 | Loss 0.0033 | Win count 284 | Last 10 win rate 1.0\nEpoch 381/399 | Loss 0.0036 | Win count 285 | Last 10 win rate 1.0\nEpoch 382/399 | Loss 0.0038 | Win count 286 | Last 10 win rate 1.0\nEpoch 383/399 | Loss 0.0036 | Win count 287 | Last 10 win rate 1.0\nEpoch 384/399 | Loss 0.0038 | Win count 288 | Last 10 win rate 1.0\nEpoch 385/399 | Loss 0.0025 | Win count 289 | Last 10 win rate 1.0\nEpoch 386/399 | Loss 0.0022 | Win count 290 | Last 10 win rate 1.0\nEpoch 387/399 | Loss 0.0018 | Win count 291 | Last 10 win rate 1.0\nEpoch 388/399 | Loss 0.0013 | Win count 292 | Last 10 win rate 1.0\nEpoch 389/399 | Loss 0.0020 | Win count 293 | Last 10 win rate 1.0\nEpoch 390/399 | Loss 0.0023 | Win count 294 | Last 10 win rate 1.0\nEpoch 391/399 | Loss 0.0010 | Win count 295 | Last 10 win rate 1.0\nEpoch 392/399 | Loss 0.0014 | Win count 296 | Last 10 win rate 1.0\nEpoch 393/399 | Loss 0.0010 | Win count 297 | Last 10 win rate 1.0\nEpoch 394/399 | Loss 0.0015 | Win count 298 | Last 10 win rate 1.0\nEpoch 395/399 | Loss 0.0012 | Win count 299 | Last 10 win rate 1.0\nEpoch 396/399 | Loss 0.0010 | Win count 300 | Last 10 win rate 1.0\nEpoch 397/399 | Loss 0.0010 | Win count 301 | Last 10 win rate 1.0\nEpoch 398/399 | Loss 0.0011 | Win count 302 | Last 10 win rate 1.0\nEpoch 399/399 | Loss 0.0007 | Win count 303 | Last 10 win rate 1.0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1506127512726,"submitTime":1506127512708,"finishTime":1506127725123,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8694a293-0a01-4f25-b553-e9b4122489bb"},{"version":"CommandV1","origId":226770,"guid":"a4cbe332-89d1-450d-8a16-763dd067095e","subtype":"command","commandType":"auto","position":12.53125,"command":"%sh ls -la /dbfs/keras_rl*","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">total 0\ndrwxr-xr-x 1 root root     0 Jan  1  1970 .\ndrwxrwxrwx 1 root root  4096 Jan  1  1970 ..\ndrwxr-xr-x 1 root root     0 Jan  1  1970 images\n-rw-r--r-- 1 root root 95840 Jan  1  1970 model.h5\n-rw-r--r-- 1 root root  1742 Jan  1  1970 model.json\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1506131041401,"submitTime":1506131041393,"finishTime":1506131041880,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"75b73475-d4e6-42de-833e-d7985730ce84"},{"version":"CommandV1","origId":226771,"guid":"50fa4dd4-c413-4b8d-bf6e-56bb69738309","subtype":"command","commandType":"auto","position":12.6875,"command":"import json\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom keras.models import model_from_json\n\ngrid_size = 10\n\nwith open(\"/dbfs/keras_rl/model.json\", \"r\") as jfile:\n    model = model_from_json(json.load(jfile))\nmodel.load_weights(\"/dbfs/keras_rl/model.h5\")\nmodel.compile(loss='mse', optimizer='adam')\n\n# Define environment, game\nenv = Catch(grid_size)\nc = 0\nfor e in range(10):\n    loss = 0.\n    env.reset()\n    game_over = False\n    # get initial input\n    input_t = env.observe()\n\n    plt.imshow(input_t.reshape((grid_size,)*2),\n               interpolation='none', cmap='gray')\n    plt.savefig(\"/dbfs/keras_rl/images/%03d.png\" % c)\n    c += 1\n    while not game_over:\n        input_tm1 = input_t\n\n        # get next action\n        q = model.predict(input_tm1)\n        action = np.argmax(q[0])\n\n        # apply action, get rewards and new state\n        input_t, reward, game_over = env.act(action)\n\n        plt.imshow(input_t.reshape((grid_size,)*2),\n                   interpolation='none', cmap='gray')\n        plt.savefig(\"/dbfs/keras_rl/images/%03d.png\" % c)\n        c += 1\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">IOError</span>: [Errno 2] No such file or directory: &apos;../images/001.png&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IOError</span>                                   Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-4154997996972236&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     37</span>         plt.imshow(input_t.reshape((grid_size,)*2),\n<span class=\"ansigreen\">     38</span>                    interpolation=&apos;none&apos;, cmap=&apos;gray&apos;)\n<span class=\"ansigreen\">---&gt; 39</span><span class=\"ansiyellow\">         </span>plt<span class=\"ansiyellow\">.</span>savefig<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;../images/%03d.png&quot;</span> <span class=\"ansiyellow\">%</span> c<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     40</span>         c <span class=\"ansiyellow\">+=</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/matplotlib/pyplot.pyc</span> in <span class=\"ansicyan\">savefig</span><span class=\"ansiblue\">(*args, **kwargs)</span>\n<span class=\"ansigreen\">    694</span> <span class=\"ansigreen\">def</span> savefig<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>args<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kwargs<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    695</span>     fig <span class=\"ansiyellow\">=</span> gcf<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 696</span><span class=\"ansiyellow\">     </span>res <span class=\"ansiyellow\">=</span> fig<span class=\"ansiyellow\">.</span>savefig<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>args<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kwargs<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    697</span>     fig<span class=\"ansiyellow\">.</span>canvas<span class=\"ansiyellow\">.</span>draw_idle<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span>   <span class=\"ansired\"># need this if &apos;transparent=True&apos; to reset colors</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    698</span>     <span class=\"ansigreen\">return</span> res<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/matplotlib/figure.pyc</span> in <span class=\"ansicyan\">savefig</span><span class=\"ansiblue\">(self, *args, **kwargs)</span>\n<span class=\"ansigreen\">   1561</span>             self<span class=\"ansiyellow\">.</span>set_frameon<span class=\"ansiyellow\">(</span>frameon<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1562</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1563</span><span class=\"ansiyellow\">         </span>self<span class=\"ansiyellow\">.</span>canvas<span class=\"ansiyellow\">.</span>print_figure<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>args<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kwargs<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1564</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1565</span>         <span class=\"ansigreen\">if</span> frameon<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/matplotlib/backend_bases.pyc</span> in <span class=\"ansicyan\">print_figure</span><span class=\"ansiblue\">(self, filename, dpi, facecolor, edgecolor, orientation, format, **kwargs)</span>\n<span class=\"ansigreen\">   2230</span>                 orientation<span class=\"ansiyellow\">=</span>orientation<span class=\"ansiyellow\">,</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2231</span>                 bbox_inches_restore<span class=\"ansiyellow\">=</span>_bbox_inches_restore<span class=\"ansiyellow\">,</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 2232</span><span class=\"ansiyellow\">                 **kwargs)\n</span><span class=\"ansigreen\">   2233</span>         <span class=\"ansigreen\">finally</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   2234</span>             <span class=\"ansigreen\">if</span> bbox_inches <span class=\"ansigreen\">and</span> restore_bbox<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/python/local/lib/python2.7/site-packages/matplotlib/backends/backend_agg.pyc</span> in <span class=\"ansicyan\">print_png</span><span class=\"ansiblue\">(self, filename_or_obj, *args, **kwargs)</span>\n<span class=\"ansigreen\">    530</span>         renderer<span class=\"ansiyellow\">.</span>dpi <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>figure<span class=\"ansiyellow\">.</span>dpi<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    531</span>         <span class=\"ansigreen\">if</span> is_string_like<span class=\"ansiyellow\">(</span>filename_or_obj<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 532</span><span class=\"ansiyellow\">             </span>filename_or_obj <span class=\"ansiyellow\">=</span> open<span class=\"ansiyellow\">(</span>filename_or_obj<span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&apos;wb&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    533</span>             close <span class=\"ansiyellow\">=</span> True<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    534</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IOError</span>: [Errno 2] No such file or directory: &apos;../images/001.png&apos;</div>","workflows":[],"startTime":1506131048804,"submitTime":1506131048791,"finishTime":1506131131997,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4a215999-9558-4263-8e1b-f18a6bfcae63"},{"version":"CommandV1","origId":226772,"guid":"7cc696eb-6554-44db-9d28-b55ec7b3d120","subtype":"command","commandType":"auto","position":12.84375,"command":"%sh ls -la /dbfs/keras_rl/images","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">total 0\ndrwxr-xr-x 1 root root    0 Jan  1  1970 .\ndrwxr-xr-x 1 root root    0 Jan  1  1970 ..\n-rw-r--r-- 1 root root 7448 Jan  1  1970 000.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 001.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 002.png\n-rw-r--r-- 1 root root 7367 Jan  1  1970 003.png\n-rw-r--r-- 1 root root 7367 Jan  1  1970 004.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 005.png\n-rw-r--r-- 1 root root 7401 Jan  1  1970 006.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 007.png\n-rw-r--r-- 1 root root 7383 Jan  1  1970 008.png\n-rw-r--r-- 1 root root 7356 Jan  1  1970 009.png\n-rw-r--r-- 1 root root 7447 Jan  1  1970 010.png\n-rw-r--r-- 1 root root 7368 Jan  1  1970 011.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 012.png\n-rw-r--r-- 1 root root 7368 Jan  1  1970 013.png\n-rw-r--r-- 1 root root 7368 Jan  1  1970 014.png\n-rw-r--r-- 1 root root 7384 Jan  1  1970 015.png\n-rw-r--r-- 1 root root 7400 Jan  1  1970 016.png\n-rw-r--r-- 1 root root 7368 Jan  1  1970 017.png\n-rw-r--r-- 1 root root 7371 Jan  1  1970 018.png\n-rw-r--r-- 1 root root 7357 Jan  1  1970 019.png\n-rw-r--r-- 1 root root 7430 Jan  1  1970 020.png\n-rw-r--r-- 1 root root 7367 Jan  1  1970 021.png\n-rw-r--r-- 1 root root 7367 Jan  1  1970 022.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 023.png\n-rw-r--r-- 1 root root 7368 Jan  1  1970 024.png\n-rw-r--r-- 1 root root 7384 Jan  1  1970 025.png\n-rw-r--r-- 1 root root 7400 Jan  1  1970 026.png\n-rw-r--r-- 1 root root 7368 Jan  1  1970 027.png\n-rw-r--r-- 1 root root 7371 Jan  1  1970 028.png\n-rw-r--r-- 1 root root 7357 Jan  1  1970 029.png\n-rw-r--r-- 1 root root 7415 Jan  1  1970 030.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 031.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 032.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 033.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 034.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 035.png\n-rw-r--r-- 1 root root 7380 Jan  1  1970 036.png\n-rw-r--r-- 1 root root 7386 Jan  1  1970 037.png\n-rw-r--r-- 1 root root 7392 Jan  1  1970 038.png\n-rw-r--r-- 1 root root 7356 Jan  1  1970 039.png\n-rw-r--r-- 1 root root 7465 Jan  1  1970 040.png\n-rw-r--r-- 1 root root 7402 Jan  1  1970 041.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 042.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 043.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 044.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 045.png\n-rw-r--r-- 1 root root 7382 Jan  1  1970 046.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 047.png\n-rw-r--r-- 1 root root 7383 Jan  1  1970 048.png\n-rw-r--r-- 1 root root 7356 Jan  1  1970 049.png\n-rw-r--r-- 1 root root 7394 Jan  1  1970 050.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 051.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 052.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 053.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 054.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 055.png\n-rw-r--r-- 1 root root 7400 Jan  1  1970 056.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 057.png\n-rw-r--r-- 1 root root 7371 Jan  1  1970 058.png\n-rw-r--r-- 1 root root 7336 Jan  1  1970 059.png\n-rw-r--r-- 1 root root 7428 Jan  1  1970 060.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 061.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 062.png\n-rw-r--r-- 1 root root 7367 Jan  1  1970 063.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 064.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 065.png\n-rw-r--r-- 1 root root 7380 Jan  1  1970 066.png\n-rw-r--r-- 1 root root 7365 Jan  1  1970 067.png\n-rw-r--r-- 1 root root 7369 Jan  1  1970 068.png\n-rw-r--r-- 1 root root 7336 Jan  1  1970 069.png\n-rw-r--r-- 1 root root 7393 Jan  1  1970 070.png\n-rw-r--r-- 1 root root 7365 Jan  1  1970 071.png\n-rw-r--r-- 1 root root 7384 Jan  1  1970 072.png\n-rw-r--r-- 1 root root 7384 Jan  1  1970 073.png\n-rw-r--r-- 1 root root 7384 Jan  1  1970 074.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 075.png\n-rw-r--r-- 1 root root 7401 Jan  1  1970 076.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 077.png\n-rw-r--r-- 1 root root 7372 Jan  1  1970 078.png\n-rw-r--r-- 1 root root 7338 Jan  1  1970 079.png\n-rw-r--r-- 1 root root 7414 Jan  1  1970 080.png\n-rw-r--r-- 1 root root 7364 Jan  1  1970 081.png\n-rw-r--r-- 1 root root 7364 Jan  1  1970 082.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 083.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 084.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 085.png\n-rw-r--r-- 1 root root 7380 Jan  1  1970 086.png\n-rw-r--r-- 1 root root 7386 Jan  1  1970 087.png\n-rw-r--r-- 1 root root 7392 Jan  1  1970 088.png\n-rw-r--r-- 1 root root 7356 Jan  1  1970 089.png\n-rw-r--r-- 1 root root 7430 Jan  1  1970 090.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 091.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 092.png\n-rw-r--r-- 1 root root 7385 Jan  1  1970 093.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 094.png\n-rw-r--r-- 1 root root 7384 Jan  1  1970 095.png\n-rw-r--r-- 1 root root 7383 Jan  1  1970 096.png\n-rw-r--r-- 1 root root 7366 Jan  1  1970 097.png\n-rw-r--r-- 1 root root 7372 Jan  1  1970 098.png\n-rw-r--r-- 1 root root 7338 Jan  1  1970 099.png\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506131136113,"submitTime":1506131136101,"finishTime":1506131137725,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d996db86-07e8-43cc-b8ef-68dab1464325"},{"version":"CommandV1","origId":226773,"guid":"bfef7183-eb90-4f2a-8da6-6793d3983c20","subtype":"command","commandType":"auto","position":12.921875,"command":"import imageio\n\nimages = []\nfilenames = [\"/dbfs/keras_rl/images/{:03d}.png\".format(x) for x in xrange(100)]","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">KeyError</span>: &apos;03d&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">KeyError</span>                                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-4154997996972244&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> images <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> </span>filenames <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;/dbfs/keras_rl/images/{03d}.png&apos;</span><span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">for</span> x <span class=\"ansigreen\">in</span> xrange<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">100</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">KeyError</span>: &apos;03d&apos;</div>","workflows":[],"startTime":1506131162737,"submitTime":1506131162725,"finishTime":1506131162762,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"12b86ca0-9530-4bb9-b7a0-cdb501ed05e9"},{"version":"CommandV1","origId":226774,"guid":"0f1fb360-1dd2-4fb8-a2cb-41b54efe8ef5","subtype":"command","commandType":"auto","position":12.9609375,"command":"for filename in filenames:\n    images.append(imageio.imread(filename))\nimageio.mimsave('/dbfs/FileStore/movie.gif', images)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506131164488,"submitTime":1506131164478,"finishTime":1506131179059,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e1389da8-faa5-4538-9ee4-a3e3a7716c95"},{"version":"CommandV1","origId":226775,"guid":"b582bccf-2795-4d0f-8107-ce843c622da1","subtype":"command","commandType":"auto","position":12.98046875,"command":"%md\n\n```<img src=\"/files/movie.gif\">```","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1506127485637,"submitTime":1506127485621,"finishTime":1506127486121,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"30f92b58-8fe8-4948-8eb9-15b58708cc93"},{"version":"CommandV1","origId":226776,"guid":"ae480f5d-f58a-49f9-9a1e-cf239672a73e","subtype":"command","commandType":"auto","position":13.0,"command":"%md \n### Where to Go Next?\n\nThe following articles are great next steps:\n\n* Flappy Bird with DQL and Keras: https://yanpanlau.github.io/2016/07/10/FlappyBird-Keras.html\n* DQL with Keras and an Open AI Gym task: http://koaning.io/hello-deepq.html\n* Simple implementation with Open AI Gym support: https://github.com/sherjilozair/dqn\n\nThis project offers Keras add-on classes for simple experimentation with DQL:\n\n* https://github.com/farizrahman4u/qlearning4k\n* Note that you'll need to implement (or wrap) the \"game\" to plug into that framework\n\nTry it at home:\n\n* Hack the \"Keras Plays Catch\" demo to allow the ball to drift horizontally as it falls. Does it work?\n* Try training the network on \"delta frames\" instead of static frames. This gives the network information about motion (implicitly).\n* What if the screen is high-resolution? what happens? how could you handle it better?\n\nAnd if you have the sneaking suspicion that there is a connection between PG and DQL, you'd be right: https://arxiv.org/abs/1704.06440\n","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1506125973397,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"deletable":true,"editable":true},"streamStates":{},"nuid":"074ee2a2-81bd-4852-a52c-475abae37116"}],"dashboards":[],"guid":"a767a32a-e12f-4835-9588-e069191a6bd1","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":3},"version":"3.4.5","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/7f9cefa92f0da43a505f7213ef5a6bb5d4a409ec4e0540a0a55701946063455d/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/7f9cefa92f0da43a505f7213ef5a6bb5d4a409ec4e0540a0a55701946063455d/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/7f9cefa92f0da43a505f7213ef5a6bb5d4a409ec4e0540a0a55701946063455d/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
