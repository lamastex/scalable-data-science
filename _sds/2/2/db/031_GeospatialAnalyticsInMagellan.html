<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>031_GeospatialAnalyticsInMagellan - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/img/favicon.ico"/>
<script>window.settings = {"enableUsageDeliveryConfiguration":false,"enableNotebookNotifications":true,"enableSshKeyUI":true,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"allowWhitelistedIframeDomains":false,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":true,"enableClearStateFeature":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"class-node","description":"Class Node","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"r3.xlarge","node_type_id":"r3.xlarge","description":"r3.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"r3.xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":13.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"r3.2xlarge","node_type_id":"r3.2xlarge","description":"r3.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Memory Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"r3.4xlarge","node_type_id":"r3.4xlarge","description":"r3.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"r3.4xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":52.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Memory Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"r3.8xlarge","node_type_id":"r3.8xlarge","description":"r3.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"r3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":104.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Memory Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":8079,"instance_type_id":"c3.2xlarge","node_type_id":"c3.2xlarge","description":"c3.2xlarge","support_cluster_tags":true,"container_memory_mb":10099,"node_instance_type":{"instance_type_id":"c3.2xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":28.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":15360,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":false,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":19998,"instance_type_id":"c3.4xlarge","node_type_id":"c3.4xlarge","description":"c3.4xlarge","support_cluster_tags":true,"container_memory_mb":24998,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":false,"category":"Compute Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":43837,"instance_type_id":"c3.8xlarge","node_type_id":"c3.8xlarge","description":"c3.8xlarge","support_cluster_tags":true,"container_memory_mb":54796,"node_instance_type":{"instance_type_id":"c3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":108.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":61440,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":61440,"is_hidden":false,"category":"Compute Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"i2.xlarge","node_type_id":"i2.xlarge","description":"i2.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"i2.xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":14.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Storage Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"i2.2xlarge","node_type_id":"i2.2xlarge","description":"i2.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"i2.2xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":27.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Storage Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"i2.4xlarge","node_type_id":"i2.4xlarge","description":"i2.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"i2.4xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":53.0,"number_of_ips":4,"local_disks":4,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Storage Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"i2.8xlarge","node_type_id":"i2.8xlarge","description":"i2.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"i2.8xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":104.0,"number_of_ips":4,"local_disks":8,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Storage Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"support_ssh":false,"spark_heap_memory":23800,"instance_type_id":"r3.2xlarge","node_type_id":"memory-optimized","description":"Memory Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":28000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":true,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true},{"support_ssh":false,"spark_heap_memory":9702,"instance_type_id":"c3.4xlarge","node_type_id":"compute-optimized","description":"Compute Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":12128,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":true,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true}],"default_node_type_id":"class-node"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"enableRStudioUI":false,"isAdmin":false,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-west-2a","isDefault":true},{"id":"us-west-2c","isDefault":false},{"id":"us-west-2b","isDefault":false}],"enableCustomSpotPricingUIByTier":true,"serverlessClustersEnabled":true,"enableWorkspaceBrowserSorting":true,"enableSentryLogging":false,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"defaultStandardClusterModel":{"cluster_name":"","node_type_id":"class-node","spark_version":"3.5.x-scala2.11","num_workers":8,"autoscale":null,"aws_attributes":{"availability":"SPOT_WITH_FALLBACK","instance_profile_arn":null,"first_on_demand":5.0,"spot_bid_price_percent":100,"zone_id":"us-west-2a"},"autotermination_minutes":120,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":false,"enableBitbucketCloud":true,"shouldShowCommandStatus":false,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":true,"enableJobAclsConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"allowRunOnPendingClusters":true,"applications":false,"useAutoscalingByDefault":false,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableTableAclsConfig":false,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":true,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":false,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-22756288786762d246bac1381e4f44610a4c2c3135c717c5ac3661822a723f1c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-86a9b375074f5afad339e70230ec0ec265c4cefbd280844785fab3bcde5869f9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, Scala 2.11)","packageLabel":"spark-image-fc9368293e1b3b6c37181d7af3123a4b9de5f7fa03cfd6dfaa038753256380c9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.5.x-rc-scala2.11","displayName":"3.5.3 RC (Scala 2.11)","packageLabel":"spark-image-eff9552bcb6cb65f96a0d9bb2b5123594d8a53fff456b3440fa6908f4263ef99","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-rc-scala2.11","displayName":"4.0.1 RC (Scala 2.11)","packageLabel":"spark-image-bcd7a7b6247d51a673ce291722d0fee3654dfe50b5b04c8fba19b97c95f53fd5","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-f91cb0b3822c6641a9d346ef6c149118fb859b5e511ee01c31e958892ba23c7a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-rc-gpu-scala2.11","displayName":"3.4.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-fc7e6ce873948365eb11f107b2b8b14ddd1311f5b95157dbc55667a7b1464708","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"4.0.x-gpu-scala2.11","displayName":"4.0 (includes Apache Spark 2.3.0, GPU, Scala 2.11)","packageLabel":"spark-image-b543c0700f83413b0055359ea9feaf285f2e2f3350fb7f301ea0e18b018b5cb5","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-c73d1e64ef3c6d84737d96ace089afdac86cc2ad8e897a7dd564d8bad63b94b1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.11","displayName":"3.3.3 RC (Scala 2.11)","packageLabel":"spark-image-00449cd26af8335b76ed4fe6a9cdbc7388977da83136f52ca90e548080270683","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.11","displayName":"3.4.3 RC (Scala 2.11)","packageLabel":"spark-image-29871daabc403ee59cefd38533228f5815e3a5cece18deab18ce35ac8705e7a3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-rc-gpu-scala2.11","displayName":"3.3.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-5ca78b83c7960ace704b397edc40a010fc3a75f713587d908a9296b771fb8530","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"next-major-version-scala2.11","displayName":"Next major version (4.0 snapshot, Scala 2.11)","packageLabel":"spark-image-04bb47b0bae8165f760972376ce05083bc6102645f3f3851cd1cdf9cba13d6fe","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"4.0.x-rc-gpu-scala2.11","displayName":"4.0.1 RC (GPU, Scala 2.11)","packageLabel":"spark-image-5e2a1a9d6a9d35bcd2a031a42f8d5ebdebd1f37f917cd95c861ac17578722b21","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.10","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-rc-scala2.10","displayName":"3.3.3 RC (Scala 2.10)","packageLabel":"spark-image-9c570ceec585af02b6759d89a19584bdf222b1bf6f3e0ebc700a7b4d0bf492a8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (Scala 2.10)","packageLabel":"spark-image-ec81b6840af02ee2321dd8dfe2587437bbcddf024d4ae287f326a98fac406a6c","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (Scala 2.10)","packageLabel":"spark-image-5e4f1f2feb631875a6036dffb069ec14b436939b5efe0ecb3ff8220c835298d6","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-rc-scala2.10","displayName":"3.4.3 RC (Scala 2.10)","packageLabel":"spark-image-d70218f5efeba85df5c5a4a4bd76135221e1b01728fbdeecead023e2d322bbb8","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-66d1366768039140a9f5409f3bab414cb7477ebd8d4bbf8b32cb885120f9f705","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-f70d374e4776122d5920cfcd828eaf195af59280844f36386a0a28ae5aa06acf","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-gpu-scala2.11","displayName":"3.5.3 RC (GPU, Scala 2.11)","packageLabel":"spark-image-d1b81198d41215abe0c72e5ce4f56168b3b2acc6cb178e291f2bf04fd4f4be03","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-46cc39a9afa43fbd7bfa9f4f5ed8d23f658cd0b0d74208627243222ae0d22f8d","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"next-major-version-gpu-scala2.11","displayName":"Next major version (4.0 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-41e21a0db3b77bc857f10358917ccbf5fbd85290e8429c2176a5fc7a29ce4f18","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-gpu-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, GPU, Scala 2.11)","packageLabel":"spark-image-7a1e78fbfc4d1645e7478daa28377389b900aec38764df46bd836c1a9925499b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (4.1 snapshot, Scala 2.11)","packageLabel":"spark-image-c73d1e64ef3c6d84737d96ace089afdac86cc2ad8e897a7dd564d8bad63b94b1","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (4.1 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-f70d374e4776122d5920cfcd828eaf195af59280844f36386a0a28ae5aa06acf","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.5.x-rc-scala2.10","displayName":"3.5.3 RC (Scala 2.10)","packageLabel":"spark-image-71baec97f74825bef2ca870a7520340c8f5ce25583e0b94960dd5242f2d813e0","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},{"key":"3.4.x-scala2.10","displayName":"3.4 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-867d7300605c0c54b2b1394d1bba7b88b28ed5841b3575253cded34db6ce6454","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableTableAclsByTier":true,"enableRestrictedClusterCreation":false,"enableFeedback":false,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","tableAclsDisabledMap":{"spark.databricks.acl.dfAclsEnabled":"false"},"driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"Standard_DS5_v2":3,"Standard_D2s_v3":0.5,"Standard_DS4_v2_Promo":1.5,"Standard_DS14":4,"Standard_DS11_v2_Promo":0.5,"r4.16xlarge":16,"Standard_DS11":0.5,"Standard_D2_v3":0.5,"Standard_DS14_v2_Promo":4,"Standard_D64s_v3":12,"p2.8xlarge":16,"m4.10xlarge":8,"Standard_D8s_v3":1.5,"Standard_E32s_v3":8,"Standard_DS3":0.75,"Standard_DS2_v2":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_L8s":2,"Standard_DS13_v2_Promo":2,"Standard_E4s_v3":1,"Standard_D3_v2":0.75,"Standard_DS15_v2":5,"Standard_D16s_v3":3,"Standard_D5_v2":3,"Standard_E8s_v3":2,"Standard_DS2_v2_Promo":0.5,"c3.8xlarge":4,"Standard_D4_v3":0.75,"Standard_E2s_v3":0.5,"Standard_D32_v3":6,"Standard_DS3_v2":0.75,"r3.4xlarge":4,"Standard_DS4":1.5,"i2.4xlarge":6,"Standard_DS3_v2_Promo":0.75,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_H16":4,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.4,"Standard_D16_v3":3,"Standard_F4s":0.5,"p2.16xlarge":24,"i3.8xlarge":8,"Standard_D32s_v3":6,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_L32s":8,"Standard_D4s_v3":0.75,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS12_v2_Promo":1,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1,"Standard_F16s":2,"c4.2xlarge":1,"Standard_L16s":4,"i2.xlarge":1.5,"Standard_DS2":0.5,"compute-optimized":1,"c4.4xlarge":2,"Standard_DS5_v2_Promo":3,"Standard_D64_v3":12,"Standard_D2_v2":0.5,"Standard_D8_v3":1.5,"i3.2xlarge":2,"Standard_E16s_v3":4,"Standard_F8s":1,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"Standard_DS4_v2":1.5,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableClusterAppsUIOnServerless":false,"enableEBSVolumesUI":true,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":true,"enableNotebookHistoryDiffing":true,"branch":"2.67.1037","accountsLimit":-1,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":true,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":6,"broadenedEditPermission":false,"disableS3TableImport":false,"enableArrayParamsEdit":true,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/data-import/jdbc.html","displayName":"JDBC","workspaceFileName":"JDBC Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"enableNewLineChart":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterEdit":true,"enableClusterAclsConfig":true,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":true,"enableCreateClusterOnAttach":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"commandStatusDebounceMaxWait":5000,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableExperimentalCharts":false,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":true,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"enableJobListPermissionFilter":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.5.x-scala2.11","displayName":"3.5 LTS (includes Apache Spark 2.2.1, Scala 2.11)","packageLabel":"spark-image-c919ecd682175957255cbc87041d82633406312f7b74e018e165c4fe94943b5f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION","SUPPORTS_TABLE_ACLS"]},"enableNewLineChartParams":false,"deprecatedEnableStructuredDataAcls":true,"enableCustomSpotPricing":true,"enableRStudioFreeUI":false,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":false,"disableExportNotebook":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","commandStatusDebounceInterval":1000,"showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"defaultTagKeys":{"CLUSTER_NAME":"ClusterName","VENDOR":"Vendor","CLUSTER_TYPE":"ResourceClass","CREATOR":"Creator","CLUSTER_ID":"ClusterId"},"enableClusterAclsByTier":true,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","customSparkVersionPrefix":"custom:","disallowAddingAdmins":false,"enableSparkConfUI":true,"enableClusterEventsUI":true,"featureTier":"UNKNOWN_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","defaultServerlessClusterModel":{"cluster_name":"","node_type_id":"i3.2xlarge","spark_version":"latest-stable-scala2.11","num_workers":null,"enable_jdbc_auto_start":true,"custom_tags":{"ResourceClass":"Serverless"},"autoscale":{"min_workers":2,"max_workers":20},"spark_conf":{"spark.databricks.cluster.profile":"serverless","spark.databricks.repl.allowedLanguages":"sql,python,r","spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"aws_attributes":{"ebs_volume_count":null,"availability":"SPOT_WITH_FALLBACK","first_on_demand":1,"ebs_volume_type":null,"spot_bid_price_percent":100,"zone_id":"us-west-2a","ebs_volume_size":null},"autotermination_minutes":0,"enable_elastic_disk":true,"default_tags":{"Vendor":"Databricks","Creator":"r.sainudiin@math.canterbury.ac.nz","ClusterName":null,"ClusterId":"<Generated after creation>"}},"enableOrgSwitcherUI":false,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":-1,"enableJdbcImport":true,"enableClusterAppsUIOnNormalClusters":false,"enableElasticDisk":true,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":false,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableRServerless":true,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":true,"maxClusterTagKeyLength":127,"gitHash":"","clusterTagReservedPrefixes":[],"tableAclsEnabledMap":{"spark.databricks.acl.dfAclsEnabled":"true"},"showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enablePythonVersionUI":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":true,"enableTokens":true,"enableMiniClusters":false,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":false,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":true,"enableUserPromptForPendingRpc":false,"enableNotebookHistoryUI":true,"addWhitespaceAfterLastNotebookCell":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":true,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":true,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":true,"enableTableAclService":true,"removeSubCommandCodeWhenExport":true,"upgradeURL":"","maxAutoterminationMinutes":10000,"showResultsFromExternalSearchEngine":true,"autoterminateClustersByDefault":false,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":true,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":false,"useOnDemandClustersByDefault":false,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":202651,"name":"031_GeospatialAnalyticsInMagellan","language":"scala","commands":[{"version":"CommandV1","origId":202652,"guid":"f2de04cb-b45e-45b1-b629-7ca28c252622","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n\n# [SDS-2.2, Scalable Data Science](https://lamastex.github.io/scalable-data-science/sds/2/2/)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5edb52cd-a2c1-4ca5-98c2-a1e18eea22ae"},{"version":"CommandV1","origId":242134,"guid":"ab70ce76-aa5e-4c8c-9bd4-6d2dee49c547","subtype":"command","commandType":"auto","position":0.625,"command":"%md\nArchived YouTube video of this live unedited lab-lecture:\n\n[![Archived YouTube video of this live unedited lab-lecture](http://img.youtube.com/vi/TsqWglA3_-0/0.jpg)](https://www.youtube.com/embed/TsqWglA3_-0?start=0&end=1324&autoplay=1)\n[![Archived YouTube video of this live unedited lab-lecture](http://img.youtube.com/vi/3Lc2M0LTAUc/0.jpg)](https://www.youtube.com/embed/3Lc2M0LTAUc?start=0&end=2077&autoplay=1)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8117db0f-f81d-4fd3-9193-feb6de6a846c"},{"version":"CommandV1","origId":202888,"guid":"b6b9fc63-0474-4578-936b-4c7accb28969","subtype":"command","commandType":"auto","position":0.75,"command":"%md\n# What is Geospatial Analytics?\n\n\n**(watch now 3 minutes and 23 seconds: 111-314 seconds)**:\n\n[![Spark Summit East 2016 - What is Geospatial Analytics by Ram Sri Harsha](http://img.youtube.com/vi/1lF1oSjxMT4/0.jpg)](https://www.youtube.com/watch?v=1lF1oSjxMT4?rel=0&autoplay=1&modestbranding=1&start=111&end=314)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b85853c6-6243-4735-bcfd-1082c3453bc1"},{"version":"CommandV1","origId":202889,"guid":"26540fa7-cef2-4a83-a4f9-47211e12be49","subtype":"command","commandType":"auto","position":0.875,"command":"%md\n\n# Some Concrete Examples of Scalable Geospatial Analytics\n\n### Let us check out cross-domain data fusion in MSR's Urban Computing Group \n\n* lots of interesting papers to read at [http://research.microsoft.com/en-us/projects/urbancomputing/](http://research.microsoft.com/en-us/projects/urbancomputing/).\n\n## Several sciences are naturally geospatial \n\n* forestry, \n* geography, \n* geology, \n* seismology, \n* etc. etc.\n\nSee for example the global EQ datastreams from US geological Service below.\n\nFor a global data source, see US geological Service's Earthquake hazards Program [\"http://earthquake.usgs.gov/data/](http://earthquake.usgs.gov/data/).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ebd93ae4-f06c-4490-be04-ff765b2b0955"},{"version":"CommandV1","origId":202653,"guid":"7ef0fb31-4f7e-4d7f-a461-f73ab6413acd","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n# Introduction to Magellan for Scalable Geospatial Analytics\n\nThis is a minor  augmentation of Ram Harsha's Magellan code blogged here:\n\n* [magellan geospatial analytics in spark](https://magellan.ghost.io/welcome-to-ghost/)\n\nFirst you need to attach the following library:\n\n* the magellan library (maven coordinates `harsha2010:magellan:1.0.5-s_2.11`)\n\n\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451992569,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22103f42-9502-4c55-b252-207d8f1bb996"},{"version":"CommandV1","origId":202655,"guid":"56619575-bc6b-4153-80e5-ee41c987ff0b","subtype":"command","commandType":"auto","position":1.625,"command":"%md\n\n## Do we need one more geospatial analytics library?\n\nFrom [Ram's slide 4 of this Spark Summit East 2016 talk at slideshare](http://www.slideshare.net/SparkSummit/magellanspark-as-a-geospatial-analytics-engine-by-ram-sriharsha):\n\n* Spatial Analytics at scale is challenging \n  * Simplicity + Scalability = Hard \n* Ancient Data Formats \n  * metadata, indexing not handled well, inefficient storage \n* Geospatial Analytics is not simply Business Intelligence anymore \n  * Statistical + Machine Learning being leveraged in geospatial \n* Now is the time to do it! \n  * Explosion of mobile data \n  * Finer granularity of data collection for geometries \n  * Analytics stretching the limits of traditional approaches \n  * Spark SQL + Catalyst + Tungsten makes extensible SQL engines easier than ever before! \n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"edfb245b-ca7c-455c-8f57-772971462f50"},{"version":"CommandV1","origId":202656,"guid":"76bf3c0a-573c-42ee-92b5-05040f201cb5","subtype":"command","commandType":"auto","position":1.6875,"command":"%md\n## Nuts and Bolts of Magellan\n\nLet us go and grab this databricks notebook:\n\n* [https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/137058993011870/882779309834027/6891974485343070/latest.html](https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/137058993011870/882779309834027/6891974485343070/latest.html) \n\nand look at the magellan README in github:\n\n* [https://github.com/harsha2010/magellan](https://github.com/harsha2010/magellan)\n\n**HOMEWORK**: Watch the [magellan presentation by Ram Harsha (Hortonworks) in Spark Summit East 2016](https://spark-summit.org/east-2016/events/magellan-spark-as-a-geospatial-analytics-engine/).\n\n  \nOther resources for magellan:\n\n* [Ram's blog in HortonWorks](http://hortonworks.com/blog/magellan-geospatial-analytics-in-spark/) and the [ZeppelinHub view of the demo code in video above](https://www.zeppelinhub.com/viewer/notebooks/aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2hvcnRvbndvcmtzLWdhbGxlcnkvemVwcGVsaW4tbm90ZWJvb2tzL21hc3Rlci8yQjRUV0dDOE0vbm90ZS5qc29u)\n* [Magellan as Spark project](http://spark-packages.org/package/harsha2010/magellan) and [Magellan github source](https://github.com/harsha2010/magellan)\n* [shape files](https://en.wikipedia.org/wiki/Shapefile) developed by Environmental Systems Research Institute [(ESRI)](https://en.wikipedia.org/wiki/Esri). See ESRI's [what is a geospatial shape file?](https://www.esri.com/library/whitepapers/pdfs/shapefile.pdf)\n* magellan builds on [http://esri.github.io/](http://esri.github.io/) a leading opensource geospatial library\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7ab3469d-cc36-4eb7-996f-6706fe9cb584"},{"version":"CommandV1","origId":202905,"guid":"c6408d45-c53f-48ca-9f60-150e10a52062","subtype":"command","commandType":"auto","position":4.515625,"command":"%md\nLet's get our hands dirty with basics in magellan.\n\n### Data Structures\n\n* Points\n* Polygons\n* lines\n* Polylines\n\n### Predicates\n\n* within\n* intersects","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"33fb7b1f-bb6b-411f-88a3-71ed7335ffa9"},{"version":"CommandV1","origId":202906,"guid":"cfb07ed4-290c-495a-b0e8-f33360a305e9","subtype":"command","commandType":"auto","position":5.9296875,"command":"// create a points DataFrame\nval points = sc.parallelize(Seq((-1.0, -1.0), (-1.0, 1.0), (1.0, -1.0))).toDF(\"x\", \"y\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">points: org.apache.spark.sql.DataFrame = [x: double, y: double]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1510083255540,"submitTime":1510083266491,"finishTime":1510083258163,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"adf3089d-cfbb-45fb-b630-eb91d5b0c156"},{"version":"CommandV1","origId":202907,"guid":"00af1ec1-3ebe-4006-b515-fc6a5855cd22","subtype":"command","commandType":"auto","position":6.63671875,"command":"// transform (lat,lon) into Point using custom user-defined function\nimport magellan.Point\nimport org.apache.spark.sql.functions.udf\nval toPointUDF = udf{(x:Double,y:Double) => Point(x,y) }","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import magellan.Point\nimport org.apache.spark.sql.functions.udf\ntoPointUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(&lt;function2&gt;,org.apache.spark.sql.types.PointUDT@105fcd11,Some(List(DoubleType, DoubleType)))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507784328568,"submitTime":1507784341662,"finishTime":1507784329298,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2133587c-ded1-493d-b29b-76b90d8292ee"},{"version":"CommandV1","origId":202908,"guid":"d7c8342b-758b-4c5e-bfad-36fc90e8be98","subtype":"command","commandType":"auto","position":6.990234375,"command":"// let's show the results of the DF with a new column called point\npoints.withColumn(\"point\", toPointUDF('x, 'y)).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----+-----------------+\n|   x|   y|            point|\n+----+----+-----------------+\n|-1.0|-1.0|Point(-1.0, -1.0)|\n|-1.0| 1.0| Point(-1.0, 1.0)|\n| 1.0|-1.0| Point(1.0, -1.0)|\n+----+----+-----------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507784333457,"submitTime":1507784346553,"finishTime":1507784339917,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"65de746c-6d74-4f7f-8e49-9b56350ffe27"},{"version":"CommandV1","origId":202909,"guid":"f749551d-7530-449a-b27f-a477ae0578eb","subtype":"command","commandType":"auto","position":7.1669921875,"command":"// Let's instead use the built-in expression to do the same - it's much faster on larger DataFrames due to code-gen\nimport org.apache.spark.sql.magellan.dsl.expressions._\n\npoints.withColumn(\"point\", point('x, 'y)).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+----+-----------------+\n|   x|   y|            point|\n+----+----+-----------------+\n|-1.0|-1.0|Point(-1.0, -1.0)|\n|-1.0| 1.0| Point(-1.0, 1.0)|\n| 1.0|-1.0| Point(1.0, -1.0)|\n+----+----+-----------------+\n\nimport org.apache.spark.sql.magellan.dsl.expressions._\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507784353495,"submitTime":1507784366589,"finishTime":1507784354269,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ed2931e8-0152-4534-af56-409786ab95dc"},{"version":"CommandV1","origId":202913,"guid":"a37b361b-74d5-411e-a60b-60f755abc1f7","subtype":"command","commandType":"auto","position":7.1890869140625,"command":"%md\nLet's verify empirically if it is indeed faster for larger DataFrames.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"35b80489-984d-4a29-a4a8-131a3d2d736e"},{"version":"CommandV1","origId":202911,"guid":"be047e04-8d1a-4f2a-a0c4-1bac5d7b038a","subtype":"command","commandType":"auto","position":7.211181640625,"command":"// to generate a sequence of pairs of random numbers we can do:\nimport util.Random.nextDouble\nSeq.fill(10)((-1.0*nextDouble,+1.0*nextDouble))","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import util.Random.nextDouble\nres2: Seq[(Double, Double)] = List((-0.020043427602710828,0.9375053662414891), (-0.994920524839198,0.845271190508138), (-0.1501812761209732,0.10704139325335771), (-0.9891649012229055,0.8031283537358862), (-0.9576677869252214,0.4852309234418518), (-0.3615417292821861,0.026888794684844397), (-0.20066285059225897,0.32093278495843036), (-0.7157377454281582,0.9061198917840395), (-0.1812174392506678,0.19036607653819304), (-0.0999544225947615,0.5381675138406278))\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">Unclosed block</div>","error":null,"workflows":[],"startTime":1507784362533,"submitTime":1507784375624,"finishTime":1507784363725,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"862e1c82-3b60-4ab3-b128-97f76962ad51"},{"version":"CommandV1","origId":202912,"guid":"dd6355ed-0358-4f09-8065-9ac93335e87f","subtype":"command","commandType":"auto","position":7.2332763671875,"command":"// using the UDF method with 1 million points we can do a count action of the DF with point column\n// don'yt add too many zeros as it may crash your driver program\nsc.parallelize(Seq.fill(1000000)((-1.0*nextDouble,+1.0*nextDouble)))\n  .toDF(\"x\", \"y\")\n  .withColumn(\"point\", toPointUDF('x, 'y))\n  .count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res3: Long = 1000000\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"The spark context has been stopped or the cluster has been terminated. Please restart the cluster or attach this notebook to a different cluster.","error":null,"workflows":[],"startTime":1507784371071,"submitTime":1507784384159,"finishTime":1507784374726,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"00374118-f76f-42ca-b9ca-a2b7d461670c"},{"version":"CommandV1","origId":202910,"guid":"f597efa4-f4ac-4cf0-bb4b-bf8e79e8a35c","subtype":"command","commandType":"auto","position":7.25537109375,"command":"// seems twice as fast with code-gen\nsc.parallelize(Seq.fill(1000000)((-1.0*nextDouble,+1.0*nextDouble)))\n  .toDF(\"x\", \"y\")\n  .withColumn(\"point\", point('x, 'y))\n  .count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res4: Long = 1000000\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507784379787,"submitTime":1507784392879,"finishTime":1507784381365,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3900a996-c6b4-463a-a4bd-2377c75f9007"},{"version":"CommandV1","origId":202915,"guid":"7a8bf406-add4-45a3-8f56-48e3f1168e53","subtype":"command","commandType":"auto","position":7.2774658203125,"command":"//This allows easy embedding of publicly available information into any other notebook\n//when viewing in git-book just ignore this block - you may have to manually chase the URL in frameIt(\"URL\").\n//Example usage:\n// displayHTML(frameIt(\"https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation#Topics_in_LDA\",250))\ndef frameIt( u:String, h:Int ) : String = {\n      \"\"\"<iframe \n src=\"\"\"\"+ u+\"\"\"\"\n width=\"95%\" height=\"\"\"\" + h + \"\"\"\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>\"\"\"\n   }\ndisplayHTML(frameIt(\"https://databricks.com/blog/2015/04/13/deep-dive-into-spark-sqls-catalyst-optimizer.html\",400))","commandVersion":0,"state":"finished","results":{"type":"htmlSandbox","data":"<iframe \n src=\"https://databricks.com/blog/2015/04/13/deep-dive-into-spark-sqls-catalyst-optimizer.html\"\n width=\"95%\" height=\"400\"\n sandbox>\n  <p>\n    <a href=\"http://spark.apache.org/docs/latest/index.html\">\n      Fallback link for browsers that, unlikely, don't support frames\n    </a>\n  </p>\n</iframe>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507784968783,"submitTime":1507784981884,"finishTime":1507784968958,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"23dc9915-6a02-4146-b24e-fdd4e6b66ed2"},{"version":"CommandV1","origId":202914,"guid":"65e4bc0e-7552-4d4b-8e19-dc4cf7132578","subtype":"command","commandType":"auto","position":7.299560546875,"command":"%md\nRead the following for more on catalyst optimizer and whole-stage code generation.\n\n* [https://jaceklaskowski.gitbooks.io/mastering-apache-spark/spark-sql-whole-stage-codegen.html](https://jaceklaskowski.gitbooks.io/mastering-apache-spark/spark-sql-whole-stage-codegen.html)\n* [https://databricks.com/blog/2015/04/13/deep-dive-into-spark-sqls-catalyst-optimizer.html](https://databricks.com/blog/2015/04/13/deep-dive-into-spark-sqls-catalyst-optimizer.html)\n* [https://databricks.com/blog/2016/05/23/apache-spark-as-a-compiler-joining-a-billion-rows-per-second-on-a-laptop.html](https://databricks.com/blog/2016/05/23/apache-spark-as-a-compiler-joining-a-billion-rows-per-second-on-a-laptop.html)\n\nTry bench-marks here:\n\n* [https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/6122906529858466/293651311471490/5382278320999420/latest.html](https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/6122906529858466/293651311471490/5382278320999420/latest.html)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"83b9e5f7-c66d-4a90-bb22-1bd797393b06"},{"version":"CommandV1","origId":202916,"guid":"db75e14d-18e0-4067-9fa9-5bc5d2544f0f","subtype":"command","commandType":"auto","position":7.3216552734375,"command":"// Create a Polygon DataFrame\nimport magellan.Polygon\n\ncase class PolygonExample(polygon: Polygon)\n\nval ring = Array(Point(1.0, 1.0), Point(1.0, -1.0), Point(-1.0, -1.0), Point(-1.0, 1.0), Point(1.0, 1.0))\nval polygon = Polygon(Array(0), ring)\n\nval polygons = sc.parallelize(Seq(\n  PolygonExample(Polygon(Array(0), ring))\n)).toDF()\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import magellan.Polygon\ndefined class PolygonExample\nring: Array[magellan.Point] = Array(Point(1.0, 1.0), Point(1.0, -1.0), Point(-1.0, -1.0), Point(-1.0, 1.0), Point(1.0, 1.0))\npolygon: magellan.Polygon = magellan.Polygon@1ed26b1\npolygons: org.apache.spark.sql.DataFrame = [polygon: polygon]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507785474421,"submitTime":1507785487530,"finishTime":1507785474982,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7fc3528c-be20-46d6-93ae-1c4f6faf7e5e"},{"version":"CommandV1","origId":202918,"guid":"a3cc7667-129b-472a-a295-24918215b711","subtype":"command","commandType":"auto","position":7.33270263671875,"command":"polygons.show(false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------------------+\n|polygon                  |\n+-------------------------+\n|magellan.Polygon@f36f7eca|\n+-------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507785478871,"submitTime":1507785491984,"finishTime":1507785479447,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"66e05716-111a-4280-b2dc-8d0065a5277d"},{"version":"CommandV1","origId":202919,"guid":"20d7b6c7-1462-4507-b185-3a8880d98449","subtype":"command","commandType":"auto","position":7.338226318359375,"command":"//display(polygons)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507785489667,"submitTime":1507785502782,"finishTime":1507785489813,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"88e833cf-e33b-4f3d-a66c-c2400d0265eb"},{"version":"CommandV1","origId":202933,"guid":"b63fe78b-20cf-4ebf-a290-b8d908766bee","subtype":"command","commandType":"auto","position":7.339607238769531,"command":"%md\n# Predicates","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ffe38a8b-ea9b-4fd7-b680-f0ef21211c45"},{"version":"CommandV1","origId":202920,"guid":"cfcffd28-ecf2-420e-82b0-f9a5db25397c","subtype":"command","commandType":"auto","position":7.3409881591796875,"command":"// join points with polygons upon intersection\npoints.withColumn(\"point\", point('x, 'y))\n      .join(polygons)\n      .where($\"point\" intersects $\"polygon\")\n      .count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res13: Long = 3\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507785579286,"submitTime":1507785592390,"finishTime":1507785584591,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ceb0227e-13a0-47ff-a970-3c100a00d168"},{"version":"CommandV1","origId":202921,"guid":"475be6fb-e241-452f-8019-1be0f33457c7","subtype":"command","commandType":"auto","position":7.342369079589844,"command":"// join points with polygons upon within or containement\npoints.withColumn(\"point\", point('x, 'y))\n      .join(polygons)\n      .where($\"point\" within $\"polygon\")\n      .count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res14: Long = 0\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507785614864,"submitTime":1507785627965,"finishTime":1507785618500,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1b69b87a-f99b-421e-bb1d-6b7a6c87f72f"},{"version":"CommandV1","origId":202925,"guid":"3b9dffbf-b10a-41cd-9c55-3286f0a685b8","subtype":"command","commandType":"auto","position":7.342714309692383,"command":"//creating line from two points\nimport magellan.Line\n\ncase class LineExample(line: Line)\n\nval line = Line(Point(1.0, 1.0), Point(1.0, -1.0))\n\nval lines = sc.parallelize(Seq(\n  LineExample(line)\n)).toDF()\n\ndisplay(lines)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[{"empty":false,"mid":{"empty":true,"valid":true,"type":1},"valid":true,"end":{"empty":true,"valid":true,"type":1},"type":2,"start":{"empty":true,"valid":true,"type":1}}]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"line","type":"{\"type\":\"udt\",\"class\":\"org.apache.spark.sql.types.LineUDT\",\"pyClass\":\"magellan.types.LineUDT\",\"sqlType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"type\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}},{\"name\":\"xmin\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ymin\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"xmax\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ymax\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"startX\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"startY\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"endX\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"endY\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}}]}}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:56: error: too many arguments for method apply: (start: magellan.Point, end: magellan.Point)magellan.Line in object Line\n       val line = Line(Point(1.0, 1.0), Point(1.0, -1.0), Point(2.0,2.0))\n                      ^\n</div>","error":null,"workflows":[],"startTime":1507786018317,"submitTime":1507786031446,"finishTime":1507786019013,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c69ed5e7-78ed-47e5-bee9-fd2304f26227"},{"version":"CommandV1","origId":202922,"guid":"f547b56f-6ce3-4295-a327-4b1bb5c02ce1","subtype":"command","commandType":"auto","position":7.343059539794922,"command":"// creating polyline\nimport magellan.PolyLine\n\ncase class PolyLineExample(polyline: PolyLine)\n\nval ring = Array(Point(1.0, 1.0), Point(1.0, -1.0), Point(-1.0, -1.0), Point(-1.0, 1.0))\n\nval polylines1 = sc.parallelize(Seq(\n  PolyLineExample(PolyLine(Array(0), ring))\n)).toDF()\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import magellan.PolyLine\ndefined class PolyLineExample\nring: Array[magellan.Point] = Array(Point(1.0, 1.0), Point(1.0, -1.0), Point(-1.0, -1.0), Point(-1.0, 1.0))\npolylines1: org.apache.spark.sql.DataFrame = [polyline: polyline]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786064776,"submitTime":1507786077893,"finishTime":1507786065108,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c7a8359b-d770-4932-93f7-cd187e8fbab4"},{"version":"CommandV1","origId":202923,"guid":"44035a13-0490-46b7-b630-5f9f8d56e88d","subtype":"command","commandType":"auto","position":7.343404769897461,"command":"display(polylines1)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[{"xcoordinates":[1.0,1.0,-1.0,-1.0],"indices":[0],"empty":false,"ycoordinates":[1.0,-1.0,-1.0,1.0],"boundingBox":{"xmin":-1.0,"ymin":-1.0,"xmax":1.0,"ymax":1.0},"valid":true,"type":3}]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"polyline","type":"{\"type\":\"udt\",\"class\":\"org.apache.spark.sql.types.PolyLineUDT\",\"pyClass\":\"magellan.types.PolyLineUDT\",\"sqlType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"type\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}},{\"name\":\"xmin\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ymin\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"xmax\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ymax\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"indices\",\"type\":{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":false},\"nullable\":true,\"metadata\":{}},{\"name\":\"xcoordinates\",\"type\":{\"type\":\"array\",\"elementType\":\"double\",\"containsNull\":false},\"nullable\":true,\"metadata\":{}},{\"name\":\"ycoordinates\",\"type\":{\"type\":\"array\",\"elementType\":\"double\",\"containsNull\":false},\"nullable\":true,\"metadata\":{}}]}}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786069361,"submitTime":1507786082484,"finishTime":1507786069796,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f634fd35-a3ca-4d02-b1a1-14659af018b5"},{"version":"CommandV1","origId":202924,"guid":"0847a556-c0bd-4f44-917c-3155f400c580","subtype":"command","commandType":"auto","position":7.3435773849487305,"command":"// now let's make a polyline with two or more lines out of the same ring\nval polylines2 = sc.parallelize(Seq(\n  PolyLineExample(PolyLine(Array(0,2), ring)) // first line starts are index 0 and second one starts at index 2\n)).toDF()\n\ndisplay(polylines2)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[{"xcoordinates":[1.0,1.0,-1.0,-1.0],"indices":[0,2],"empty":false,"ycoordinates":[1.0,-1.0,-1.0,1.0],"boundingBox":{"xmin":-1.0,"ymin":-1.0,"xmax":1.0,"ymax":1.0},"valid":true,"type":3}]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"polyline","type":"{\"type\":\"udt\",\"class\":\"org.apache.spark.sql.types.PolyLineUDT\",\"pyClass\":\"magellan.types.PolyLineUDT\",\"sqlType\":{\"type\":\"struct\",\"fields\":[{\"name\":\"type\",\"type\":\"integer\",\"nullable\":false,\"metadata\":{}},{\"name\":\"xmin\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ymin\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"xmax\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"ymax\",\"type\":\"double\",\"nullable\":false,\"metadata\":{}},{\"name\":\"indices\",\"type\":{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":false},\"nullable\":true,\"metadata\":{}},{\"name\":\"xcoordinates\",\"type\":{\"type\":\"array\",\"elementType\":\"double\",\"containsNull\":false},\"nullable\":true,\"metadata\":{}},{\"name\":\"ycoordinates\",\"type\":{\"type\":\"array\",\"elementType\":\"double\",\"containsNull\":false},\"nullable\":true,\"metadata\":{}}]}}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786111731,"submitTime":1507786124859,"finishTime":1507786112206,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"573ad0c9-db99-4e53-90a3-8b90869d9873"},{"version":"CommandV1","origId":202657,"guid":"73d0bfc6-0273-4a56-a547-3e4d49b621cf","subtype":"command","commandType":"auto","position":7.34375,"command":"%md\n\n## Check out the NYC Taxi Dataset in Magellan\n\n* [https://magellan.ghost.io/welcome-to-ghost/](https://magellan.ghost.io/welcome-to-ghost/)\n* [https://magellan.ghost.io/magellan-geospatial-processing-made-easy/](https://magellan.ghost.io/magellan-geospatial-processing-made-easy/)\n\nThis is a much larger dataset and we may need access to a larger cluster - unless we just analyse a smaller subset of the data (perhaps just a month of Taxi rides in NYC). We can understand the same concepts using a much smaller dataset of Uber rides in San Francisco. We will analyse this next.","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"be8b365e-76cb-48ef-b820-4a941f351523"},{"version":"CommandV1","origId":202658,"guid":"1ba9888b-05a6-4d14-a73d-e3c039c28b04","subtype":"command","commandType":"auto","position":13.0,"command":"%md \n## Uber Dataset for the Demo done by Ram Harsha in Europe Spark Summit 2015\n\nFirst the datasets have to be loaded.  See the section below on **Downloading datasets and putting them in distributed file system** for doing this anew (This only needs to be done once if the data is persisted in the distributed file system).","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451993438,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"98fac39c-cf2f-45c6-a0f7-f9223fceb049"},{"version":"CommandV1","origId":202659,"guid":"fe4f1e94-de4f-4eef-b363-2ff80fdf5fcb","subtype":"command","commandType":"auto","position":13.125,"command":"%md \nAfter downloading the data, we expect to have the following files in distributed file system (dbfs):\n\n* `all.tsv` is the file of all uber trajectories\n* `SFNbhd` is the directory containing SF neighborhood shape files.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451993551,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"28ee2bcd-f9bf-4f2a-86e0-89943e678953"},{"version":"CommandV1","origId":202660,"guid":"0e569e25-4342-475d-b940-31d5e2f11dec","subtype":"command","commandType":"auto","position":13.25,"command":"display(dbutils.fs.ls(\"dbfs:/datasets/magellan/\")) // display the contents of the dbfs directory \"dbfs:/datasets/magellan/\"","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/datasets/magellan/SFNbhd/","SFNbhd/",0],["dbfs:/datasets/magellan/all.tsv","all.tsv",60947802]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"java.io.FileNotFoundException: /datasets/magellan","error":"<div class=\"ansiout\">\tat com.databricks.backend.daemon.data.client.DbfsClient.send0(DbfsClient.scala:88)\n\tat com.databricks.backend.daemon.data.client.DbfsClient.sendIdempotent(DbfsClient.scala:52)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV1.listStatus(DatabricksFileSystemV1.scala:178)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystem.listStatus(DatabricksFileSystem.scala:136)\n\tat com.databricks.backend.daemon.dbutils.FSUtils$.ls(DBUtilsCore.scala:46)\n\tat com.databricks.dbutils_v1.impl.DbfsUtilsImpl.ls(DbfsUtilsImpl.scala:30)\n\tat line9ecec4a4e6e247ffabf1d24d12211b5025.$read$$iw$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:34)\n\tat line9ecec4a4e6e247ffabf1d24d12211b5025.$read$$iw$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:41)\n\tat line9ecec4a4e6e247ffabf1d24d12211b5025.$read$$iw$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:43)\n\tat line9ecec4a4e6e247ffabf1d24d12211b5025.$read$$iw$$iw$$iw.&lt;init&gt;(&lt;console&gt;:45)\n\tat line9ecec4a4e6e247ffabf1d24d12211b5025.$read$$iw$$iw.&lt;init&gt;(&lt;console&gt;:47)\n\tat line9ecec4a4e6e247ffabf1d24d12211b5025.$read$$iw.&lt;init&gt;(&lt;console&gt;:49)\n\tat line9ecec4a4e6e247ffabf1d24d12211b5025.$eval$.$print$lzycompute(&lt;console&gt;:7)\n\tat line9ecec4a4e6e247ffabf1d24d12211b5025.$eval$.$print(&lt;console&gt;:6)</div>","workflows":[],"startTime":1507786170001,"submitTime":1507786183131,"finishTime":1507786170521,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"80faa080-cc6f-49cd-9b9a-6c759b4c110a"},{"version":"CommandV1","origId":202661,"guid":"e661c16f-cf56-4efe-a94a-fb994f62a2b5","subtype":"command","commandType":"auto","position":13.265625,"command":"%md \nFirst five lines or rows of the uber data containing: tripID, timestamp, Lon, Lat","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451993664,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"51c99ddd-7c45-45ea-ae92-053c843bd685"},{"version":"CommandV1","origId":202662,"guid":"c03820f4-b571-4fb1-8515-a0721afdb6e8","subtype":"command","commandType":"auto","position":13.28125,"command":"sc.textFile(\"dbfs:/datasets/magellan/all.tsv\").take(5).foreach(println)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">00001\t2007-01-07T10:54:50+00:00\t37.782551\t-122.445368\n00001\t2007-01-07T10:54:54+00:00\t37.782745\t-122.444586\n00001\t2007-01-07T10:54:58+00:00\t37.782842\t-122.443688\n00001\t2007-01-07T10:55:02+00:00\t37.782919\t-122.442815\n00001\t2007-01-07T10:55:06+00:00\t37.782992\t-122.442112\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.hadoop.mapred.InvalidInputException: Input path does not exist: dbfs:/datasets/magellan/all.tsv","error":"<div class=\"ansiout\">\tat org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:197)\n\tat org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:208)\n\tat org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:207)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:239)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:237)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:237)\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:239)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:237)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:237)\n\tat org.apache.spark.rdd.RDD$$anonfun$take$1.apply(RDD.scala:1281)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:147)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:108)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:310)\n\tat org.apache.spark.rdd.RDD.take(RDD.scala:1276)</div>","workflows":[],"startTime":1507786174399,"submitTime":1507786187534,"finishTime":1507786176019,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb943ca7-a5b3-4e8d-909c-421b81c286f6"},{"version":"CommandV1","origId":202663,"guid":"bfd46ff0-4e83-4a0a-9508-4a1950bf09c7","subtype":"command","commandType":"auto","position":13.3125,"command":"display(dbutils.fs.ls(\"dbfs:/datasets/magellan/SFNbhd\")) // legacy shape files","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.dbf","planning_neighborhoods.dbf",1028],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.prj","planning_neighborhoods.prj",567],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.sbn","planning_neighborhoods.sbn",516],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.sbx","planning_neighborhoods.sbx",164],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.shp","planning_neighborhoods.shp",214576],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.shp.xml","planning_neighborhoods.shp.xml",21958],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.shx","planning_neighborhoods.shx",396]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"java.io.FileNotFoundException: /datasets/magellan/SFNbhd","error":"<div class=\"ansiout\">\tat com.databricks.backend.daemon.data.client.DbfsClient.send0(DbfsClient.scala:63)\n\tat com.databricks.backend.daemon.data.client.DbfsClient.sendIdempotent(DbfsClient.scala:40)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystem.listStatus(DatabricksFileSystem.scala:174)\n\tat com.databricks.backend.daemon.dbutils.FSUtils$.ls(DBUtilsCore.scala:60)\n\tat com.databricks.dbutils_v1.package$fs$.ls(dbutils_v1.scala:44)</div>","workflows":[],"startTime":1507786180485,"submitTime":1507786193608,"finishTime":1507786180734,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"808057d7-681f-49c3-8989-c7437650aece"},{"version":"CommandV1","origId":202664,"guid":"c5aea676-4b2f-4e64-a7b7-4b84339697a0","subtype":"command","commandType":"auto","position":13.4287109375,"command":"%md \n#### Homework\n\nFirst watch the more technical magellan presentation by Ram Sri Harsha (Hortonworks) in Spark Summit Europe 2015\n\n[![Ram Sri Harsha's Magellan Spark Summit EU 2015 Talk]](http://img.youtube.com/vi/rP8H-xQTuM0/0.jpg)](https://www.youtube.com/watch?v=rP8H-xQTuM0)\n  \n\nSecond, carefully repeat Ram's original analysis from the following blog as done below.\n\n[Ram's blog in HortonWorks](http://hortonworks.com/blog/magellan-geospatial-analytics-in-spark/) and the [ZeppelinHub view of the demo code in video above](https://www.zeppelinhub.com/viewer/notebooks/aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2hvcnRvbndvcmtzLWdhbGxlcnkvemVwcGVsaW4tbm90ZWJvb2tzL21hc3Rlci8yQjRUV0dDOE0vbm90ZS5qc29u)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451996101,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cadc58a1-b039-432d-83f1-ac557ce60f33"},{"version":"CommandV1","origId":202665,"guid":"f34d50c0-05df-496d-871c-56d3d9178cfa","subtype":"command","commandType":"auto","position":13.446533203125,"command":"%md\nThis is just to get you started... You may need to moidfy this!","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1de0c407-0dc8-4a02-8b33-8eb80bfe71cc"},{"version":"CommandV1","origId":202666,"guid":"41d9717a-28c7-4543-98de-d3715764ccbf","subtype":"command","commandType":"auto","position":13.46435546875,"command":"case class UberRecord(tripId: String, timestamp: String, point: Point) // a case class for UberRecord ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">defined class UberRecord\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:32: error: not found: type Point\n       case class UberRecord(tripId: String, timestamp: String, point: Point) // a case class for UberRecord\n                                                                       ^\n</div>","error":null,"workflows":[],"startTime":1507786196906,"submitTime":1507786209965,"finishTime":1507786197046,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"817afdbd-0196-4f24-8c3c-1927f884fbdc"},{"version":"CommandV1","origId":202667,"guid":"e490c488-54ce-4be2-a118-4914a33249d4","subtype":"command","commandType":"auto","position":13.5,"command":"val uber = sc.textFile(\"dbfs:/datasets/magellan/all.tsv\")\n              .map { line =>\n                      val parts = line.split(\"\\t\" )\n                      val tripId = parts(0)\n                      val timestamp = parts(1)\n                      val point = Point(parts(3).toDouble, parts(2).toDouble)\n                      UberRecord(tripId, timestamp, point)\n                    }\n                     //.repartition(100) // using default repartition\n                     .toDF()\n                     .cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">uber: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [tripId: string, timestamp: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:39: error: not found: value Point\n                             val point = Point(parts(3).toDouble, parts(2).toDouble)\n                                         ^\n&lt;console&gt;:40: error: not found: value UberRecord\n                             UberRecord(tripId, timestamp, point)\n                             ^\n</div>","error":null,"workflows":[],"startTime":1507786291207,"submitTime":1507786304335,"finishTime":1507786291601,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b0940c12-09f1-492d-88b7-d30bd2a1846c"},{"version":"CommandV1","origId":202668,"guid":"86db8a66-6682-45d8-883e-61ddadb14b52","subtype":"command","commandType":"auto","position":13.625,"command":"val uberRecordCount = uber.count() // how many Uber records?","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">uberRecordCount: Long = 1128663\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507786295533,"submitTime":1507786308664,"finishTime":1507786299326,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9bb5eafa-e5a6-4d83-b8a0-16f01fa9362f"},{"version":"CommandV1","origId":202669,"guid":"04d7c4e8-cef7-4f4c-b137-bd815102c36d","subtype":"command","commandType":"auto","position":13.6875,"command":"%md \nSo there are over a million ```UberRecord```s.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451996227,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"72e474b9-af02-49ed-889e-5a72d99f4763"},{"version":"CommandV1","origId":202670,"guid":"40d9e458-5643-450a-822f-fb41c38e5c54","subtype":"command","commandType":"auto","position":13.75,"command":"val neighborhoods = sqlContext.read.format(\"magellan\") // this may be busted... try to make it work...\n                                   .load(\"dbfs:/datasets/magellan/SFNbhd/\")\n                                   .select($\"polygon\", $\"metadata\")\n                                   .cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">neighborhoods: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [polygon: polygon, metadata: map&lt;string,string&gt;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507786315202,"submitTime":1507786328329,"finishTime":1507786316177,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c472c0a8-ffbd-46ea-9344-34047e4d30c7"},{"version":"CommandV1","origId":202671,"guid":"bbb2d546-379a-4b9e-a4cb-a811f0bb0752","subtype":"command","commandType":"auto","position":13.875,"command":"neighborhoods.count() // how many neighbourhoods in SF?","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res28: Long = 37\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507786319747,"submitTime":1507786332872,"finishTime":1507786320469,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ec47f963-ca3c-4d2c-8b7a-4e9c631207e6"},{"version":"CommandV1","origId":202672,"guid":"850d8ce3-6b9a-4530-9ed4-90e874fad593","subtype":"command","commandType":"auto","position":13.9140625,"command":"neighborhoods.printSchema","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">root\n |-- polygon: polygon (nullable = true)\n |-- metadata: map (nullable = true)\n |    |-- key: string\n |    |-- value: string (valueContainsNull = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507786323459,"submitTime":1507786336466,"finishTime":1507786323569,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"de89c69e-620f-4c82-be00-d4091af1c467"},{"version":"CommandV1","origId":202673,"guid":"75dd03b8-37cd-4a2d-b4d3-94eefab0e9e3","subtype":"command","commandType":"auto","position":13.921875,"command":"neighborhoods.show(2,false) // see the first two neighbourhoods","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------------------+--------------------------------------------+\n|polygon                  |metadata                                    |\n+-------------------------+--------------------------------------------+\n|magellan.Polygon@e18dd641|Map(neighborho -&gt; Twin Peaks               )|\n|magellan.Polygon@46d47c8 |Map(neighborho -&gt; Pacific Heights          )|\n+-------------------------+--------------------------------------------+\nonly showing top 2 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507786386517,"submitTime":1507786399644,"finishTime":1507786386752,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c02bde69-472b-4d53-b7fc-803ae3831edb"},{"version":"CommandV1","origId":202928,"guid":"1ba42cde-479a-46b3-92f4-431467ca56f5","subtype":"command","commandType":"auto","position":13.9267578125,"command":"import org.apache.spark.sql.functions._ // this is needed for sql functions like explode, etc.","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import org.apache.spark.sql.functions._\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786501029,"submitTime":1507786514102,"finishTime":1507786501126,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4734f4c7-963f-41b1-9d5d-830a1aef5d4f"},{"version":"CommandV1","origId":202674,"guid":"1570dc31-a4bd-484e-b3c2-8538d06b4499","subtype":"command","commandType":"auto","position":13.931640625,"command":"//names of all 37 neighborhoods of San Francisco\nneighborhoods.select(explode($\"metadata\").as(Seq(\"k\", \"v\"))).show(37,false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----------+-------------------------+\n|k         |v                        |\n+----------+-------------------------+\n|neighborho|Twin Peaks               |\n|neighborho|Pacific Heights          |\n|neighborho|Visitacion Valley        |\n|neighborho|Potrero Hill             |\n|neighborho|Crocker Amazon           |\n|neighborho|Outer Mission            |\n|neighborho|Bayview                  |\n|neighborho|Lakeshore                |\n|neighborho|Russian Hill             |\n|neighborho|Golden Gate Park         |\n|neighborho|Outer Sunset             |\n|neighborho|Inner Sunset             |\n|neighborho|Excelsior                |\n|neighborho|Outer Richmond           |\n|neighborho|Parkside                 |\n|neighborho|Bernal Heights           |\n|neighborho|Noe Valley               |\n|neighborho|Presidio                 |\n|neighborho|Nob Hill                 |\n|neighborho|Financial District       |\n|neighborho|Glen Park                |\n|neighborho|Marina                   |\n|neighborho|Seacliff                 |\n|neighborho|Mission                  |\n|neighborho|Downtown/Civic Center    |\n|neighborho|South of Market          |\n|neighborho|Presidio Heights         |\n|neighborho|Inner Richmond           |\n|neighborho|Castro/Upper Market      |\n|neighborho|West of Twin Peaks       |\n|neighborho|Ocean View               |\n|neighborho|Treasure Island/YBI      |\n|neighborho|Chinatown                |\n|neighborho|Western Addition         |\n|neighborho|North Beach              |\n|neighborho|Diamond Heights          |\n|neighborho|Haight Ashbury           |\n+----------+-------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:51: error: not found: value explode\n       neighborhoods.select(explode($&quot;metadata&quot;).as(Seq(&quot;k&quot;, &quot;v&quot;))).show(5,false)\n                            ^\n</div>","error":null,"workflows":[],"startTime":1507786571346,"submitTime":1507786584484,"finishTime":1507786571587,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e62aeb9d-d947-48f3-b07a-5c7baa910382"},{"version":"CommandV1","origId":202675,"guid":"ac2bbf7e-ae7a-4de0-94a1-de8f9803151c","subtype":"command","commandType":"auto","position":13.931884765625,"command":"%md\nThis join below yields nothing. \n\nSo what's going on?\n\nWatch Ram's 2015 Spark Summit talk for details on geospatial formats and transformations.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7c6af768-b339-4dec-81f4-934536ae6a27"},{"version":"CommandV1","origId":202676,"guid":"2c642cfa-159e-430f-afcf-d0cb7ee90c7d","subtype":"command","commandType":"auto","position":13.93212890625,"command":"neighborhoods\n  .join(uber)\n  .where($\"point\" within $\"polygon\")\n  .select($\"tripId\", $\"timestamp\", explode($\"metadata\").as(Seq(\"k\", \"v\")))\n  .withColumnRenamed(\"v\", \"neighborhood\")\n  .drop(\"k\")\n  .show(5)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------+---------+------------+\n|tripId|timestamp|neighborhood|\n+------+---------+------------+\n+------+---------+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:56: error: not found: value explode\n         .select($&quot;tripId&quot;, $&quot;timestamp&quot;, explode($&quot;metadata&quot;).as(Seq(&quot;k&quot;, &quot;v&quot;)))\n                                          ^\n</div>","error":null,"workflows":[],"startTime":1507786599633,"submitTime":1507786612773,"finishTime":1507786601135,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cba85fe5-6217-4381-91c3-fe077691eb8f"},{"version":"CommandV1","origId":202677,"guid":"e7ea5c48-12da-49ac-8ccb-bfd2345b4554","subtype":"command","commandType":"auto","position":13.9322509765625,"command":"%md\nNeed the right `transformer` to transform the points into the right coordinate system of the shape files.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"45a394a6-3c96-4e56-91b9-4e6e5a09d83a"},{"version":"CommandV1","origId":202927,"guid":"ab89dda9-5116-4338-8a8c-a209424502f0","subtype":"command","commandType":"auto","position":13.93231201171875,"command":"// This code was removed from magellan in this commit:\n// https://github.com/harsha2010/magellan/commit/8df0a62560116f8ed787fc7e86f190f8e2730826\n// We bring this back to show how to roll our own transformations.\nimport magellan.Point\n\nclass NAD83(params: Map[String, Any]) {\n  val RAD = 180d / Math.PI\n  val ER  = 6378137.toDouble  // semi-major axis for GRS-80\n  val RF  = 298.257222101  // reciprocal flattening for GRS-80\n  val F   = 1.toDouble / RF  // flattening for GRS-80\n  val ESQ = F + F - (F * F)\n  val E   = StrictMath.sqrt(ESQ)\n\n  private val ZONES =  Map(\n    401 -> Array(122.toDouble, 2000000.0001016,\n      500000.0001016001, 40.0,\n      41.66666666666667, 39.33333333333333),\n    403 -> Array(120.5, 2000000.0001016,\n      500000.0001016001, 37.06666666666667,\n      38.43333333333333, 36.5)\n  )\n\n  def from() = {\n    val zone = params(\"zone\").asInstanceOf[Int]\n    ZONES.get(zone) match {\n      case Some(x) => if (x.length == 5) {\n        toTransverseMercator(x)\n      } else {\n        toLambertConic(x)\n      }\n      case None => ???\n    }\n  }\n\n  def to() = {\n    val zone = params(\"zone\").asInstanceOf[Int]\n    ZONES.get(zone) match {\n      case Some(x) => if (x.length == 5) {\n        fromTransverseMercator(x)\n      } else {\n        fromLambertConic(x)\n      }\n      case None => ???\n    }\n  }\n\n  def qqq(e: Double, s: Double) = {\n    (StrictMath.log((1 + s) / (1 - s)) - e *\n      StrictMath.log((1 + e * s) / (1 - e * s))) / 2\n  }\n\n  def toLambertConic(params: Array[Double]) = {\n    val cm = params(0) / RAD  // CENTRAL MERIDIAN (CM)\n    val eo = params(1)  // FALSE EASTING VALUE AT THE CM (METERS)\n    val nb = params(2)  // FALSE NORTHING VALUE AT SOUTHERMOST PARALLEL (METERS), (USUALLY ZERO)\n    val fis = params(3) / RAD  // LATITUDE OF SO. STD. PARALLEL\n    val fin = params(4) / RAD  // LATITUDE OF NO. STD. PARALLEL\n    val fib = params(5) / RAD // LATITUDE OF SOUTHERNMOST PARALLEL\n    val sinfs = StrictMath.sin(fis)\n    val cosfs = StrictMath.cos(fis)\n    val sinfn = StrictMath.sin(fin)\n    val cosfn = StrictMath.cos(fin)\n    val sinfb = StrictMath.sin(fib)\n    val qs = qqq(E, sinfs)\n    val qn = qqq(E, sinfn)\n    val qb = qqq(E, sinfb)\n    val w1 = StrictMath.sqrt(1.toDouble - ESQ * sinfs * sinfs)\n    val w2 = StrictMath.sqrt(1.toDouble - ESQ * sinfn * sinfn)\n    val sinfo = StrictMath.log(w2 * cosfs / (w1 * cosfn)) / (qn - qs)\n    val k = ER * cosfs * StrictMath.exp(qs * sinfo) / (w1 * sinfo)\n    val rb = k / StrictMath.exp(qb * sinfo)\n\n    (point: Point) => {\n      val (long, lat) = (point.getX(), point.getY())\n      val l = - long / RAD\n      val f = lat / RAD\n      val q = qqq(E, StrictMath.sin(f))\n      val r = k / StrictMath.exp(q * sinfo)\n      val gam = (cm - l) * sinfo\n      val n = rb + nb - (r * StrictMath.cos(gam))\n      val e = eo + (r * StrictMath.sin(gam))\n      Point(e, n)\n    }\n  }\n\n  def toTransverseMercator(params: Array[Double]) = {\n    (point: Point) => {\n      point\n    }\n  }\n\n  def fromLambertConic(params: Array[Double]) = {\n    val cm = params(0) / RAD  // CENTRAL MERIDIAN (CM)\n    val eo = params(1)  // FALSE EASTING VALUE AT THE CM (METERS)\n    val nb = params(2)  // FALSE NORTHING VALUE AT SOUTHERMOST PARALLEL (METERS), (USUALLY ZERO)\n    val fis = params(3) / RAD  // LATITUDE OF SO. STD. PARALLEL\n    val fin = params(4) / RAD  // LATITUDE OF NO. STD. PARALLEL\n    val fib = params(5) / RAD // LATITUDE OF SOUTHERNMOST PARALLEL\n    val sinfs = StrictMath.sin(fis)\n    val cosfs = StrictMath.cos(fis)\n    val sinfn = StrictMath.sin(fin)\n    val cosfn = StrictMath.cos(fin)\n    val sinfb = StrictMath.sin(fib)\n\n    val qs = qqq(E, sinfs)\n    val qn = qqq(E, sinfn)\n    val qb = qqq(E, sinfb)\n    val w1 = StrictMath.sqrt(1.toDouble - ESQ * sinfs * sinfs)\n    val w2 = StrictMath.sqrt(1.toDouble - ESQ * sinfn * sinfn)\n    val sinfo = StrictMath.log(w2 * cosfs / (w1 * cosfn)) / (qn - qs)\n    val k = ER * cosfs * StrictMath.exp(qs * sinfo) / (w1 * sinfo)\n    val rb = k / StrictMath.exp(qb * sinfo)\n    (point: Point) => {\n      val easting = point.getX()\n      val northing = point.getY()\n      val npr = rb - northing + nb\n      val epr = easting - eo\n      val gam = StrictMath.atan(epr / npr)\n      val lon = cm - (gam / sinfo)\n      val rpt = StrictMath.sqrt(npr * npr + epr * epr)\n      val q = StrictMath.log(k / rpt) / sinfo\n      val temp = StrictMath.exp(q + q)\n      var sine = (temp - 1.toDouble) / (temp + 1.toDouble)\n      var f1, f2 = 0.0\n      for (i <- 0 until 2) {\n        f1 = ((StrictMath.log((1.toDouble + sine) / (1.toDouble - sine)) - E *\n          StrictMath.log((1.toDouble + E * sine) / (1.toDouble - E * sine))) / 2.toDouble) - q\n        f2 = 1.toDouble / (1.toDouble - sine * sine) - ESQ / (1.toDouble - ESQ * sine * sine)\n        sine -= (f1/ f2)\n      }\n      Point(StrictMath.toDegrees(lon) * -1, StrictMath.toDegrees(StrictMath.asin(sine)))\n    }\n  }\n\n  def fromTransverseMercator(params: Array[Double]) = {\n    val cm = params(0)  // CENTRAL MERIDIAN (CM)\n    val fe = params(1)  // FALSE EASTING VALUE AT THE CM (METERS)\n    val or = params(2) / RAD  // origin latitude\n    val sf = 1.0 - (1.0 / params(3)) // scale factor\n    val fn = params(4)  // false northing\n    // translated from TCONPC subroutine\n    val eps = ESQ / (1.0 - ESQ)\n    val pr = (1.0 - F) * ER\n    val en = (ER - pr) / (ER + pr)\n    val en2 = en * en\n    val en3 = en * en * en\n    val en4 = en2 * en2\n\n    var c2 = -3.0 * en / 2.0 + 9.0 * en3 / 16.0\n    var c4 = 15.0d * en2 / 16.0d - 15.0d * en4 /32.0\n    var c6 = -35.0 * en3 / 48.0\n    var c8 = 315.0 * en4 / 512.0\n    val u0 = 2.0 * (c2 - 2.0 * c4 + 3.0 * c6 - 4.0 * c8)\n    val u2 = 8.0 * (c4 - 4.0 * c6 + 10.0 * c8)\n    val u4 = 32.0 * (c6 - 6.0 * c8)\n    val u6 = 129.0 * c8\n\n    c2 = 3.0 * en / 2.0 - 27.0 * en3 / 32.0\n    c4 = 21.0 * en2 / 16.0 - 55.0 * en4 / 32.0d\n    c6 = 151.0 * en3 / 96.0\n    c8 = 1097.0d * en4 / 512.0\n    val v0 = 2.0 * (c2 - 2.0 * c4 + 3.0 * c6 - 4.0 * c8)\n    val v2 = 8.0 * (c4 - 4.0 * c6 + 10.0 * c8)\n    val v4 = 32.0 * (c6 - 6.0 * c8)\n    val v6 = 128.0 * c8\n\n    val r = ER * (1.0 - en) * (1.0 - en * en) * (1.0 + 2.25 * en * en + (225.0 / 64.0) * en4)\n    val cosor = StrictMath.cos(or)\n    val omo = or + StrictMath.sin(or) * cosor *\n      (u0 + u2 * cosor * cosor + u4 * StrictMath.pow(cosor, 4) + u6 * StrictMath.pow(cosor, 6))\n    val so = sf * r * omo\n\n    (point: Point) => {\n      val easting = point.getX()\n      val northing = point.getY()\n      // translated from TMGEOD subroutine\n      val om = (northing - fn + so) / (r * sf)\n      val cosom = StrictMath.cos(om)\n      val foot = om + StrictMath.sin(om) * cosom *\n        (v0 + v2 * cosom * cosom + v4 * StrictMath.pow(cosom, 4) + v6 * StrictMath.pow(cosom, 6))\n      val sinf = StrictMath.sin(foot)\n      val cosf = StrictMath.cos(foot)\n      val tn = sinf / cosf\n      val ts = tn * tn\n      val ets = eps * cosf * cosf\n      val rn = ER * sf / StrictMath.sqrt(1.0 - ESQ * sinf * sinf)\n      val q = (easting - fe) / rn\n      val qs = q * q\n      val b2 = -tn * (1.0 + ets) / 2.0\n      val b4 = -(5.0 + 3.0 * ts + ets * (1.0 - 9.0 * ts) - 4.0 * ets * ets) / 12.0\n      val b6 = (61.0 + 45.0 * ts * (2.0 + ts) + ets * (46.0 - 252.0 * ts -60.0 * ts * ts)) / 360.0\n      val b1 = 1.0\n      val b3 = -(1.0 + ts + ts + ets) / 6.0\n      val b5 = (5.0 + ts * (28.0 + 24.0 * ts) + ets * (6.0 + 8.0 * ts)) / 120.0\n      val b7 = -(61.0 + 662.0 * ts + 1320.0 * ts * ts + 720.0 * StrictMath.pow(ts, 3)) / 5040.0\n      val lat = foot + b2 * qs * (1.0 + qs * (b4 + b6 * qs))\n      val l = b1 * q * (1.0 + qs * (b3 + qs * (b5 + b7 * qs)))\n      val lon = -l / cosf + cm\n      Point(StrictMath.toDegrees(lon) * -1, StrictMath.toDegrees(lat))\n    }\n  }\n}","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">import magellan.Point\ndefined class NAD83\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786670817,"submitTime":1507786683942,"finishTime":1507786671589,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b1c47599-d0e0-4275-aea0-6786e1c78578"},{"version":"CommandV1","origId":202678,"guid":"ca266b4b-731e-4dce-a037-95aecc3779ab","subtype":"command","commandType":"auto","position":13.932373046875,"command":"val transformer: Point => Point = (point: Point) => {\n  val from = new NAD83(Map(\"zone\" -> 403)).from()\n  val p = point.transform(from)\n  Point(3.28084 * p.getX, 3.28084 * p.getY)\n}\n\n// add a new column in nad83 coordinates\nval uberTransformed = uber\n                      .withColumn(\"nad83\", $\"point\".transform(transformer))\n                      .cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">transformer: magellan.Point =&gt; magellan.Point = &lt;function1&gt;\nuberTransformed: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [tripId: string, timestamp: string ... 2 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<div class=\"ansiout\">&lt;console&gt;:58: error: too many arguments for constructor Point: ()magellan.Point\n           new Point(3.28084 * p.x, 3.28084 * p.y)\n           ^\n</div>","error":null,"workflows":[],"startTime":1507786748537,"submitTime":1507786761684,"finishTime":1507786748894,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4d40dd65-3063-49dd-b87e-4c531657d5c1"},{"version":"CommandV1","origId":202929,"guid":"58002875-20a7-4bb6-8325-3e4720b2eb1e","subtype":"command","commandType":"auto","position":13.93243408203125,"command":"uberTransformed.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res42: Long = 1128663\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786767491,"submitTime":1507786780616,"finishTime":1507786770464,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"12e19547-0309-4863-a27b-51822942c2c0"},{"version":"CommandV1","origId":202930,"guid":"2aa3d473-1cd9-4283-9173-cf628ff41ba9","subtype":"command","commandType":"auto","position":13.932464599609375,"command":"uberTransformed.show(5,false) // nad83 transformed points","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------+-------------------------+-----------------------------+---------------------------------------------+\n|tripId|timestamp                |point                        |nad83                                        |\n+------+-------------------------+-----------------------------+---------------------------------------------+\n|00001 |2007-01-07T10:54:50+00:00|Point(-122.445368, 37.782551)|Point(5999523.477715266, 2113253.7290443885) |\n|00001 |2007-01-07T10:54:54+00:00|Point(-122.444586, 37.782745)|Point(5999750.8888492435, 2113319.6570987953)|\n|00001 |2007-01-07T10:54:58+00:00|Point(-122.443688, 37.782842)|Point(6000011.08106823, 2113349.5785887106)  |\n|00001 |2007-01-07T10:55:02+00:00|Point(-122.442815, 37.782919)|Point(6000263.898268142, 2113372.3716762937) |\n|00001 |2007-01-07T10:55:06+00:00|Point(-122.442112, 37.782992)|Point(6000467.566895697, 2113394.7303657546) |\n+------+-------------------------+-----------------------------+---------------------------------------------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786793936,"submitTime":1507786807078,"finishTime":1507786794123,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4a7bc9a4-6297-4c2e-87e6-459e4f84dd1b"},{"version":"CommandV1","origId":202931,"guid":"6f12e94c-51f0-42e3-958a-39e932792a67","subtype":"command","commandType":"auto","position":13.932479858398438,"command":"uberTransformed.select(\"tripId\").distinct().count() // number of unique tripIds","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res45: Long = 24999\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786849813,"submitTime":1507786862962,"finishTime":1507786851490,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"0ab5f405-76a9-4927-ae7f-2a025002270f"},{"version":"CommandV1","origId":202679,"guid":"c8e07419-33ef-433f-ad4a-2a0c8ea996af","subtype":"command","commandType":"auto","position":13.9324951171875,"command":"%md\nLet' try the join again after appropriate transformation of coordinate system.","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"15c11eca-4c06-4984-860b-5e23a06ce84e"},{"version":"CommandV1","origId":202680,"guid":"3c32b637-c1f1-434d-8573-f275706e0324","subtype":"command","commandType":"auto","position":13.9326171875,"command":"val joined = neighborhoods\n              .join(uberTransformed)\n              .where($\"nad83\" within $\"polygon\")\n              .select($\"tripId\", $\"timestamp\", explode($\"metadata\").as(Seq(\"k\", \"v\")))\n              .withColumnRenamed(\"v\", \"neighborhood\")\n              .drop(\"k\")\n              .cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">joined: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [tripId: string, timestamp: string ... 1 more field]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507786883490,"submitTime":1507786896621,"finishTime":1507786883765,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a4daa35f-1e21-4057-8828-9a3fe0e50e30"},{"version":"CommandV1","origId":202682,"guid":"bd574022-41c5-4731-88ed-ae3c5c66931b","subtype":"command","commandType":"auto","position":13.932861328125,"command":"val UberRecordsInNbhdsCount = joined.count() // about 131 seconds for first action (doing broadcast hash join)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">UberRecordsInNbhdsCount: Long = 1085087\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786914105,"submitTime":1507786927244,"finishTime":1507786922065,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4bd2c7c6-23f7-4dfc-87d2-ad72483be607"},{"version":"CommandV1","origId":202681,"guid":"5b815459-01e8-4c50-919d-368947048d5b","subtype":"command","commandType":"auto","position":13.9329833984375,"command":"joined.show(5,false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------+-------------------------+-------------------------+\n|tripId|timestamp                |neighborhood             |\n+------+-------------------------+-------------------------+\n|00001 |2007-01-07T10:54:50+00:00|Western Addition         |\n|00001 |2007-01-07T10:54:54+00:00|Western Addition         |\n|00001 |2007-01-07T10:54:58+00:00|Western Addition         |\n|00001 |2007-01-07T10:55:02+00:00|Western Addition         |\n|00001 |2007-01-07T10:55:06+00:00|Western Addition         |\n+------+-------------------------+-------------------------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507786930215,"submitTime":1507786943362,"finishTime":1507786930417,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"787301f4-d295-441b-ba31-8b14bf19ddd2"},{"version":"CommandV1","origId":202683,"guid":"f7a430c8-ada8-461c-8c4c-b38f09a94244","subtype":"command","commandType":"auto","position":13.93304443359375,"command":"uberRecordCount - UberRecordsInNbhdsCount // records not in the neighbouthood shape files","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res48: Long = 43576\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507786983854,"submitTime":1507786996984,"finishTime":1507786983966,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"027b75e5-b4ec-4612-b3d5-570b8ba252e4"},{"version":"CommandV1","origId":202684,"guid":"b77ea90e-8290-4d35-9fe9-2e4870166c9c","subtype":"command","commandType":"auto","position":13.93310546875,"command":"joined\n  .groupBy($\"neighborhood\")\n  .agg(countDistinct(\"tripId\")\n  .as(\"trips\"))\n  .orderBy(col(\"trips\").desc)\n  .show(5,false)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------------------------+-----+\n|neighborhood             |trips|\n+-------------------------+-----+\n|South of Market          |9891 |\n|Western Addition         |6794 |\n|Downtown/Civic Center    |6697 |\n|Financial District       |6038 |\n|Mission                  |5620 |\n+-------------------------+-----+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507787012124,"submitTime":1507787025263,"finishTime":1507787015792,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"394f620f-723d-49f1-a7b3-8b85ad40e476"},{"version":"CommandV1","origId":202685,"guid":"9693303c-d7c9-4448-876d-46da13b4d83a","subtype":"command","commandType":"auto","position":13.966552734375,"command":"%md\n## Spatio-temporal Queries \n\ncan be expressed in SQL using the Boolean predicates such as, \\\\(\\in , \\cap, \\ldots \\\\), that operate over space-time sets given products of 2D magellan objects and 1D time intervals.\n\nWant to scalably do the following:\n\n* Given :\n  * a set of trajectories as labelled points in space-time and \n  * a product of a time interval [ts,te] and a polygon P\n* Find all labelled space-time points that satisfy the following relations:\n    * intersect with [ts,te] X P\n    * the start-time of the ride or the end time of the ride intersects with [ts,te] X P\n    * intersect within a given distance d of any point or a given point in P (optional)\n    \nThis will allow us to answer questions like:\n\n* Where did the passengers who were using Uber and present in the SoMa neighbourhood in a given time interval get off?\n\nSee 2016 student project by George Dillon on a detailed analysis of spatio-temporal taxi trajectories using the Beijing taxi dataset from Microsoft Research (including map-matching with open-street maps using magellan and graphhopper).\n\n\n**(watch later from 34 minutes for the first student presentation in *Scalable Data Science from Middle Earth 2016*)**:\n\n[![Spark Summit East 2016 - What is Geospatial Analytics by Ram Sri Harsha](http://img.youtube.com/vi/0wKxVfeBQBc/0.jpg)](https://www.youtube.com/watch?v=0wKxVfeBQBc?t=2058)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451996701,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"db4de0df-8e4f-43b0-8a7f-a2cf8c394ff6"},{"version":"CommandV1","origId":202686,"guid":"2773b385-c8ea-4831-a038-b82a5b3e7b35","subtype":"command","commandType":"auto","position":14.0,"command":"%md\n## Other spatial Algorithms in Spark are being explored for generic and more efficient scalable geospatial analytic tasks\nSee the Spark Summit East 2016 Talk by Ram on \"what next?\" and the latest notebooks on NYC taxi datasets in Ram's blogs.\n\nLatest versionb of magellan is already using clever spatial indexing structures.\n\n* [SpatialSpark](http://spark-packages.org/package/syoummer/SpatialSpark) aims to provide efficient spatial operations using Apache Spark.\n  * Spatial Partition \n      * Generate a spatial partition from input dataset, currently Fixed-Grid Partition (FGP), Binary-Split Partition (BSP) and Sort-Tile Partition (STP) are supported. \n  * Spatial Range Query\n      *  includes both indexed and non-indexed query (useful for neighbourhood searches)\n* [z-order Knn join](https://github.com/anantasty/SparkAlgorithms/tree/master/mllib/src/main/scala/org/sparkalgos/mllib/join)\n  * A space-filling curve trick to index multi-dimensional metric data into 1 Dimension. See: [ieee paper](http://ieeexplore.ieee.org.ezproxy.canterbury.ac.nz/stamp/stamp.jsp?tp=&arnumber=5447837) and the [slides](http://www.slideshare.net/AshutoshTrivedi3/spark-algorithms).\n  \n* AkNN = All K Nearest Neighbours - identify the k nearesy neighbours for all nodes **simultaneously** (cont AkNN is the streaming form of AkNN)\n  * need to identify the right resources to do this scalably.\n* spark-knn-graphs: [https://github.com/tdebatty/spark-knn-graphs](https://github.com/tdebatty/spark-knn-graphs)\n***\n***","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451996764,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9dfaa8ac-4dad-4ce9-8005-815978cc0646"},{"version":"CommandV1","origId":202687,"guid":"9ed6290e-857d-4873-a405-433fd2f338e0","subtype":"command","commandType":"auto","position":14.5,"command":"%md \n# Downloading datasets and putting them in dbfs","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451996829,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5907f717-3a64-4c40-b23b-0c59f0c6ee92"},{"version":"CommandV1","origId":202688,"guid":"f9a23f81-9ad3-44c8-a180-80cb34dcb43b","subtype":"command","commandType":"auto","position":14.625,"command":"%md\n## getting uber data \n### (This only needs to be done once per shard!)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451996895,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9a8770f0-8cec-450d-84c7-25ef48ebd91e"},{"version":"CommandV1","origId":202689,"guid":"fdb91012-c79d-4681-9dae-901deb60e741","subtype":"command","commandType":"auto","position":14.65625,"command":"%sh ls","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">conf\nderby.log\neventlogs\nlogs\norig_planning_neighborhoods.zip\nSFNbhd\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1507782804869,"submitTime":1507782817931,"finishTime":1507782804991,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"df67dfcd-6d94-4ee2-8135-2c77789e2b4c"},{"version":"CommandV1","origId":202690,"guid":"bbe91aff-cba6-4846-8bff-c5d2a5c11a76","subtype":"command","commandType":"auto","position":14.6875,"command":"%sh\nwget https://raw.githubusercontent.com/dima42/uber-gps-analysis/master/gpsdata/all.tsv","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">--2017-10-12 04:33:28--  https://raw.githubusercontent.com/dima42/uber-gps-analysis/master/gpsdata/all.tsv\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.52.133\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.52.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 60947802 (58M) [text/plain]\nSaving to: all.tsv\n\n     0K .......... .......... .......... .......... ..........  0% 2.88M 20s\n    50K .......... .......... .......... .......... ..........  0% 8.02M 14s\n   100K .......... .......... .......... .......... ..........  0% 15.5M 10s\n   150K .......... .......... .......... .......... ..........  0% 9.26M 9s\n   200K .......... .......... .......... .......... ..........  0% 12.6M 8s\n   250K .......... .......... .......... .......... ..........  0% 13.0M 8s\n   300K .......... .......... .......... .......... ..........  0% 12.2M 7s\n   350K .......... .......... .......... .......... ..........  0% 13.7M 7s\n   400K .......... .......... .......... .......... ..........  0% 11.4M 7s\n   450K .......... .......... .......... .......... ..........  0% 11.1M 7s\n   500K .......... .......... .......... .......... ..........  0% 21.6M 6s\n   550K .......... .......... .......... .......... ..........  1% 9.31M 6s\n   600K .......... .......... .......... .......... ..........  1% 21.2M 6s\n   650K .......... .......... .......... .......... ..........  1% 12.2M 6s\n   700K .......... .......... .......... .......... ..........  1% 18.3M 6s\n   750K .......... .......... .......... .......... ..........  1% 18.2M 5s\n   800K .......... .......... .......... .......... ..........  1% 9.76M 5s\n   850K .......... .......... .......... .......... ..........  1% 20.0M 5s\n   900K .......... .......... .......... .......... ..........  1% 13.2M 5s\n   950K .......... .......... .......... .......... ..........  1% 16.5M 5s\n  1000K .......... .......... .......... .......... ..........  1% 15.3M 5s\n  1050K .......... .......... .......... .......... ..........  1% 20.8M 5s\n  1100K .......... .......... .......... .......... ..........  1% 23.0M 5s\n  1150K .......... .......... .......... .......... ..........  2% 12.2M 5s\n  1200K .......... .......... .......... .......... ..........  2% 14.6M 5s\n  1250K .......... .......... .......... .......... ..........  2% 16.2M 5s\n  1300K .......... .......... .......... .......... ..........  2% 26.8M 5s\n  1350K .......... .......... .......... .......... ..........  2% 17.7M 5s\n  1400K .......... .......... .......... .......... ..........  2% 16.4M 5s\n  1450K .......... .......... .......... .......... ..........  2% 26.5M 4s\n  1500K .......... .......... .......... .......... ..........  2% 17.6M 4s\n  1550K .......... .......... .......... .......... ..........  2% 37.7M 4s\n  1600K .......... .......... .......... .......... ..........  2% 13.6M 4s\n  1650K .......... .......... .......... .......... ..........  2% 16.6M 4s\n  1700K .......... .......... .......... .......... ..........  2% 26.5M 4s\n  1750K .......... .......... .......... .......... ..........  3% 21.2M 4s\n  1800K .......... .......... .......... .......... ..........  3% 32.8M 4s\n  1850K .......... .......... .......... .......... ..........  3% 17.6M 4s\n  1900K .......... .......... .......... .......... ..........  3% 23.0M 4s\n  1950K .......... .......... .......... .......... ..........  3% 19.1M 4s\n  2000K .......... .......... .......... .......... ..........  3% 22.2M 4s\n  2050K .......... .......... .......... .......... ..........  3% 20.4M 4s\n  2100K .......... .......... .......... .......... ..........  3% 17.5M 4s\n  2150K .......... .......... .......... .......... ..........  3% 31.9M 4s\n  2200K .......... .......... .......... .......... ..........  3% 30.2M 4s\n  2250K .......... .......... .......... .......... ..........  3% 28.9M 4s\n  2300K .......... .......... .......... .......... ..........  3% 16.8M 4s\n  2350K .......... .......... .......... .......... ..........  4% 74.9M 4s\n  2400K .......... .......... .......... .......... ..........  4% 18.2M 4s\n  2450K .......... .......... .......... .......... ..........  4% 26.9M 4s\n  2500K .......... .......... .......... .......... ..........  4% 20.5M 4s\n  2550K .......... .......... .......... .......... ..........  4% 23.3M 4s\n  2600K .......... .......... .......... .......... ..........  4% 46.6M 4s\n  2650K .......... .......... .......... .......... ..........  4% 23.0M 4s\n  2700K .......... .......... .......... .......... ..........  4% 49.6M 3s\n  2750K .......... .......... .......... .......... ..........  4% 14.8M 3s\n  2800K .......... .......... .......... .......... ..........  4% 19.7M 3s\n  2850K .......... .......... .......... .......... ..........  4% 64.6M 3s\n  2900K .......... .......... .......... .......... ..........  4% 35.1M 3s\n  2950K .......... .......... .......... .......... ..........  5% 16.8M 3s\n  3000K .......... .......... .......... .......... ..........  5% 51.7M 3s\n  3050K .......... .......... .......... .......... ..........  5% 22.3M 3s\n  3100K .......... .......... .......... .......... ..........  5% 45.5M 3s\n  3150K .......... .......... .......... .......... ..........  5% 55.1M 3s\n  3200K .......... .......... .......... .......... ..........  5% 15.8M 3s\n  3250K .......... .......... .......... .......... ..........  5% 37.5M 3s\n  3300K .......... .......... .......... .......... ..........  5% 1.49M 4s\n  3350K .......... .......... .......... .......... ..........  5%  197M 4s\n  3400K .......... .......... .......... .......... ..........  5%  195M 4s\n  3450K .......... .......... .......... .......... ..........  5%  210M 4s\n  3500K .......... .......... .......... .......... ..........  5%  213M 4s\n  3550K .......... .......... .......... .......... ..........  6%  217M 3s\n  3600K .......... .......... .......... .......... ..........  6% 7.04M 4s\n  3650K .......... .......... .......... .......... ..........  6% 21.8M 4s\n  3700K .......... .......... .......... .......... ..........  6% 31.2M 3s\n  3750K .......... .......... .......... .......... ..........  6% 22.7M 3s\n  3800K .......... .......... .......... .......... ..........  6% 41.9M 3s\n  3850K .......... .......... .......... .......... ..........  6% 22.8M 3s\n  3900K .......... .......... .......... .......... ..........  6% 42.4M 3s\n  3950K .......... .......... .......... .......... ..........  6% 27.4M 3s\n  4000K .......... .......... .......... .......... ..........  6% 27.0M 3s\n  4050K .......... .......... .......... .......... ..........  6% 43.8M 3s\n  4100K .......... .......... .......... .......... ..........  6% 30.7M 3s\n  4150K .......... .......... .......... .......... ..........  7% 41.6M 3s\n  4200K .......... .......... .......... .......... ..........  7% 31.0M 3s\n  4250K .......... .......... .......... .......... ..........  7% 35.8M 3s\n  4300K .......... .......... .......... .......... ..........  7% 36.5M 3s\n  4350K .......... .......... .......... .......... ..........  7% 29.5M 3s\n  4400K .......... .......... .......... .......... ..........  7% 36.1M 3s\n  4450K .......... .......... .......... .......... ..........  7% 43.5M 3s\n  4500K .......... .......... .......... .......... ..........  7% 36.9M 3s\n  4550K .......... .......... .......... .......... ..........  7% 54.8M 3s\n  4600K .......... .......... .......... .......... ..........  7% 34.5M 3s\n  4650K .......... .......... .......... .......... ..........  7% 25.3M 3s\n  4700K .......... .......... .......... .......... ..........  7% 54.2M 3s\n  4750K .......... .......... .......... .......... ..........  8% 72.9M 3s\n  4800K .......... .......... .......... .......... ..........  8% 35.0M 3s\n  4850K .......... .......... .......... .......... ..........  8% 25.6M 3s\n  4900K .......... .......... .......... .......... ..........  8% 25.2M 3s\n  4950K .......... .......... .......... .......... ..........  8% 75.3M 3s\n  5000K .......... .......... .......... .......... ..........  8%  129M 3s\n  5050K .......... .......... .......... .......... ..........  8% 40.2M 3s\n  5100K .......... .......... .......... .......... ..........  8% 33.8M 3s\n  5150K .......... .......... .......... .......... ..........  8% 26.2M 3s\n  5200K .......... .......... .......... .......... ..........  8% 25.1M 3s\n  5250K .......... .......... .......... .......... ..........  8%  182M 3s\n  5300K .......... .......... .......... .......... ..........  8% 58.9M 3s\n  5350K .......... .......... .......... .......... ..........  9% 40.8M 3s\n  5400K .......... .......... .......... .......... ..........  9% 34.6M 3s\n  5450K .......... .......... .......... .......... ..........  9%  196M 3s\n  5500K .......... .......... .......... .......... ..........  9% 27.0M 3s\n  5550K .......... .......... .......... .......... ..........  9% 24.6M 3s\n  5600K .......... .......... .......... .......... ..........  9% 58.2M 3s\n  5650K .......... .......... .......... .......... ..........  9% 41.0M 3s\n  5700K .......... .......... .......... .......... ..........  9%  177M 3s\n  5750K .......... .......... .......... .......... ..........  9% 37.4M 3s\n  5800K .......... .......... .......... .......... ..........  9% 26.0M 3s\n  5850K .......... .......... .......... .......... ..........  9% 24.8M 3s\n  5900K .......... .......... .......... .......... ..........  9%  176M 3s\n  5950K .......... .......... .......... .......... .......... 10% 69.8M 3s\n  6000K .......... .......... .......... .......... .......... 10% 49.2M 3s\n  6050K .......... .......... .......... .......... .......... 10% 46.0M 3s\n  6100K .......... .......... .......... .......... .......... 10% 46.5M 3s\n  6150K .......... .......... .......... .......... .......... 10% 38.3M 3s\n  6200K .......... .......... .......... .......... .......... 10% 67.8M 3s\n  6250K .......... .......... .......... .......... .......... 10% 23.8M 3s\n  6300K .......... .......... .......... .......... .......... 10% 91.3M 3s\n  6350K .......... .......... .......... .......... .......... 10%  189M 2s\n  6400K .......... .......... .......... .......... .......... 10% 43.5M 2s\n  6450K .......... .......... .......... .......... .......... 10% 48.6M 2s\n  6500K .......... .......... .......... .......... .......... 11% 49.2M 2s\n  6550K .......... .......... .......... .......... .......... 11% 35.0M 2s\n  6600K .......... .......... .......... .......... .......... 11%  140M 2s\n  6650K .......... .......... .......... .......... .......... 11% 24.4M 2s\n  6700K .......... .......... .......... .......... .......... 11% 85.8M 2s\n  6750K .......... .......... .......... .......... .......... 11% 47.6M 2s\n  6800K .......... .......... .......... .......... .......... 11% 53.8M 2s\n  6850K .......... .......... .......... .......... .......... 11% 92.5M 2s\n  6900K .......... .......... .......... .......... .......... 11% 53.2M 2s\n  6950K .......... .......... .......... .......... .......... 11% 35.5M 2s\n  7000K .......... .......... .......... .......... .......... 11% 23.6M 2s\n  7050K .......... .......... .......... .......... .......... 11%  132M 2s\n  7100K .......... .......... .......... .......... .......... 12%  114M 2s\n  7150K .......... .......... .......... .......... .......... 12% 44.9M 2s\n  7200K .......... .......... .......... .......... .......... 12% 62.1M 2s\n  7250K .......... .......... .......... .......... .......... 12% 38.4M 2s\n  7300K .......... .......... .......... .......... .......... 12% 37.0M 2s\n  7350K .......... .......... .......... .......... .......... 12%  156M 2s\n  7400K .......... .......... .......... .......... .......... 12% 23.4M 2s\n  7450K .......... .......... .......... .......... .......... 12% 90.2M 2s\n  7500K .......... .......... .......... .......... .......... 12% 69.0M 2s\n  7550K .......... .......... .......... .......... .......... 12%  172M 2s\n  7600K .......... .......... .......... .......... .......... 12% 53.3M 2s\n  7650K .......... .......... .......... .......... .......... 12% 59.0M 2s\n  7700K .......... .......... .......... .......... .......... 13% 53.3M 2s\n  7750K .......... .......... .......... .......... .......... 13% 46.3M 2s\n  7800K .......... .......... .......... .......... .......... 13%  145M 2s\n  7850K .......... .......... .......... .......... .......... 13% 25.4M 2s\n  7900K .......... .......... .......... .......... .......... 13% 75.8M 2s\n  7950K .......... .......... .......... .......... .......... 13% 59.1M 2s\n  8000K .......... .......... .......... .......... .......... 13% 56.4M 2s\n  8050K .......... .......... .......... .......... .......... 13%  174M 2s\n  8100K .......... .......... .......... .......... .......... 13% 41.2M 2s\n  8150K .......... .......... .......... .......... .......... 13% 89.0M 2s\n  8200K .......... .......... .......... .......... .......... 13% 45.5M 2s\n  8250K .......... .......... .......... .......... .......... 13%  169M 2s\n  8300K .......... .......... .......... .......... .......... 14% 26.0M 2s\n  8350K .......... .......... .......... .......... .......... 14% 61.2M 2s\n  8400K .......... .......... .......... .......... .......... 14% 64.5M 2s\n  8450K .......... .......... .......... .......... .......... 14% 63.8M 2s\n  8500K .......... .......... .......... .......... .......... 14%  135M 2s\n  8550K .......... .......... .......... .......... .......... 14% 65.8M 2s\n  8600K .......... .......... .......... .......... .......... 14% 98.3M 2s\n  8650K .......... .......... .......... .......... .......... 14% 31.1M 2s\n  8700K .......... .......... .......... .......... .......... 14% 29.2M 2s\n  8750K .......... .......... .......... .......... .......... 14%  151M 2s\n  8800K .......... .......... .......... .......... .......... 14%  148M 2s\n  8850K .......... .......... .......... .......... .......... 14% 64.5M 2s\n  8900K .......... .......... .......... .......... .......... 15% 63.6M 2s\n  8950K .......... .......... .......... .......... .......... 15%  167M 2s\n  9000K .......... .......... .......... .......... .......... 15% 67.5M 2s\n  9050K .......... .......... .......... .......... .......... 15% 61.2M 2s\n  9100K .......... .......... .......... .......... .......... 15% 61.4M 2s\n  9150K .......... .......... .......... .......... .......... 15% 41.5M 2s\n  9200K .......... .......... .......... .......... .......... 15%  148M 2s\n  9250K .......... .......... .......... .......... .......... 15% 30.6M 2s\n  9300K .......... .......... .......... .......... .......... 15%  127M 2s\n  9350K .......... .......... .......... .......... .......... 15% 70.6M 2s\n  9400K .......... .......... .......... .......... .......... 15%  140M 2s\n  9450K .......... .......... .......... .......... .......... 15% 78.0M 2s\n  9500K .......... .......... .......... .......... .......... 16% 56.4M 2s\n  9550K .......... .......... .......... .......... .......... 16% 66.4M 2s\n  9600K .......... .......... .......... .......... .......... 16% 65.9M 2s\n  9650K .......... .......... .......... .......... .......... 16%  166M 2s\n  9700K .......... .......... .......... .......... .......... 16% 42.0M 2s\n  9750K .......... .......... .......... .......... .......... 16% 27.8M 2s\n  9800K .......... .......... .......... .......... .......... 16%  134M 2s\n  9850K .......... .......... .......... .......... .......... 16% 84.0M 2s\n  9900K .......... .......... .......... .......... .......... 16% 59.5M 2s\n  9950K .......... .......... .......... .......... .......... 16%  161M 2s\n 10000K .......... .......... .......... .......... .......... 16% 69.3M 2s\n 10050K .......... .......... .......... .......... .......... 16% 70.8M 2s\n 10100K .......... .......... .......... .......... .......... 17% 58.9M 2s\n 10150K .......... .......... .......... .......... .......... 17%  190M 2s\n 10200K .......... .......... .......... .......... .......... 17%  143M 2s\n 10250K .......... .......... .......... .......... .......... 17% 55.0M 2s\n 10300K .......... .......... .......... .......... .......... 17% 27.4M 2s\n 10350K .......... .......... .......... .......... .......... 17%  130M 2s\n 10400K .......... .......... .......... .......... .......... 17%  181M 2s\n 10450K .......... .......... .......... .......... .......... 17% 86.6M 2s\n 10500K .......... .......... .......... .......... .......... 17% 67.2M 2s\n 10550K .......... .......... .......... .......... .......... 17% 68.5M 2s\n 10600K .......... .......... .......... .......... .......... 17%  161M 2s\n 10650K .......... .......... .......... .......... .......... 17% 80.7M 2s\n 10700K .......... .......... .......... .......... .......... 18% 55.5M 2s\n 10750K .......... .......... .......... .......... .......... 18%  142M 2s\n 10800K .......... .......... .......... .......... .......... 18% 83.5M 2s\n 10850K .......... .......... .......... .......... .......... 18%  105M 2s\n 10900K .......... .......... .......... .......... .......... 18% 26.7M 2s\n 10950K .......... .......... .......... .......... .......... 18%  141M 2s\n 11000K .......... .......... .......... .......... .......... 18% 73.9M 2s\n 11050K .......... .......... .......... .......... .......... 18%  182M 2s\n 11100K .......... .......... .......... .......... .......... 18% 61.5M 2s\n 11150K .......... .......... .......... .......... .......... 18% 72.7M 2s\n 11200K .......... .......... .......... .......... .......... 18% 65.4M 2s\n 11250K .......... .......... .......... .......... .......... 18% 75.7M 2s\n 11300K .......... .......... .......... .......... .......... 19%  140M 2s\n 11350K .......... .......... .......... .......... .......... 19%  140M 2s\n 11400K .......... .......... .......... .......... .......... 19% 92.1M 2s\n 11450K .......... .......... .......... .......... .......... 19% 97.8M 2s\n 11500K .......... .......... .......... .......... .......... 19% 29.4M 2s\n 11550K .......... .......... .......... .......... .......... 19%  181M 2s\n 11600K .......... .......... .......... .......... .......... 19% 94.9M 2s\n 11650K .......... .......... .......... .......... .......... 19% 82.8M 2s\n 11700K .......... .......... .......... .......... .......... 19% 65.6M 2s\n 11750K .......... .......... .......... .......... .......... 19%  170M 2s\n 11800K .......... .......... .......... .......... .......... 19% 98.4M 2s\n 11850K .......... .......... .......... .......... .......... 19% 68.4M 2s\n 11900K .......... .......... .......... .......... .......... 20% 79.0M 2s\n 11950K .......... .......... .......... .......... .......... 20%  102M 2s\n 12000K .......... .......... .......... .......... .......... 20% 82.5M 2s\n 12050K .......... .......... .......... .......... .......... 20%  158M 2s\n 12100K .......... .......... .......... .......... .......... 20%  115M 2s\n 12150K .......... .......... .......... .......... .......... 20% 34.6M 2s\n 12200K .......... .......... .......... .......... .......... 20% 64.8M 2s\n 12250K .......... .......... .......... .......... .......... 20%  167M 2s\n 12300K .......... .......... .......... .......... .......... 20% 72.5M 1s\n 12350K .......... .......... .......... .......... .......... 20% 63.4M 1s\n 12400K .......... .......... .......... .......... .......... 20%  149M 1s\n 12450K .......... .......... .......... .......... .......... 21% 68.0M 1s\n 12500K .......... .......... .......... .......... .......... 21%  134M 1s\n 12550K .......... .......... .......... .......... .......... 21% 99.2M 1s\n 12600K .......... .......... .......... .......... .......... 21% 92.6M 1s\n 12650K .......... .......... .......... .......... .......... 21% 81.8M 1s\n 12700K .......... .......... .......... .......... .......... 21%  109M 1s\n 12750K .......... .......... .......... .......... .......... 21%  165M 1s\n 12800K .......... .......... .......... .......... .......... 21% 93.2M 1s\n 12850K .......... .......... .......... .......... .......... 21% 42.7M 1s\n 12900K .......... .......... .......... .......... .......... 21%  106M 1s\n 12950K .......... .......... .......... .......... .......... 21%  174M 1s\n 13000K .......... .......... .......... .......... .......... 21% 73.9M 1s\n 13050K .......... .......... .......... .......... .......... 22% 67.0M 1s\n 13100K .......... .......... .......... .......... .......... 22%  117M 1s\n 13150K .......... .......... .......... .......... .......... 22%  154M 1s\n 13200K .......... .......... .......... .......... .......... 22% 78.1M 1s\n 13250K .......... .......... .......... .......... .......... 22% 71.8M 1s\n 13300K .......... .......... .......... .......... .......... 22% 77.5M 1s\n 13350K .......... .......... .......... .......... .......... 22% 99.6M 1s\n 13400K .......... .......... .......... .......... .......... 22%  175M 1s\n 13450K .......... .......... .......... .......... .......... 22%  142M 1s\n 13500K .......... .......... .......... .......... .......... 22% 85.9M 1s\n 13550K .......... .......... .......... .......... .......... 22% 81.5M 1s\n 13600K .......... .......... .......... .......... .......... 22% 47.1M 1s\n 13650K .......... .......... .......... .......... .......... 23%  178M 1s\n 13700K .......... .......... .......... .......... .......... 23% 75.4M 1s\n 13750K .......... .......... .......... .......... .......... 23% 60.5M 1s\n 13800K .......... .......... .......... .......... .......... 23%  137M 1s\n 13850K .......... .......... .......... .......... .......... 23%  195M 1s\n 13900K .......... .......... .......... .......... .......... 23% 87.8M 1s\n 13950K .......... .......... .......... .......... .......... 23% 61.1M 1s\n 14000K .......... .......... .......... .......... .......... 23%  101M 1s\n 14050K .......... .......... .......... .......... .......... 23%  110M 1s\n 14100K .......... .......... .......... .......... .......... 23%  104M 1s\n 14150K .......... .......... .......... .......... .......... 23%  133M 1s\n 14200K .......... .......... .......... .......... .......... 23%  161M 1s\n 14250K .......... .......... .......... .......... .......... 24%  141M 1s\n 14300K .......... .......... .......... .......... .......... 24% 56.4M 1s\n 14350K .......... .......... .......... .......... .......... 24% 95.4M 1s\n 14400K .......... .......... .......... .......... .......... 24%  149M 1s\n 14450K .......... .......... .......... .......... .......... 24% 66.0M 1s\n 14500K .......... .......... .......... .......... .......... 24% 70.3M 1s\n 14550K .......... .......... .......... .......... .......... 24%  132M 1s\n 14600K .......... .......... .......... .......... .......... 24%  188M 1s\n 14650K .......... .......... .......... .......... .......... 24% 93.8M 1s\n 14700K .......... .......... .......... .......... .......... 24% 68.8M 1s\n 14750K .......... .......... .......... .......... .......... 24% 84.6M 1s\n 14800K .......... .......... .......... .......... .......... 24% 82.3M 1s\n 14850K .......... .......... .......... .......... .......... 25%  139M 1s\n 14900K .......... .......... .......... .......... .......... 25%  106M 1s\n 14950K .......... .......... .......... .......... .......... 25%  149M 1s\n 15000K .......... .......... .......... .......... .......... 25%  147M 1s\n 15050K .......... .......... .......... .......... .......... 25%  195M 1s\n 15100K .......... .......... .......... .......... .......... 25% 58.3M 1s\n 15150K .......... .......... .......... .......... .......... 25%  146M 1s\n 15200K .......... .......... .......... .......... .......... 25% 52.5M 1s\n 15250K .......... .......... .......... .......... .......... 25% 77.3M 1s\n 15300K .......... .......... .......... .......... .......... 25%  110M 1s\n 15350K .......... .......... .......... .......... .......... 25%  194M 1s\n 15400K .......... .......... .......... .......... .......... 25%  117M 1s\n 15450K .......... .......... .......... .......... .......... 26%  138M 1s\n 15500K .......... .......... .......... .......... .......... 26%  114M 1s\n 15550K .......... .......... .......... .......... .......... 26%  147M 1s\n 15600K .......... .......... .......... .......... .......... 26%  104M 1s\n 15650K .......... .......... .......... .......... .......... 26% 62.4M 1s\n 15700K .......... .......... .......... .......... .......... 26%  127M 1s\n 15750K .......... .......... .......... .......... .......... 26%  130M 1s\n 15800K .......... .......... .......... .......... .......... 26%  171M 1s\n 15850K .......... .......... .......... .......... .......... 26%  162M 1s\n 15900K .......... .......... .......... .......... .......... 26% 80.0M 1s\n 15950K .......... .......... .......... .......... .......... 26%  148M 1s\n 16000K .......... .......... .......... .......... .......... 26%  159M 1s\n 16050K .......... .......... .......... .......... .......... 27% 52.9M 1s\n 16100K .......... .......... .......... .......... .......... 27% 53.3M 1s\n 16150K .......... .......... .......... .......... .......... 27%  133M 1s\n\n*** WARNING: skipped 41040 bytes of output ***\n\n 43200K .......... .......... .......... .......... .......... 72%  160M 0s\n 43250K .......... .......... .......... .......... .......... 72%  136M 0s\n 43300K .......... .......... .......... .......... .......... 72%  139M 0s\n 43350K .......... .......... .......... .......... .......... 72%  146M 0s\n 43400K .......... .......... .......... .......... .......... 73%  123M 0s\n 43450K .......... .......... .......... .......... .......... 73%  135M 0s\n 43500K .......... .......... .......... .......... .......... 73%  111M 0s\n 43550K .......... .......... .......... .......... .......... 73%  135M 0s\n 43600K .......... .......... .......... .......... .......... 73%  135M 0s\n 43650K .......... .......... .......... .......... .......... 73%  140M 0s\n 43700K .......... .......... .......... .......... .......... 73%  133M 0s\n 43750K .......... .......... .......... .......... .......... 73%  154M 0s\n 43800K .......... .......... .......... .......... .......... 73%  124M 0s\n 43850K .......... .......... .......... .......... .......... 73%  130M 0s\n 43900K .......... .......... .......... .......... .......... 73%  110M 0s\n 43950K .......... .......... .......... .......... .......... 73%  151M 0s\n 44000K .......... .......... .......... .......... .......... 74%  138M 0s\n 44050K .......... .......... .......... .......... .......... 74%  126M 0s\n 44100K .......... .......... .......... .......... .......... 74%  136M 0s\n 44150K .......... .......... .......... .......... .......... 74%  161M 0s\n 44200K .......... .......... .......... .......... .......... 74%  157M 0s\n 44250K .......... .......... .......... .......... .......... 74%  148M 0s\n 44300K .......... .......... .......... .......... .......... 74%  110M 0s\n 44350K .......... .......... .......... .......... .......... 74%  166M 0s\n 44400K .......... .......... .......... .......... .......... 74%  155M 0s\n 44450K .......... .......... .......... .......... .......... 74%  137M 0s\n 44500K .......... .......... .......... .......... .......... 74%  128M 0s\n 44550K .......... .......... .......... .......... .......... 74% 3.98M 0s\n 44600K .......... .......... .......... .......... .......... 75%  148M 0s\n 44650K .......... .......... .......... .......... .......... 75%  143M 0s\n 44700K .......... .......... .......... .......... .......... 75% 97.6M 0s\n 44750K .......... .......... .......... .......... .......... 75%  167M 0s\n 44800K .......... .......... .......... .......... .......... 75%  158M 0s\n 44850K .......... .......... .......... .......... .......... 75%  146M 0s\n 44900K .......... .......... .......... .......... .......... 75%  137M 0s\n 44950K .......... .......... .......... .......... .......... 75%  136M 0s\n 45000K .......... .......... .......... .......... .......... 75%  147M 0s\n 45050K .......... .......... .......... .......... .......... 75%  156M 0s\n 45100K .......... .......... .......... .......... .......... 75%  132M 0s\n 45150K .......... .......... .......... .......... .......... 75%  158M 0s\n 45200K .......... .......... .......... .......... .......... 76%  140M 0s\n 45250K .......... .......... .......... .......... .......... 76%  163M 0s\n 45300K .......... .......... .......... .......... .......... 76%  140M 0s\n 45350K .......... .......... .......... .......... .......... 76%  158M 0s\n 45400K .......... .......... .......... .......... .......... 76% 95.0M 0s\n 45450K .......... .......... .......... .......... .......... 76%  155M 0s\n 45500K .......... .......... .......... .......... .......... 76%  131M 0s\n 45550K .......... .......... .......... .......... .......... 76%  152M 0s\n 45600K .......... .......... .......... .......... .......... 76%  192M 0s\n 45650K .......... .......... .......... .......... .......... 76% 12.9M 0s\n 45700K .......... .......... .......... .......... .......... 76%  126M 0s\n 45750K .......... .......... .......... .......... .......... 76%  140M 0s\n 45800K .......... .......... .......... .......... .......... 77%  140M 0s\n 45850K .......... .......... .......... .......... .......... 77%  146M 0s\n 45900K .......... .......... .......... .......... .......... 77%  134M 0s\n 45950K .......... .......... .......... .......... .......... 77%  140M 0s\n 46000K .......... .......... .......... .......... .......... 77%  155M 0s\n 46050K .......... .......... .......... .......... .......... 77%  159M 0s\n 46100K .......... .......... .......... .......... .......... 77%  123M 0s\n 46150K .......... .......... .......... .......... .......... 77%  152M 0s\n 46200K .......... .......... .......... .......... .......... 77%  152M 0s\n 46250K .......... .......... .......... .......... .......... 77%  128M 0s\n 46300K .......... .......... .......... .......... .......... 77%  116M 0s\n 46350K .......... .......... .......... .......... .......... 77%  126M 0s\n 46400K .......... .......... .......... .......... .......... 78%  147M 0s\n 46450K .......... .......... .......... .......... .......... 78%  142M 0s\n 46500K .......... .......... .......... .......... .......... 78%  105M 0s\n 46550K .......... .......... .......... .......... .......... 78%  137M 0s\n 46600K .......... .......... .......... .......... .......... 78%  163M 0s\n 46650K .......... .......... .......... .......... .......... 78%  133M 0s\n 46700K .......... .......... .......... .......... .......... 78%  130M 0s\n 46750K .......... .......... .......... .......... .......... 78%  128M 0s\n 46800K .......... .......... .......... .......... .......... 78%  153M 0s\n 46850K .......... .......... .......... .......... .......... 78%  147M 0s\n 46900K .......... .......... .......... .......... .......... 78%  130M 0s\n 46950K .......... .......... .......... .......... .......... 78%  155M 0s\n 47000K .......... .......... .......... .......... .......... 79%  156M 0s\n 47050K .......... .......... .......... .......... .......... 79%  143M 0s\n 47100K .......... .......... .......... .......... .......... 79%  133M 0s\n 47150K .......... .......... .......... .......... .......... 79%  146M 0s\n 47200K .......... .......... .......... .......... .......... 79%  159M 0s\n 47250K .......... .......... .......... .......... .......... 79%  163M 0s\n 47300K .......... .......... .......... .......... .......... 79%  113M 0s\n 47350K .......... .......... .......... .......... .......... 79%  122M 0s\n 47400K .......... .......... .......... .......... .......... 79%  129M 0s\n 47450K .......... .......... .......... .......... .......... 79%  115M 0s\n 47500K .......... .......... .......... .......... .......... 79%  119M 0s\n 47550K .......... .......... .......... .......... .......... 79%  135M 0s\n 47600K .......... .......... .......... .......... .......... 80%  148M 0s\n 47650K .......... .......... .......... .......... .......... 80%  143M 0s\n 47700K .......... .......... .......... .......... .......... 80%  122M 0s\n 47750K .......... .......... .......... .......... .......... 80%  145M 0s\n 47800K .......... .......... .......... .......... .......... 80%  122M 0s\n 47850K .......... .......... .......... .......... .......... 80%  148M 0s\n 47900K .......... .......... .......... .......... .......... 80%  116M 0s\n 47950K .......... .......... .......... .......... .......... 80%  149M 0s\n 48000K .......... .......... .......... .......... .......... 80%  162M 0s\n 48050K .......... .......... .......... .......... .......... 80%  158M 0s\n 48100K .......... .......... .......... .......... .......... 80%  132M 0s\n 48150K .......... .......... .......... .......... .......... 80%  159M 0s\n 48200K .......... .......... .......... .......... .......... 81%  157M 0s\n 48250K .......... .......... .......... .......... .......... 81%  155M 0s\n 48300K .......... .......... .......... .......... .......... 81%  131M 0s\n 48350K .......... .......... .......... .......... .......... 81%  136M 0s\n 48400K .......... .......... .......... .......... .......... 81%  163M 0s\n 48450K .......... .......... .......... .......... .......... 81%  165M 0s\n 48500K .......... .......... .......... .......... .......... 81%  130M 0s\n 48550K .......... .......... .......... .......... .......... 81%  155M 0s\n 48600K .......... .......... .......... .......... .......... 81%  144M 0s\n 48650K .......... .......... .......... .......... .......... 81%  157M 0s\n 48700K .......... .......... .......... .......... .......... 81%  136M 0s\n 48750K .......... .......... .......... .......... .......... 81%  141M 0s\n 48800K .......... .......... .......... .......... .......... 82%  160M 0s\n 48850K .......... .......... .......... .......... .......... 82%  142M 0s\n 48900K .......... .......... .......... .......... .......... 82%  143M 0s\n 48950K .......... .......... .......... .......... .......... 82%  146M 0s\n 49000K .......... .......... .......... .......... .......... 82%  143M 0s\n 49050K .......... .......... .......... .......... .......... 82%  156M 0s\n 49100K .......... .......... .......... .......... .......... 82%  132M 0s\n 49150K .......... .......... .......... .......... .......... 82%  150M 0s\n 49200K .......... .......... .......... .......... .......... 82%  159M 0s\n 49250K .......... .......... .......... .......... .......... 82%  146M 0s\n 49300K .......... .......... .......... .......... .......... 82%  129M 0s\n 49350K .......... .......... .......... .......... .......... 82%  153M 0s\n 49400K .......... .......... .......... .......... .......... 83%  138M 0s\n 49450K .......... .......... .......... .......... .......... 83%  155M 0s\n 49500K .......... .......... .......... .......... .......... 83%  113M 0s\n 49550K .......... .......... .......... .......... .......... 83%  159M 0s\n 49600K .......... .......... .......... .......... .......... 83%  167M 0s\n 49650K .......... .......... .......... .......... .......... 83%  149M 0s\n 49700K .......... .......... .......... .......... .......... 83%  142M 0s\n 49750K .......... .......... .......... .......... .......... 83%  158M 0s\n 49800K .......... .......... .......... .......... .......... 83%  146M 0s\n 49850K .......... .......... .......... .......... .......... 83%  159M 0s\n 49900K .......... .......... .......... .......... .......... 83%  121M 0s\n 49950K .......... .......... .......... .......... .......... 84%  139M 0s\n 50000K .......... .......... .......... .......... .......... 84%  166M 0s\n 50050K .......... .......... .......... .......... .......... 84%  141M 0s\n 50100K .......... .......... .......... .......... .......... 84%  124M 0s\n 50150K .......... .......... .......... .......... .......... 84%  148M 0s\n 50200K .......... .......... .......... .......... .......... 84%  129M 0s\n 50250K .......... .......... .......... .......... .......... 84%  148M 0s\n 50300K .......... .......... .......... .......... .......... 84%  114M 0s\n 50350K .......... .......... .......... .......... .......... 84%  153M 0s\n 50400K .......... .......... .......... .......... .......... 84%  163M 0s\n 50450K .......... .......... .......... .......... .......... 84%  132M 0s\n 50500K .......... .......... .......... .......... .......... 84%  134M 0s\n 50550K .......... .......... .......... .......... .......... 85%  136M 0s\n 50600K .......... .......... .......... .......... .......... 85%  132M 0s\n 50650K .......... .......... .......... .......... .......... 85%  139M 0s\n 50700K .......... .......... .......... .......... .......... 85% 98.2M 0s\n 50750K .......... .......... .......... .......... .......... 85%  150M 0s\n 50800K .......... .......... .......... .......... .......... 85%  143M 0s\n 50850K .......... .......... .......... .......... .......... 85%  133M 0s\n 50900K .......... .......... .......... .......... .......... 85%  132M 0s\n 50950K .......... .......... .......... .......... .......... 85%  147M 0s\n 51000K .......... .......... .......... .......... .......... 85%  147M 0s\n 51050K .......... .......... .......... .......... .......... 85%  151M 0s\n 51100K .......... .......... .......... .......... .......... 85%  117M 0s\n 51150K .......... .......... .......... .......... .......... 86%  140M 0s\n 51200K .......... .......... .......... .......... .......... 86%  128M 0s\n 51250K .......... .......... .......... .......... .......... 86%  157M 0s\n 51300K .......... .......... .......... .......... .......... 86%  129M 0s\n 51350K .......... .......... .......... .......... .......... 86%  123M 0s\n 51400K .......... .......... .......... .......... .......... 86%  151M 0s\n 51450K .......... .......... .......... .......... .......... 86%  149M 0s\n 51500K .......... .......... .......... .......... .......... 86%  120M 0s\n 51550K .......... .......... .......... .......... .......... 86%  155M 0s\n 51600K .......... .......... .......... .......... .......... 86%  113M 0s\n 51650K .......... .......... .......... .......... .......... 86%  142M 0s\n 51700K .......... .......... .......... .......... .......... 86%  137M 0s\n 51750K .......... .......... .......... .......... .......... 87%  148M 0s\n 51800K .......... .......... .......... .......... .......... 87%  125M 0s\n 51850K .......... .......... .......... .......... .......... 87%  117M 0s\n 51900K .......... .......... .......... .......... .......... 87%  119M 0s\n 51950K .......... .......... .......... .......... .......... 87%  142M 0s\n 52000K .......... .......... .......... .......... .......... 87%  142M 0s\n 52050K .......... .......... .......... .......... .......... 87%  147M 0s\n 52100K .......... .......... .......... .......... .......... 87% 86.6M 0s\n 52150K .......... .......... .......... .......... .......... 87%  127M 0s\n 52200K .......... .......... .......... .......... .......... 87%  139M 0s\n 52250K .......... .......... .......... .......... .......... 87%  133M 0s\n 52300K .......... .......... .......... .......... .......... 87%  105M 0s\n 52350K .......... .......... .......... .......... .......... 88%  120M 0s\n 52400K .......... .......... .......... .......... .......... 88%  131M 0s\n 52450K .......... .......... .......... .......... .......... 88%  142M 0s\n 52500K .......... .......... .......... .......... .......... 88% 97.6M 0s\n 52550K .......... .......... .......... .......... .......... 88%  139M 0s\n 52600K .......... .......... .......... .......... .......... 88% 3.94M 0s\n 52650K .......... .......... .......... .......... .......... 88%  140M 0s\n 52700K .......... .......... .......... .......... .......... 88%  134M 0s\n 52750K .......... .......... .......... .......... .......... 88%  155M 0s\n 52800K .......... .......... .......... .......... .......... 88%  152M 0s\n 52850K .......... .......... .......... .......... .......... 88%  140M 0s\n 52900K .......... .......... .......... .......... .......... 88%  142M 0s\n 52950K .......... .......... .......... .......... .......... 89%  147M 0s\n 53000K .......... .......... .......... .......... .......... 89%  117M 0s\n 53050K .......... .......... .......... .......... .......... 89%  157M 0s\n 53100K .......... .......... .......... .......... .......... 89%  135M 0s\n 53150K .......... .......... .......... .......... .......... 89%  162M 0s\n 53200K .......... .......... .......... .......... .......... 89%  147M 0s\n 53250K .......... .......... .......... .......... .......... 89%  150M 0s\n 53300K .......... .......... .......... .......... .......... 89%  130M 0s\n 53350K .......... .......... .......... .......... .......... 89%  158M 0s\n 53400K .......... .......... .......... .......... .......... 89%  142M 0s\n 53450K .......... .......... .......... .......... .......... 89%  140M 0s\n 53500K .......... .......... .......... .......... .......... 89%  137M 0s\n 53550K .......... .......... .......... .......... .......... 90%  145M 0s\n 53600K .......... .......... .......... .......... .......... 90%  165M 0s\n 53650K .......... .......... .......... .......... .......... 90%  168M 0s\n 53700K .......... .......... .......... .......... .......... 90%  129M 0s\n 53750K .......... .......... .......... .......... .......... 90%  133M 0s\n 53800K .......... .......... .......... .......... .......... 90%  127M 0s\n 53850K .......... .......... .......... .......... .......... 90%  126M 0s\n 53900K .......... .......... .......... .......... .......... 90%  126M 0s\n 53950K .......... .......... .......... .......... .......... 90%  140M 0s\n 54000K .......... .......... .......... .......... .......... 90%  140M 0s\n 54050K .......... .......... .......... .......... .......... 90%  164M 0s\n 54100K .......... .......... .......... .......... .......... 90%  132M 0s\n 54150K .......... .......... .......... .......... .......... 91%  159M 0s\n 54200K .......... .......... .......... .......... .......... 91%  160M 0s\n 54250K .......... .......... .......... .......... .......... 91%  144M 0s\n 54300K .......... .......... .......... .......... .......... 91%  137M 0s\n 54350K .......... .......... .......... .......... .......... 91%  134M 0s\n 54400K .......... .......... .......... .......... .......... 91%  134M 0s\n 54450K .......... .......... .......... .......... .......... 91%  132M 0s\n 54500K .......... .......... .......... .......... .......... 91%  112M 0s\n 54550K .......... .......... .......... .......... .......... 91%  127M 0s\n 54600K .......... .......... .......... .......... .......... 91%  156M 0s\n 54650K .......... .......... .......... .......... .......... 91%  145M 0s\n 54700K .......... .......... .......... .......... .......... 91%  134M 0s\n 54750K .......... .......... .......... .......... .......... 92%  148M 0s\n 54800K .......... .......... .......... .......... .......... 92%  158M 0s\n 54850K .......... .......... .......... .......... .......... 92%  147M 0s\n 54900K .......... .......... .......... .......... .......... 92%  109M 0s\n 54950K .......... .......... .......... .......... .......... 92%  132M 0s\n 55000K .......... .......... .......... .......... .......... 92%  128M 0s\n 55050K .......... .......... .......... .......... .......... 92%  131M 0s\n 55100K .......... .......... .......... .......... .......... 92%  117M 0s\n 55150K .......... .......... .......... .......... .......... 92%  144M 0s\n 55200K .......... .......... .......... .......... .......... 92%  164M 0s\n 55250K .......... .......... .......... .......... .......... 92%  160M 0s\n 55300K .......... .......... .......... .......... .......... 92%  131M 0s\n 55350K .......... .......... .......... .......... .......... 93%  157M 0s\n 55400K .......... .......... .......... .......... .......... 93%  122M 0s\n 55450K .......... .......... .......... .......... .......... 93%  134M 0s\n 55500K .......... .......... .......... .......... .......... 93%  117M 0s\n 55550K .......... .......... .......... .......... .......... 93%  125M 0s\n 55600K .......... .......... .......... .......... .......... 93%  142M 0s\n 55650K .......... .......... .......... .......... .......... 93%  151M 0s\n 55700K .......... .......... .......... .......... .......... 93%  129M 0s\n 55750K .......... .......... .......... .......... .......... 93%  157M 0s\n 55800K .......... .......... .......... .......... .......... 93%  143M 0s\n 55850K .......... .......... .......... .......... .......... 93%  140M 0s\n 55900K .......... .......... .......... .......... .......... 94%  110M 0s\n 55950K .......... .......... .......... .......... .......... 94%  129M 0s\n 56000K .......... .......... .......... .......... .......... 94%  137M 0s\n 56050K .......... .......... .......... .......... .......... 94%  146M 0s\n 56100K .......... .......... .......... .......... .......... 94%  141M 0s\n 56150K .......... .......... .......... .......... .......... 94%  139M 0s\n 56200K .......... .......... .......... .......... .......... 94% 47.7M 0s\n 56250K .......... .......... .......... .......... .......... 94%  155M 0s\n 56300K .......... .......... .......... .......... .......... 94%  130M 0s\n 56350K .......... .......... .......... .......... .......... 94%  142M 0s\n 56400K .......... .......... .......... .......... .......... 94%  150M 0s\n 56450K .......... .......... .......... .......... .......... 94% 4.21M 0s\n 56500K .......... .......... .......... .......... .......... 95%  141M 0s\n 56550K .......... .......... .......... .......... .......... 95%  155M 0s\n 56600K .......... .......... .......... .......... .......... 95%  136M 0s\n 56650K .......... .......... .......... .......... .......... 95%  158M 0s\n 56700K .......... .......... .......... .......... .......... 95%  131M 0s\n 56750K .......... .......... .......... .......... .......... 95%  161M 0s\n 56800K .......... .......... .......... .......... .......... 95%  162M 0s\n 56850K .......... .......... .......... .......... .......... 95%  134M 0s\n 56900K .......... .......... .......... .......... .......... 95%  145M 0s\n 56950K .......... .......... .......... .......... .......... 95%  158M 0s\n 57000K .......... .......... .......... .......... .......... 95%  155M 0s\n 57050K .......... .......... .......... .......... .......... 95%  158M 0s\n 57100K .......... .......... .......... .......... .......... 96%  121M 0s\n 57150K .......... .......... .......... .......... .......... 96%  164M 0s\n 57200K .......... .......... .......... .......... .......... 96%  164M 0s\n 57250K .......... .......... .......... .......... .......... 96%  129M 0s\n 57300K .......... .......... .......... .......... .......... 96% 95.5M 0s\n 57350K .......... .......... .......... .......... .......... 96%  160M 0s\n 57400K .......... .......... .......... .......... .......... 96% 11.5M 0s\n 57450K .......... .......... .......... .......... .......... 96%  149M 0s\n 57500K .......... .......... .......... .......... .......... 96%  134M 0s\n 57550K .......... .......... .......... .......... .......... 96%  153M 0s\n 57600K .......... .......... .......... .......... .......... 96%  161M 0s\n 57650K .......... .......... .......... .......... .......... 96%  146M 0s\n 57700K .......... .......... .......... .......... .......... 97%  142M 0s\n 57750K .......... .......... .......... .......... .......... 97%  153M 0s\n 57800K .......... .......... .......... .......... .......... 97%  143M 0s\n 57850K .......... .......... .......... .......... .......... 97%  156M 0s\n 57900K .......... .......... .......... .......... .......... 97%  133M 0s\n 57950K .......... .......... .......... .......... .......... 97%  148M 0s\n 58000K .......... .......... .......... .......... .......... 97%  159M 0s\n 58050K .......... .......... .......... .......... .......... 97%  141M 0s\n 58100K .......... .......... .......... .......... .......... 97%  142M 0s\n 58150K .......... .......... .......... .......... .......... 97%  160M 0s\n 58200K .......... .......... .......... .......... .......... 97%  140M 0s\n 58250K .......... .......... .......... .......... .......... 97%  160M 0s\n 58300K .......... .......... .......... .......... .......... 98%  126M 0s\n 58350K .......... .......... .......... .......... .......... 98%  165M 0s\n 58400K .......... .......... .......... .......... .......... 98%  165M 0s\n 58450K .......... .......... .......... .......... .......... 98%  147M 0s\n 58500K .......... .......... .......... .......... .......... 98%  145M 0s\n 58550K .......... .......... .......... .......... .......... 98%  161M 0s\n 58600K .......... .......... .......... .......... .......... 98%  136M 0s\n 58650K .......... .......... .......... .......... .......... 98%  153M 0s\n 58700K .......... .......... .......... .......... .......... 98%  136M 0s\n 58750K .......... .......... .......... .......... .......... 98%  141M 0s\n 58800K .......... .......... .......... .......... .......... 98%  163M 0s\n 58850K .......... .......... .......... .......... .......... 98%  146M 0s\n 58900K .......... .......... .......... .......... .......... 99%  146M 0s\n 58950K .......... .......... .......... .......... .......... 99%  156M 0s\n 59000K .......... .......... .......... .......... .......... 99%  160M 0s\n 59050K .......... .......... .......... .......... .......... 99%  158M 0s\n 59100K .......... .......... .......... .......... .......... 99%  121M 0s\n 59150K .......... .......... .......... .......... .......... 99%  164M 0s\n 59200K .......... .......... .......... .......... .......... 99%  161M 0s\n 59250K .......... .......... .......... .......... .......... 99%  137M 0s\n 59300K .......... .......... .......... .......... .......... 99%  145M 0s\n 59350K .......... .......... .......... .......... .......... 99%  157M 0s\n 59400K .......... .......... .......... .......... .......... 99%  140M 0s\n 59450K .......... .......... .......... .......... .......... 99%  161M 0s\n 59500K .......... .........                                  100%  126M=0.8s\n\n2017-10-12 04:33:30 (70.9 MB/s) - all.tsv saved [60947802/60947802]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1507782808806,"submitTime":1507782821810,"finishTime":1507782810620,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"08f6370f-8b4a-4a2c-98e2-df16affb5052"},{"version":"CommandV1","origId":202691,"guid":"03cf3067-b795-453a-89ff-a15bde46ad76","subtype":"command","commandType":"auto","position":14.6953125,"command":"%sh\npwd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/databricks/driver\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1507782813786,"submitTime":1507782826844,"finishTime":1507782813859,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b7e2098f-9f3a-44e6-8572-29e1a78c7c6a"},{"version":"CommandV1","origId":202692,"guid":"7ebb9df3-e197-4b64-8298-ebe2e17c05fb","subtype":"command","commandType":"auto","position":14.703125,"command":"dbutils.fs.mkdirs(\"dbfs:/datasets/magellan\") //need not be done again!","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res4: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1507782817782,"submitTime":1507782830844,"finishTime":1507782818093,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cb4885f9-fa29-4fe9-8971-009ce766d9fc"},{"version":"CommandV1","origId":202693,"guid":"224a368f-ad80-48bb-85f0-50ec1dc11e47","subtype":"command","commandType":"auto","position":14.71875,"command":"dbutils.fs.cp(\"file:/databricks/driver/all.tsv\", \"dbfs:/datasets/magellan/\") ","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res5: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"java.io.FileNotFoundException: File file:/home/ubuntu/databricks/driver/all.tsv does not exist.","error":"<div class=\"ansiout\">\tat org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:402)\n\tat org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:255)\n\tat com.databricks.backend.daemon.dbutils.FSUtils$.cp(DBUtilsCore.scala:81)\n\tat com.databricks.dbutils_v1.package$fs$.cp(dbutils_v1.scala:86)</div>","workflows":[],"startTime":1507782821416,"submitTime":1507782834488,"finishTime":1507782827563,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"749fa6f5-8b6c-42c3-85a4-9365b8fe4a2c"},{"version":"CommandV1","origId":202694,"guid":"30969093-6540-4761-8ca2-2d4d793e6be4","subtype":"command","commandType":"auto","position":14.734375,"command":"%md \n## Getting SF Neighborhood Data","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451997215,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fb892ac1-069b-464c-a247-d7d1b397b20e"},{"version":"CommandV1","origId":202695,"guid":"548be6c0-67d8-4044-aab7-52d264cafa7b","subtype":"command","commandType":"auto","position":14.7421875,"command":"%sh\nwget http://www.lamastex.org/courses/ScalableDataScience/2016/datasets/magellan/UberSF/planning_neighborhoods.zip","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">--2017-10-12 04:32:33--  http://www.lamastex.org/courses/ScalableDataScience/2016/datasets/magellan/UberSF/planning_neighborhoods.zip\nResolving www.lamastex.org (www.lamastex.org)... 166.62.28.100\nConnecting to www.lamastex.org (www.lamastex.org)|166.62.28.100|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 163771 (160K) [application/zip]\nSaving to: planning_neighborhoods.zip\n\n     0K .......... .......... .......... .......... .......... 31%  128K 1s\n    50K .......... .......... .......... .......... .......... 62%  257K 0s\n   100K .......... .......... .......... .......... .......... 93%  257K 0s\n   150K .........                                             100% 35.5M=0.8s\n\n2017-10-12 04:32:35 (205 KB/s) - planning_neighborhoods.zip saved [163771/163771]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507782753943,"submitTime":1507782766089,"finishTime":1507782755353,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4faf8edc-1f61-4ea0-ba17-98649e29164f"},{"version":"CommandV1","origId":202696,"guid":"62d8697e-01a2-40d3-8058-0fe887948096","subtype":"command","commandType":"auto","position":14.74609375,"command":"%sh\nunzip planning_neighborhoods.zip","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Archive:  planning_neighborhoods.zip\n  inflating: planning_neighborhoods.dbf  \n  inflating: planning_neighborhoods.shx  \n  inflating: planning_neighborhoods.shp.xml  \n  inflating: planning_neighborhoods.shp  \n  inflating: planning_neighborhoods.sbx  \n  inflating: planning_neighborhoods.sbn  \n  inflating: planning_neighborhoods.prj  \n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507782760665,"submitTime":1507782773723,"finishTime":1507782760737,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"94f50d06-aa5f-4736-8c34-397c71e6d80f"},{"version":"CommandV1","origId":202697,"guid":"3323e8cc-64fa-4227-afd8-cccb28ad36fd","subtype":"command","commandType":"auto","position":14.7470703125,"command":"%sh \nmv planning_neighborhoods.zip orig_planning_neighborhoods.zip","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507782764942,"submitTime":1507782777974,"finishTime":1507782765015,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"f1951a4f-5cce-4884-a0a5-ee1adb77a629"},{"version":"CommandV1","origId":202698,"guid":"4a08f4c1-505c-4efe-bd9f-2174be733315","subtype":"command","commandType":"auto","position":14.748046875,"command":"%sh\nmkdir SFNbhd && mv planning_nei* SFNbhd && ls \nls SFNbhd","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">conf\nderby.log\neventlogs\nlogs\norig_planning_neighborhoods.zip\nSFNbhd\nplanning_neighborhoods.dbf\nplanning_neighborhoods.prj\nplanning_neighborhoods.sbn\nplanning_neighborhoods.sbx\nplanning_neighborhoods.shp\nplanning_neighborhoods.shp.xml\nplanning_neighborhoods.shx\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507782767135,"submitTime":1507782780193,"finishTime":1507782767206,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b0210f3b-11fe-45a9-9b19-7892d876445e"},{"version":"CommandV1","origId":202699,"guid":"1f24a2dc-5054-4280-8164-bedf34085676","subtype":"command","commandType":"auto","position":14.74853515625,"command":"dbutils.fs.mkdirs(\"dbfs:/datasets/magellan/SFNbhd\") //need not be done again!","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res1: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507782770888,"submitTime":1507782783957,"finishTime":1507782771230,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9349645b-b531-4b52-9f26-0ad7c6e9e37b"},{"version":"CommandV1","origId":202700,"guid":"1cf89b46-a231-437a-93e0-c3896d1699dc","subtype":"command","commandType":"auto","position":14.7490234375,"command":"dbutils.fs.cp(\"file:/databricks/driver/SFNbhd/planning_neighborhoods.dbf\", \"dbfs:/datasets/magellan/SFNbhd/\")\ndbutils.fs.cp(\"file:/databricks/driver/SFNbhd/planning_neighborhoods.prj\", \"dbfs:/datasets/magellan/SFNbhd/\")\ndbutils.fs.cp(\"file:/databricks/driver/SFNbhd/planning_neighborhoods.sbn\", \"dbfs:/datasets/magellan/SFNbhd/\")\ndbutils.fs.cp(\"file:/databricks/driver/SFNbhd/planning_neighborhoods.sbx\", \"dbfs:/datasets/magellan/SFNbhd/\")\ndbutils.fs.cp(\"file:/databricks/driver/SFNbhd/planning_neighborhoods.shp\", \"dbfs:/datasets/magellan/SFNbhd/\")\ndbutils.fs.cp(\"file:/databricks/driver/SFNbhd/planning_neighborhoods.shp.xml\", \"dbfs:/datasets/magellan/SFNbhd/\")\ndbutils.fs.cp(\"file:/databricks/driver/SFNbhd/planning_neighborhoods.shx\", \"dbfs:/datasets/magellan/SFNbhd/\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res2: Boolean = true\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"java.io.FileNotFoundException: File file:/home/ubuntu/databricks/driver/SFNbhd/planning_neighborhoods.dbf does not exist.","error":"<div class=\"ansiout\">\tat org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:402)\n\tat org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:255)\n\tat com.databricks.backend.daemon.dbutils.FSUtils$.cp(DBUtilsCore.scala:81)\n\tat com.databricks.dbutils_v1.package$fs$.cp(dbutils_v1.scala:86)</div>","workflows":[],"startTime":1507782774355,"submitTime":1507782787424,"finishTime":1507782784119,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c25c3144-426c-4218-9f4a-d6aeec03efa5"},{"version":"CommandV1","origId":202701,"guid":"4bf3af7b-f653-4f4b-bd90-c32c04c248f0","subtype":"command","commandType":"auto","position":14.74951171875,"command":"display(dbutils.fs.ls(\"dbfs:/datasets/magellan/SFNbhd/\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.dbf","planning_neighborhoods.dbf",1028],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.prj","planning_neighborhoods.prj",567],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.sbn","planning_neighborhoods.sbn",516],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.sbx","planning_neighborhoods.sbx",164],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.shp","planning_neighborhoods.shp",214576],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.shp.xml","planning_neighborhoods.shp.xml",21958],["dbfs:/datasets/magellan/SFNbhd/planning_neighborhoods.shx","planning_neighborhoods.shx",396]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[]},"errorSummary":"Command skipped","error":null,"workflows":[],"startTime":1507782786338,"submitTime":1507782799392,"finishTime":1507782786762,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1a5022ce-0cd3-40d7-abe0-95fcec2f3407"},{"version":"CommandV1","origId":202702,"guid":"06c503f4-0216-471c-ba45-99e3542440e6","subtype":"command","commandType":"auto","position":19.0,"command":"%md \n### End of downloading and putting data in dbfs","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1454451997648,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":null,"showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b77726cf-0c52-4baa-93d2-0e7c560d75cd"}],"dashboards":[],"guid":"503af565-5573-42b7-b73c-d22f24cf3a3d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/metrics-graphics.js"
 onerror="window.mainJsLoadError = true;"></script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/358a53f93460d41f62b95cfd5ce6436b528c2b229982b8159a580fbbb91ef1fb/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
