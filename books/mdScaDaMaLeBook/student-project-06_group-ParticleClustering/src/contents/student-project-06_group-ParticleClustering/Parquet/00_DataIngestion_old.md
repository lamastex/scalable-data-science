<div class="cell markdown">

ScaDaMaLe Course [site](https://lamastex.github.io/scalable-data-science/sds/3/x/) and [book](https://lamastex.github.io/ScaDaMaLe/index.html)

</div>

<div class="cell code" execution_count="1" scrolled="true">

``` sh
wget https://zenodo.org/record/3602254/files/hls4ml_LHCjet_100p_train.tar.gz
```

<div class="output execute_result plain_result" execution_count="1">

    --2020-12-08 10:36:34--  https://zenodo.org/record/3602254/files/hls4ml_LHCjet_100p_train.tar.gz
    Resolving zenodo.org (zenodo.org)... 137.138.76.77
    Connecting to zenodo.org (zenodo.org)|137.138.76.77|:443... connected.
    HTTP request sent, awaiting response... 200 OK
    Length: 2764083152 (2.6G) [application/octet-stream]
    Saving to: ‘hls4ml_LHCjet_100p_train.tar.gz.1’

         0K .......... .......... .......... .......... ..........  0%  145K 5h9m
        50K .......... .......... .......... .......... ..........  0%  290K 3h52m
       100K .......... .......... .......... .......... ..........  0%  290K 3h26m
       150K .......... .......... .......... .......... ..........  0%  291K 3h13m
       200K .......... .......... .......... .......... ..........  0%  290K 3h5m
       250K .......... .......... .......... .......... ..........  0%  145K 3h26m
       300K .......... .......... .......... .......... ..........  0% 99.0M 2h57m
       350K .......... .......... .......... .......... ..........  0%  290K 2h54m
       400K .......... .......... .......... .......... ..........  0%  145K 3h9m
       450K .......... .......... .......... .......... ..........  0%  290K 3h6m
       500K .......... .......... .......... .......... ..........  0%  145K 3h17m
       550K .......... .......... .......... .......... ..........  0% 93.7M 3h0m
       600K .......... .......... .......... .......... ..........  0%  290K 2h58m
       650K .......... .......... .......... .......... ..........  0%  289K 2h57m
       700K .......... .......... .......... .......... ..........  0%  290K 2h55m
       750K .......... .......... .......... .......... ..........  0%  291K 2h54m
       800K .......... .......... .......... .......... ..........  0%  292K 2h53m
       850K .......... .......... .......... .......... ..........  0%  289K 2h52m
       900K .......... .......... .......... .......... ..........  0%  290K 2h51m
       950K .......... .......... .......... .......... ..........  0%  290K 2h50m
      1000K .......... .......... .......... .......... ..........  0%  146K 2h57m
      1050K .......... .......... .......... .......... ..........  0%  291K 2h56m
      1100K .......... .......... .......... .......... ..........  0% 29.3M 2h48m
      1150K .......... .......... .......... .......... ..........  0%  292K 2h47m
      1200K .......... .......... .......... .......... ..........  0%  290K 2h47m
      1250K .......... .......... .......... .......... ..........  0%  290K 2h46m
      1300K .......... .......... .......... .......... ..........  0%  290K 2h46m
      1350K .......... .......... .......... .......... ..........  0%  291K 2h46m
      1400K .......... .......... .......... .......... ..........  0%  290K 2h45m
      1450K .......... .......... .......... .......... ..........  0%  145K 2h50m
      1500K .......... .......... .......... .......... ..........  0%  290K 2h49m
      1550K .......... .......... .......... .......... ..........  0% 1.16M 2h45m
      1600K .......... .......... .......... .......... ..........  0%  166K 2h49m
      1650K .......... .......... .......... .......... ..........  0% 1.15M 2h45m
      1700K .......... .......... .......... .......... ..........  0% 98.8M 2h40m
      1750K .......... .......... .......... .......... ..........  0%  387K 2h39m
      1800K .......... .......... .......... .......... ..........  0% 1.15M 2h35m
      1850K .......... .......... .......... .......... ..........  0%  125M 2h31m
      1900K .......... .......... .......... .......... ..........  0%  103M 2h27m
      1950K .......... .......... .......... .......... ..........  0%  106M 2h24m
      2000K .......... .......... .......... .......... ..........  0%  389K 2h23m
      2050K .......... .......... .......... .......... ..........  0%  209M 2h20m
      2100K .......... .......... .......... .......... ..........  0% 1.16M 2h17m
      2150K .......... .......... .......... .......... ..........  0%  122M 2h14m
      2200K .......... .......... .......... .......... ..........  0%  157M 2h11m
      2250K .......... .......... .......... .......... ..........  0%  180M 2h8m
      2300K .......... .......... .......... .......... ..........  0%  163M 2h6m
      2350K .......... .......... .......... .......... ..........  0%  140M 2h3m
      2400K .......... .......... .......... .......... ..........  0%  140M 2h0m
      2450K .......... .......... .......... .......... ..........  0%  124M 1h58m
      2500K .......... .......... .......... .......... ..........  0%  391K 1h58m
      2550K .......... .......... .......... .......... ..........  0%  158M 1h56m
      2600K .......... .......... .......... .......... ..........  0%  147M 1h53m
      2650K .......... .......... .......... .......... ..........  0%  138M 1h51m
      2700K .......... .......... .......... .......... ..........  0%  126M 1h49m
      2750K .......... .......... .......... .......... ..........  0% 1.19M 1h48m
      2800K .......... .......... .......... .......... ..........  0%  138M 1h46m
      2850K .......... .......... .......... .......... ..........  0%  162M 1h44m
      2900K .......... .......... .......... .......... ..........  0%  149M 1h43m
      2950K .......... .......... .......... .......... ..........  0%  176M 1h41m
      3000K .......... .......... .......... .......... ..........  0%  139M 99m39s
      3050K .......... .......... .......... .......... ..........  0%  187M 98m3s
      3100K .......... .......... .......... .......... ..........  0%  117M 96m30s
      3150K .......... .......... .......... .......... ..........  0%  160M 94m59s
      3200K .......... .......... .......... .......... ..........  0%  114M 93m32s
      3250K .......... .......... .......... .......... ..........  0%  134M 92m7s
      3300K .......... .......... .......... .......... ..........  0%  129M 90m45s
      3350K .......... .......... .......... .......... ..........  0%  140M 89m25s
      3400K .......... .......... .......... .......... ..........  0%  152M 88m7s
      3450K .......... .......... .......... .......... ..........  0%  124M 86m52s
      3500K .......... .......... .......... .......... ..........  0%  400K 87m13s
      3550K .......... .......... .......... .......... ..........  0% 95.1M 86m1s
      3600K .......... .......... .......... .......... ..........  0%  122M 84m50s
      3650K .......... .......... .......... .......... ..........  0%  110M 83m42s
      3700K .......... .......... .......... .......... ..........  0%  125M 82m35s
      3750K .......... .......... .......... .......... ..........  0%  141M 81m30s
      3800K .......... .......... .......... .......... ..........  0%  152M 80m27s
      3850K .......... .......... .......... .......... ..........  0%  166M 79m25s
      3900K .......... .......... .......... .......... ..........  0%  141M 78m25s
      3950K .......... .......... .......... .......... ..........  0%  182M 77m26s
      4000K .......... .......... .......... .......... ..........  0% 1.24M 76m55s
      4050K .......... .......... .......... .......... ..........  0%  114M 75m59s
      4100K .......... .......... .......... .......... ..........  0%  105M 75m4s
      4150K .......... .......... .......... .......... ..........  0%  141M 74m10s
      4200K .......... .......... .......... .......... ..........  0%  127M 73m18s
      4250K .......... .......... .......... .......... ..........  0%  128M 72m27s
      4300K .......... .......... .......... .......... ..........  0%  138M 71m37s
      4350K .......... .......... .......... .......... ..........  0%  157M 70m49s
      4400K .......... .......... .......... .......... ..........  0%  131M 70m1s
      4450K .......... .......... .......... .......... ..........  0%  136M 69m15s
      4500K .......... .......... .......... .......... ..........  0%  133M 68m29s
      4550K .......... .......... .......... .......... ..........  0%  166M 67m44s
      4600K .......... .......... .......... .......... ..........  0%  133M 67m1s
      4650K .......... .......... .......... .......... ..........  0%  154M 66m18s
      4700K .......... .......... .......... .......... ..........  0%  137M 65m37s
      4750K .......... .......... .......... .......... ..........  0%  147M 64m56s
      4800K .......... .......... .......... .......... ..........  0%  118M 64m16s
      4850K .......... .......... .......... .......... ..........  0%  147M 63m36s
      4900K .......... .......... .......... .......... ..........  0%  163M 62m58s
      4950K .......... .......... .......... .......... ..........  0%  117M 62m20s
      5000K .......... .......... .......... .......... ..........  0%  144M 61m43s
      5050K .......... .......... .......... .......... ..........  0%  408K 62m12s
      5100K .......... .......... .......... .......... ..........  0%  141M 61m36s
      5150K .......... .......... .......... .......... ..........  0%  152M 61m0s
      5200K .......... .......... .......... .......... ..........  0%  159M 60m25s
      5250K .......... .......... .......... .......... ..........  0%  132M 59m51s
      5300K .......... .......... .......... .......... ..........  0%  169M 59m18s
      5350K .......... .......... .......... .......... ..........  0%  138M 58m45s
      5400K .......... .......... .......... .......... ..........  0%  141M 58m13s
      5450K .......... .......... .......... .......... ..........  0%  152M 57m41s
      5500K .......... .......... .......... .......... ..........  0%  151M 57m10s
      5550K .......... .......... .......... .......... ..........  0% 1.24M 56m58s
      5600K .......... .......... .......... .......... ..........  0%  186M 56m28s
      5650K .......... .......... .......... .......... ..........  0%  149M 55m58s
      5700K .......... .......... .......... .......... ..........  0% 88.6M 55m29s
      5750K .......... .......... .......... .......... ..........  0%  154M 55m1s
      5800K .......... .......... .......... .......... ..........  0%  172M 54m33s
      5850K .......... .......... .......... .......... ..........  0%  175M 54m5s
      5900K .......... .......... .......... .......... ..........  0%  155M 53m38s
      5950K .......... .......... .......... .......... ..........  0%  192M 53m11s
      6000K .......... .......... .......... .......... ..........  0%  172M 52m45s
      6050K .......... .......... .......... .......... ..........  0%  188M 52m19s
      6100K .......... .......... .......... .......... ..........  0%  145M 51m53s
      6150K .......... .......... .......... .......... ..........  0%  168M 51m28s
      6200K .......... .......... .......... .......... ..........  0%  142M 51m4s
      6250K .......... .......... .......... .......... ..........  0%  129M 50m40s
      6300K .......... .......... .......... .......... ..........  0%  159M 50m16s
      6350K .......... .......... .......... .......... ..........  0%  141M 49m52s
      6400K .......... .......... .......... .......... ..........  0%  111M 49m29s
      6450K .......... .......... .......... .......... ..........  0%  123M 49m6s
      6500K .......... .......... .......... .......... ..........  0%  119M 48m44s
      6550K .......... .......... .......... .......... ..........  0%  135M 48m22s
      6600K .......... .......... .......... .......... ..........  0%  406K 48m50s
      6650K .......... .......... .......... .......... ..........  0%  127M 48m28s
      6700K .......... .......... .......... .......... ..........  0%  131M 48m7s
      6750K .......... .......... .......... .......... ..........  0%  144M 47m46s
      6800K .......... .......... .......... .......... ..........  0%  147M 47m25s
      6850K .......... .......... .......... .......... ..........  0%  140M 47m4s
      6900K .......... .......... .......... .......... ..........  0%  128M 46m44s
      6950K .......... .......... .......... .......... ..........  0%  171M 46m24s
      7000K .......... .......... .......... .......... ..........  0%  142M 46m4s
      7050K .......... .......... .......... .......... ..........  0% 30.8M 45m46s
      7100K .......... .......... .......... .......... ..........  0% 1.28M 45m41s
      7150K .......... .......... .......... .......... ..........  0%  105M 45m22s
      7200K .......... .......... .......... .......... ..........  0% 93.7M 45m3s
      7250K .......... .......... .......... .......... ..........  0%  112M 44m45s
      7300K .......... .......... .......... .......... ..........  0% 95.0M 44m27s
      7350K .......... .......... .......... .......... ..........  0%  102M 44m9s
      7400K .......... .......... .......... .......... ..........  0%  124M 43m51s
      7450K .......... .......... .......... .......... ..........  0%  129M 43m34s
      7500K .......... .......... .......... .......... ..........  0%  116M 43m16s
      7550K .......... .......... .......... .......... ..........  0%  191M 42m59s
      7600K .......... .......... .......... .......... ..........  0%  205M 42m42s
      7650K .......... .......... .......... .......... ..........  0%  239M 42m26s
      7700K .......... .......... .......... .......... ..........  0%  141M 42m9s
      7750K .......... .......... .......... .......... ..........  0%  205M 41m53s
      7800K .......... .......... .......... .......... ..........  0%  221M 41m37s
      7850K .......... .......... .......... .......... ..........  0%  150M 41m22s
      7900K .......... .......... .......... .......... ..........  0%  169M 41m6s
      7950K .......... .......... .......... .......... ..........  0%  249M 40m51s
      8000K .......... .......... .......... .......... ..........  0%  192M 40m35s
      8050K .......... .......... .......... .......... ..........  0%  234M 40m20s
      8100K .......... .......... .......... .......... ..........  0%  230M 40m6s
      8150K .......... .......... .......... .......... ..........  0%  405K 40m31s
      8200K .......... .......... .......... .......... ..........  0%  123M 40m17s
      8250K .......... .......... .......... .......... ..........  0%  114M 40m2s
      8300K .......... .......... .......... .......... ..........  0% 88.5M 39m48s
      8350K .......... .......... .......... .......... ..........  0%  111M 39m34s
      8400K .......... .......... .......... .......... ..........  0%  105M 39m20s
      8450K .......... .......... .......... .......... ..........  0%  132M 39m6s
      8500K .......... .......... .......... .......... ..........  0%  152M 38m53s
      8550K .......... .......... .......... .......... ..........  0%  119M 38m39s
      8600K .......... .......... .......... .......... ..........  0% 1.28M 38m38s
      8650K .......... .......... .......... .......... ..........  0% 68.6M 38m24s
      8700K .......... .......... .......... .......... ..........  0%  118M 38m11s
      8750K .......... .......... .......... .......... ..........  0%  107M 37m58s
      8800K .......... .......... .......... .......... ..........  0%  123M 37m46s
      8850K .......... .......... .......... .......... ..........  0%  122M 37m33s
      8900K .......... .......... .......... .......... ..........  0%  112M 37m20s
      8950K .......... .......... .......... .......... ..........  0%  117M 37m8s
      9000K .......... .......... .......... .......... ..........  0%  120M 36m56s
      9050K .......... .......... .......... .......... ..........  0%  126M 36m44s
      9100K .......... .......... .......... .......... ..........  0%  109M 36m32s
      9150K .......... .......... .......... .......... ..........  0%  112M 36m20s
      9200K .......... .......... .......... .......... ..........  0%  119M 36m8s
      9250K .......... .......... .......... .......... ..........  0%  112M 35m57s
      9300K .......... .......... .......... .......... ..........  0%  122M 35m45s
      9350K .......... .......... .......... .......... ..........  0%  122M 35m34s
      9400K .......... .......... .......... .......... ..........  0%  117M 35m23s
      9450K .......... .......... .......... .......... ..........  0%  139M 35m12s
      9500K .......... .......... .......... .......... ..........  0%  127M 35m1s
      9550K .......... .......... .......... .......... ..........  0%  121M 34m50s
      9600K .......... .......... .......... .......... ..........  0%  123M 34m39s
      9650K .......... .......... .......... .......... ..........  0%  410K 35m2s
      9700K .......... .......... .......... .......... ..........  0% 80.5M 34m51s
      9750K .......... .......... .......... .......... ..........  0% 3.51M 34m44s
      9800K .......... .......... .......... .......... ..........  0%  100M 34m34s
      9850K .......... .......... .......... .......... ..........  0% 90.7M 34m24s
      9900K .......... .......... .......... .......... ..........  0%  130M 34m13s
      9950K .......... .......... .......... .......... ..........  0%  163M 34m3s
     10000K .......... .......... .......... .......... ..........  0%  158M 33m53s
     10050K .......... .......... .......... .......... ..........  0%  108M 33m43s
     10100K .......... .......... .......... .......... ..........  0%  152M 33m33s
     10150K .......... .......... .......... .......... ..........  0% 1.92M 33m30s
     10200K .......... .......... .......... .......... ..........  0%  111M 33m20s
     10250K .......... .......... .......... .......... ..........  0%  140M 33m10s
     10300K .......... .......... .......... .......... ..........  0%  134M 33m1s
     10350K .......... .......... .......... .......... ..........  0%  149M 32m51s
     10400K .......... .......... .......... .......... ..........  0%  200M 32m42s
     10450K .......... .......... .......... .......... ..........  0%  162M 32m33s
     10500K .......... .......... .......... .......... ..........  0%  150M 32m24s
     10550K .......... .......... .......... .......... ..........  0%  112M 32m14s
     10600K .......... .......... .......... .......... ..........  0% 92.1M 32m5s
     10650K .......... .......... .......... .......... ..........  0%  124M 31m57s
     10700K .......... .......... .......... .......... ..........  0%  109M 31m48s
     10750K .......... .......... .......... .......... ..........  0%  126M 31m39s
     10800K .......... .......... .......... .......... ..........  0%  114M 31m30s
     10850K .......... .......... .......... .......... ..........  0%  142M 31m22s
     10900K .......... .......... .......... .......... ..........  0%  134M 31m13s
     10950K .......... .......... .......... .......... ..........  0%  175M 31m5s
     11000K .......... .......... .......... .......... ..........  0%  130M 30m56s
     11050K .......... .......... .......... .......... ..........  0%  166M 30m48s
     11100K .......... .......... .......... .......... ..........  0%  129M 30m40s
     11150K .......... .......... .......... .......... ..........  0%  146M 30m31s
     11200K .......... .......... .......... .......... ..........  0%  394K 30m54s
     11250K .......... .......... .......... .......... ..........  0%  123M 30m45s
     11300K .......... .......... .......... .......... ..........  0% 5.07M 30m40s
     11350K .......... .......... .......... .......... ..........  0%  140M 30m32s
     11400K .......... .......... .......... .......... ..........  0%  180M 30m24s
     11450K .......... .......... .......... .......... ..........  0%  142M 30m16s
     11500K .......... .......... .......... .......... ..........  0%  133M 30m8s
     11550K .......... .......... .......... .......... ..........  0%  160M 30m0s
     11600K .......... .......... .......... .......... ..........  0%  148M 29m52s
     11650K .......... .......... .......... .......... ..........  0% 77.7M 29m45s
     11700K .......... .......... .......... .......... ..........  0% 1.92M 29m43s
     11750K .......... .......... .......... .......... ..........  0%  200M 29m36s
     11800K .......... .......... .......... .......... ..........  0%  145M 29m28s
     11850K .......... .......... .......... .......... ..........  0%  145M 29m21s
     11900K .......... .......... .......... .......... ..........  0% 77.8M 29m13s
     11950K .......... .......... .......... .......... ..........  0%  111M 29m6s
     12000K .......... .......... .......... .......... ..........  0%  113M 28m59s
     12050K .......... .......... .......... .......... ..........  0%  146M 28m52s
     12100K .......... .......... .......... .......... ..........  0%  158M 28m45s
     12150K .......... .......... .......... .......... ..........  0%  160M 28m38s
     12200K .......... .......... .......... .......... ..........  0%  165M 28m31s
     12250K .......... .......... .......... .......... ..........  0%  162M 28m24s
     12300K .......... .......... .......... .......... ..........  0%  143M 28m17s
     12350K .......... .......... .......... .......... ..........  0%  181M 28m10s
     12400K .......... .......... .......... .......... ..........  0%  129M 28m3s
     12450K .......... .......... .......... .......... ..........  0%  119M 27m57s
     12500K .......... .......... .......... .......... ..........  0%  108M 27m50s
     12550K .......... .......... .......... .......... ..........  0%  135M 27m44s
     12600K .......... .......... .......... .......... ..........  0%  119M 27m37s
     12650K .......... .......... .......... .......... ..........  0%  142M 27m31s
     12700K .......... .......... .......... .......... ..........  0%  394K 27m51s
     12750K .......... .......... .......... .......... ..........  0% 92.2M 27m44s
     12800K .......... .......... .......... .......... ..........  0% 5.06M 27m40s
     12850K .......... .......... .......... .......... ..........  0%  120M 27m34s
     12900K .......... .......... .......... .......... ..........  0%  112M 27m27s
     12950K .......... .......... .......... .......... ..........  0%  118M 27m21s
     13000K .......... .......... .......... .......... ..........  0%  102M 27m15s
     13050K .......... .......... .......... .......... ..........  0%  108M 27m9s
     13100K .......... .......... .......... .......... ..........  0% 97.9M 27m2s
     13150K .......... .......... .......... .......... ..........  0%  134M 26m56s
     13200K .......... .......... .......... .......... ..........  0% 48.4M 26m50s
     13250K .......... .......... .......... .......... ..........  0% 2.00M 26m49s
     13300K .......... .......... .......... .......... ..........  0%  113M 26m43s
     13350K .......... .......... .......... .......... ..........  0%  114M 26m37s
     13400K .......... .......... .......... .......... ..........  0% 98.2M 26m31s
     13450K .......... .......... .......... .......... ..........  0%  134M 26m26s
     13500K .......... .......... .......... .......... ..........  0%  114M 26m20s
     13550K .......... .......... .......... .......... ..........  0%  140M 26m14s
     13600K .......... .......... .......... .......... ..........  0%  110M 26m8s
     13650K .......... .......... .......... .......... ..........  0%  100M 26m3s
     13700K .......... .......... .......... .......... ..........  0% 93.9M 25m57s
     13750K .......... .......... .......... .......... ..........  0%  169M 25m51s
     13800K .......... .......... .......... .......... ..........  0%  201M 25m46s
     13850K .......... .......... .......... .......... ..........  0%  251M 25m40s
     13900K .......... .......... .......... .......... ..........  0%  199M 25m35s
     13950K .......... .......... .......... .......... ..........  0%  222M 25m29s
     14000K .......... .......... .......... .......... ..........  0%  177M 25m24s
     14050K .......... .......... .......... .......... ..........  0%  231M 25m19s
     14100K .......... .......... .......... .......... ..........  0%  213M 25m13s
     14150K .......... .......... .......... .......... ..........  0%  257M 25m8s
     14200K .......... .......... .......... .......... ..........  0% 1.27M 25m10s
     14250K .......... .......... .......... .......... ..........  0%  560K 25m21s
     14300K .......... .......... .......... .......... ..........  0% 99.4M 25m16s
     14350K .......... .......... .......... .......... ..........  0% 5.17M 25m13s
     14400K .......... .......... .......... .......... ..........  0% 96.6M 25m7s
     14450K .......... .......... .......... .......... ..........  0%  121M 25m2s
     14500K .......... .......... .......... .......... ..........  0% 99.3M 24m57s
     14550K .......... .......... .......... .......... ..........  0%  124M 24m52s
     14600K .......... .......... .......... .......... ..........  0%  112M 24m47s
     14650K .......... .......... .......... .......... ..........  0%  124M 24m42s
     14700K .......... .......... .......... .......... ..........  0%  114M 24m37s
     14750K .......... .......... .......... .......... ..........  0% 19.7M 24m32s
     14800K .......... .......... .......... .......... ..........  0% 2.14M 24m32s
     14850K .......... .......... .......... .......... ..........  0%  117M 24m27s
     14900K .......... .......... .......... .......... ..........  0%  109M 24m22s
     14950K .......... .......... .......... .......... ..........  0%  130M 24m17s
     15000K .......... .......... .......... .......... ..........  0%  145M 24m12s
     15050K .......... .......... .......... .......... ..........  0%  161M 24m7s
     15100K .......... .......... .......... .......... ..........  0%  116M 24m3s
     15150K .......... .......... .......... .......... ..........  0%  134M 23m58s
     15200K .......... .......... .......... .......... ..........  0%  136M 23m53s
     15250K .......... .......... .......... .......... ..........  0%  170M 23m49s
     15300K .......... .......... .......... .......... ..........  0%  130M 23m44s
     15350K .......... .......... .......... .......... ..........  0%  190M 23m39s
     15400K .......... .......... .......... .......... ..........  0%  141M 23m35s
     15450K .......... .......... .......... .......... ..........  0%  147M 23m30s

    *** WARNING: skipped 4220606 bytes of output ***

    2683150K .......... .......... .......... .......... .......... 99% 86.9M 3s
    2683200K .......... .......... .......... .......... .......... 99% 63.2M 3s
    2683250K .......... .......... .......... .......... .......... 99%  115M 3s
    2683300K .......... .......... .......... .......... .......... 99% 91.6M 3s
    2683350K .......... .......... .......... .......... .......... 99%  134M 3s
    2683400K .......... .......... .......... .......... .......... 99% 98.1M 3s
    2683450K .......... .......... .......... .......... .......... 99%  154M 3s
    2683500K .......... .......... .......... .......... .......... 99%  136M 3s
    2683550K .......... .......... .......... .......... .......... 99%  165M 3s
    2683600K .......... .......... .......... .......... .......... 99%  142M 3s
    2683650K .......... .......... .......... .......... .......... 99%  192M 3s
    2683700K .......... .......... .......... .......... .......... 99%  139M 3s
    2683750K .......... .......... .......... .......... .......... 99%  105M 3s
    2683800K .......... .......... .......... .......... .......... 99%  156M 3s
    2683850K .......... .......... .......... .......... .......... 99%  141M 3s
    2683900K .......... .......... .......... .......... .......... 99% 35.3M 3s
    2683950K .......... .......... .......... .......... .......... 99%  155M 3s
    2684000K .......... .......... .......... .......... .......... 99% 94.8M 3s
    2684050K .......... .......... .......... .......... .......... 99% 8.06M 3s
    2684100K .......... .......... .......... .......... .......... 99%  668K 3s
    2684150K .......... .......... .......... .......... .......... 99%  604K 3s
    2684200K .......... .......... .......... .......... .......... 99% 71.0M 3s
    2684250K .......... .......... .......... .......... .......... 99% 68.6M 3s
    2684300K .......... .......... .......... .......... .......... 99% 93.8M 3s
    2684350K .......... .......... .......... .......... .......... 99% 93.1M 3s
    2684400K .......... .......... .......... .......... .......... 99%  120M 3s
    2684450K .......... .......... .......... .......... .......... 99%  140M 3s
    2684500K .......... .......... .......... .......... .......... 99% 99.8M 2s
    2684550K .......... .......... .......... .......... .......... 99%  142M 2s
    2684600K .......... .......... .......... .......... .......... 99%  137M 2s
    2684650K .......... .......... .......... .......... .......... 99%  116M 2s
    2684700K .......... .......... .......... .......... .......... 99%  134M 2s
    2684750K .......... .......... .......... .......... .......... 99%  156M 2s
    2684800K .......... .......... .......... .......... .......... 99%  107M 2s
    2684850K .......... .......... .......... .......... .......... 99%  133M 2s
    2684900K .......... .......... .......... .......... .......... 99%  113M 2s
    2684950K .......... .......... .......... .......... .......... 99% 72.3M 2s
    2685000K .......... .......... .......... .......... .......... 99% 99.1M 2s
    2685050K .......... .......... .......... .......... .......... 99% 52.3M 2s
    2685100K .......... .......... .......... .......... .......... 99% 20.9M 2s
    2685150K .......... .......... .......... .......... .......... 99%  639K 2s
    2685200K .......... .......... .......... .......... .......... 99%  604K 2s
    2685250K .......... .......... .......... .......... .......... 99% 93.6M 2s
    2685300K .......... .......... .......... .......... .......... 99% 55.8M 2s
    2685350K .......... .......... .......... .......... .......... 99% 99.7M 2s
    2685400K .......... .......... .......... .......... .......... 99% 73.7M 2s
    2685450K .......... .......... .......... .......... .......... 99%  112M 2s
    2685500K .......... .......... .......... .......... .......... 99%  120M 2s
    2685550K .......... .......... .......... .......... .......... 99%  136M 2s
    2685600K .......... .......... .......... .......... .......... 99%  122M 2s
    2685650K .......... .......... .......... .......... .......... 99%  121M 2s
    2685700K .......... .......... .......... .......... .......... 99%  103M 2s
    2685750K .......... .......... .......... .......... .......... 99%  102M 2s
    2685800K .......... .......... .......... .......... .......... 99% 95.0M 2s
    2685850K .......... .......... .......... .......... .......... 99%  127M 2s
    2685900K .......... .......... .......... .......... .......... 99%  110M 2s
    2685950K .......... .......... .......... .......... .......... 99%  130M 2s
    2686000K .......... .......... .......... .......... .......... 99%  109M 2s
    2686050K .......... .......... .......... .......... .......... 99% 79.0M 2s
    2686100K .......... .......... .......... .......... .......... 99% 83.1M 2s
    2686150K .......... .......... .......... .......... .......... 99% 87.6M 2s
    2686200K .......... .......... .......... .......... .......... 99% 8.94M 2s
    2686250K .......... .......... .......... .......... .......... 99%  319K 2s
    2686300K .......... .......... .......... .......... .......... 99% 62.2M 2s
    2686350K .......... .......... .......... .......... .......... 99% 71.4M 2s
    2686400K .......... .......... .......... .......... .......... 99% 73.4M 2s
    2686450K .......... .......... .......... .......... .......... 99%  115M 2s
    2686500K .......... .......... .......... .......... .......... 99% 91.1M 2s
    2686550K .......... .......... .......... .......... .......... 99%  132M 2s
    2686600K .......... .......... .......... .......... .......... 99% 71.1M 2s
    2686650K .......... .......... .......... .......... .......... 99%  132M 2s
    2686700K .......... .......... .......... .......... .......... 99%  125M 2s
    2686750K .......... .......... .......... .......... .......... 99%  220M 2s
    2686800K .......... .......... .......... .......... .......... 99%  150M 2s
    2686850K .......... .......... .......... .......... .......... 99%  211M 2s
    2686900K .......... .......... .......... .......... .......... 99%  169M 2s
    2686950K .......... .......... .......... .......... .......... 99% 76.4M 2s
    2687000K .......... .......... .......... .......... .......... 99% 71.1M 2s
    2687050K .......... .......... .......... .......... .......... 99%  136M 2s
    2687100K .......... .......... .......... .......... .......... 99% 68.2M 2s
    2687150K .......... .......... .......... .......... .......... 99% 83.9M 2s
    2687200K .......... .......... .......... .......... .......... 99%  116M 2s
    2687250K .......... .......... .......... .......... .......... 99% 61.4M 2s
    2687300K .......... .......... .......... .......... .......... 99% 8.89M 2s
    2687350K .......... .......... .......... .......... .......... 99%  318K 2s
    2687400K .......... .......... .......... .......... .......... 99%  108M 2s
    2687450K .......... .......... .......... .......... .......... 99%  138M 2s
    2687500K .......... .......... .......... .......... .......... 99% 88.1M 2s
    2687550K .......... .......... .......... .......... .......... 99% 74.3M 2s
    2687600K .......... .......... .......... .......... .......... 99%  131M 2s
    2687650K .......... .......... .......... .......... .......... 99%  172M 2s
    2687700K .......... .......... .......... .......... .......... 99% 74.1M 2s
    2687750K .......... .......... .......... .......... .......... 99%  122M 2s
    2687800K .......... .......... .......... .......... .......... 99%  106M 2s
    2687850K .......... .......... .......... .......... .......... 99% 95.8M 2s
    2687900K .......... .......... .......... .......... .......... 99%  105M 2s
    2687950K .......... .......... .......... .......... .......... 99%  119M 2s
    2688000K .......... .......... .......... .......... .......... 99%  108M 2s
    2688050K .......... .......... .......... .......... .......... 99%  115M 2s
    2688100K .......... .......... .......... .......... .......... 99%  111M 2s
    2688150K .......... .......... .......... .......... .......... 99%  115M 2s
    2688200K .......... .......... .......... .......... .......... 99% 89.3M 2s
    2688250K .......... .......... .......... .......... .......... 99%  135M 2s
    2688300K .......... .......... .......... .......... .......... 99%  147M 2s
    2688350K .......... .......... .......... .......... .......... 99% 72.3M 2s
    2688400K .......... .......... .......... .......... .......... 99% 8.42M 2s
    2688450K .......... .......... .......... .......... .......... 99%  318K 2s
    2688500K .......... .......... .......... .......... .......... 99% 95.5M 2s
    2688550K .......... .......... .......... .......... .......... 99%  125M 2s
    2688600K .......... .......... .......... .......... .......... 99% 94.3M 2s
    2688650K .......... .......... .......... .......... .......... 99% 32.6M 2s
    2688700K .......... .......... .......... .......... .......... 99% 49.9M 2s
    2688750K .......... .......... .......... .......... .......... 99%  112M 2s
    2688800K .......... .......... .......... .......... .......... 99% 40.2M 2s
    2688850K .......... .......... .......... .......... .......... 99% 49.2M 2s
    2688900K .......... .......... .......... .......... .......... 99% 90.8M 2s
    2688950K .......... .......... .......... .......... .......... 99% 45.2M 2s
    2689000K .......... .......... .......... .......... .......... 99% 52.2M 2s
    2689050K .......... .......... .......... .......... .......... 99%  101M 2s
    2689100K .......... .......... .......... .......... .......... 99%  104M 2s
    2689150K .......... .......... .......... .......... .......... 99%  124M 2s
    2689200K .......... .......... .......... .......... .......... 99% 93.3M 2s
    2689250K .......... .......... .......... .......... .......... 99% 92.3M 2s
    2689300K .......... .......... .......... .......... .......... 99%  119M 2s
    2689350K .......... .......... .......... .......... .......... 99%  136M 2s
    2689400K .......... .......... .......... .......... .......... 99%  114M 2s
    2689450K .......... .......... .......... .......... .......... 99%  111M 2s
    2689500K .......... .......... .......... .......... .......... 99% 21.7M 2s
    2689550K .......... .......... .......... .......... .......... 99%  319K 2s
    2689600K .......... .......... .......... .......... .......... 99% 41.5M 2s
    2689650K .......... .......... .......... .......... .......... 99%  146M 2s
    2689700K .......... .......... .......... .......... .......... 99% 55.3M 2s
    2689750K .......... .......... .......... .......... .......... 99% 31.0M 2s
    2689800K .......... .......... .......... .......... .......... 99% 47.4M 2s
    2689850K .......... .......... .......... .......... .......... 99% 40.6M 2s
    2689900K .......... .......... .......... .......... .......... 99% 45.1M 2s
    2689950K .......... .......... .......... .......... .......... 99% 68.5M 2s
    2690000K .......... .......... .......... .......... .......... 99% 36.5M 2s
    2690050K .......... .......... .......... .......... .......... 99% 87.4M 2s
    2690100K .......... .......... .......... .......... .......... 99%  139M 2s
    2690150K .......... .......... .......... .......... .......... 99%  243M 2s
    2690200K .......... .......... .......... .......... .......... 99%  195M 2s
    2690250K .......... .......... .......... .......... .......... 99%  148M 2s
    2690300K .......... .......... .......... .......... .......... 99%  131M 2s
    2690350K .......... .......... .......... .......... .......... 99%  209M 2s
    2690400K .......... .......... .......... .......... .......... 99%  201M 1s
    2690450K .......... .......... .......... .......... .......... 99%  217M 1s
    2690500K .......... .......... .......... .......... .......... 99%  161M 1s
    2690550K .......... .......... .......... .......... .......... 99%  250M 1s
    2690600K .......... .......... .......... .......... .......... 99%  125M 1s
    2690650K .......... .......... .......... .......... .......... 99% 1.04M 1s
    2690700K .......... .......... .......... .......... .......... 99%  444K 1s
    2690750K .......... .......... .......... .......... .......... 99% 48.3M 1s
    2690800K .......... .......... .......... .......... .......... 99% 63.1M 1s
    2690850K .......... .......... .......... .......... .......... 99% 36.3M 1s
    2690900K .......... .......... .......... .......... .......... 99% 33.5M 1s
    2690950K .......... .......... .......... .......... .......... 99% 33.4M 1s
    2691000K .......... .......... .......... .......... .......... 99% 66.5M 1s
    2691050K .......... .......... .......... .......... .......... 99% 93.9M 1s
    2691100K .......... .......... .......... .......... .......... 99% 40.9M 1s
    2691150K .......... .......... .......... .......... .......... 99% 77.0M 1s
    2691200K .......... .......... .......... .......... .......... 99% 95.8M 1s
    2691250K .......... .......... .......... .......... .......... 99%  119M 1s
    2691300K .......... .......... .......... .......... .......... 99%  141M 1s
    2691350K .......... .......... .......... .......... .......... 99% 74.5M 1s
    2691400K .......... .......... .......... .......... .......... 99%  111M 1s
    2691450K .......... .......... .......... .......... .......... 99%  143M 1s
    2691500K .......... .......... .......... .......... .......... 99%  150M 1s
    2691550K .......... .......... .......... .......... .......... 99%  145M 1s
    2691600K .......... .......... .......... .......... .......... 99%  141M 1s
    2691650K .......... .......... .......... .......... .......... 99%  132M 1s
    2691700K .......... .......... .......... .......... .......... 99%  114M 1s
    2691750K .......... .......... .......... .......... .......... 99%  128M 1s
    2691800K .......... .......... .......... .......... .......... 99%  999K 1s
    2691850K .......... .......... .......... .......... .......... 99%  455K 1s
    2691900K .......... .......... .......... .......... .......... 99% 53.3M 1s
    2691950K .......... .......... .......... .......... .......... 99% 34.5M 1s
    2692000K .......... .......... .......... .......... .......... 99%  123M 1s
    2692050K .......... .......... .......... .......... .......... 99% 93.6M 1s
    2692100K .......... .......... .......... .......... .......... 99% 52.8M 1s
    2692150K .......... .......... .......... .......... .......... 99% 40.8M 1s
    2692200K .......... .......... .......... .......... .......... 99% 89.5M 1s
    2692250K .......... .......... .......... .......... .......... 99% 40.6M 1s
    2692300K .......... .......... .......... .......... .......... 99%  105M 1s
    2692350K .......... .......... .......... .......... .......... 99%  141M 1s
    2692400K .......... .......... .......... .......... .......... 99%  153M 1s
    2692450K .......... .......... .......... .......... .......... 99%  238M 1s
    2692500K .......... .......... .......... .......... .......... 99% 87.1M 1s
    2692550K .......... .......... .......... .......... .......... 99%  116M 1s
    2692600K .......... .......... .......... .......... .......... 99%  150M 1s
    2692650K .......... .......... .......... .......... .......... 99%  103M 1s
    2692700K .......... .......... .......... .......... .......... 99%  127M 1s
    2692750K .......... .......... .......... .......... .......... 99%  151M 1s
    2692800K .......... .......... .......... .......... .......... 99%  125M 1s
    2692850K .......... .......... .......... .......... .......... 99%  110M 1s
    2692900K .......... .......... .......... .......... .......... 99%  134M 1s
    2692950K .......... .......... .......... .......... .......... 99% 1000K 1s
    2693000K .......... .......... .......... .......... .......... 99%  456K 1s
    2693050K .......... .......... .......... .......... .......... 99% 90.5M 1s
    2693100K .......... .......... .......... .......... .......... 99% 87.0M 1s
    2693150K .......... .......... .......... .......... .......... 99%  112M 1s
    2693200K .......... .......... .......... .......... .......... 99%  102M 1s
    2693250K .......... .......... .......... .......... .......... 99%  112M 1s
    2693300K .......... .......... .......... .......... .......... 99%  112M 1s
    2693350K .......... .......... .......... .......... .......... 99%  133M 1s
    2693400K .......... .......... .......... .......... .......... 99%  108M 1s
    2693450K .......... .......... .......... .......... .......... 99%  226M 1s
    2693500K .......... .......... .......... .......... .......... 99%  153M 1s
    2693550K .......... .......... .......... .......... .......... 99%  114M 1s
    2693600K .......... .......... .......... .......... .......... 99%  130M 1s
    2693650K .......... .......... .......... .......... .......... 99% 98.4M 1s
    2693700K .......... .......... .......... .......... .......... 99% 97.8M 1s
    2693750K .......... .......... .......... .......... .......... 99%  130M 1s
    2693800K .......... .......... .......... .......... .......... 99%  147M 1s
    2693850K .......... .......... .......... .......... .......... 99%  108M 1s
    2693900K .......... .......... .......... .......... .......... 99% 99.2M 1s
    2693950K .......... .......... .......... .......... .......... 99%  171M 1s
    2694000K .......... .......... .......... .......... .......... 99%  163M 1s
    2694050K .......... .......... .......... .......... .......... 99%  196M 1s
    2694100K .......... .......... .......... .......... .......... 99% 19.2M 1s
    2694150K .......... .......... .......... .......... .......... 99%  311K 1s
    2694200K .......... .......... .......... .......... .......... 99% 76.2M 1s
    2694250K .......... .......... .......... .......... .......... 99%  113M 1s
    2694300K .......... .......... .......... .......... .......... 99%  104M 1s
    2694350K .......... .......... .......... .......... .......... 99%  125M 1s
    2694400K .......... .......... .......... .......... .......... 99%  123M 1s
    2694450K .......... .......... .......... .......... .......... 99% 99.8M 1s
    2694500K .......... .......... .......... .......... .......... 99%  125M 1s
    2694550K .......... .......... .......... .......... .......... 99%  112M 1s
    2694600K .......... .......... .......... .......... .......... 99%  120M 1s
    2694650K .......... .......... .......... .......... .......... 99%  126M 1s
    2694700K .......... .......... .......... .......... .......... 99%  110M 1s
    2694750K .......... .......... .......... .......... .......... 99%  126M 1s
    2694800K .......... .......... .......... .......... .......... 99% 97.0M 1s
    2694850K .......... .......... .......... .......... .......... 99%  124M 1s
    2694900K .......... .......... .......... .......... .......... 99%  119M 1s
    2694950K .......... .......... .......... .......... .......... 99%  160M 1s
    2695000K .......... .......... .......... .......... .......... 99%  209M 1s
    2695050K .......... .......... .......... .......... .......... 99%  184M 1s
    2695100K .......... .......... .......... .......... .......... 99% 26.5M 1s
    2695150K .......... .......... .......... .......... .......... 99% 94.8M 1s
    2695200K .......... .......... .......... .......... .......... 99% 92.9M 1s
    2695250K .......... .......... .......... .......... .......... 99%  149M 1s
    2695300K .......... .......... .......... .......... .......... 99% 1.05M 1s
    2695350K .......... .......... .......... .......... .......... 99%  434K 1s
    2695400K .......... .......... .......... .......... .......... 99% 71.4M 1s
    2695450K .......... .......... .......... .......... .......... 99%  131M 1s
    2695500K .......... .......... .......... .......... .......... 99%  174M 1s
    2695550K .......... .......... .......... .......... .......... 99% 44.6M 1s
    2695600K .......... .......... .......... .......... .......... 99%  100M 1s
    2695650K .......... .......... .......... .......... .......... 99%  126M 1s
    2695700K .......... .......... .......... .......... .......... 99%  108M 1s
    2695750K .......... .......... .......... .......... .......... 99%  107M 1s
    2695800K .......... .......... .......... .......... .......... 99%  112M 1s
    2695850K .......... .......... .......... .......... .......... 99%  135M 1s
    2695900K .......... .......... .......... .......... .......... 99%  127M 1s
    2695950K .......... .......... .......... .......... .......... 99%  152M 1s
    2696000K .......... .......... .......... .......... .......... 99%  118M 1s
    2696050K .......... .......... .......... .......... .......... 99%  152M 1s
    2696100K .......... .......... .......... .......... .......... 99%  121M 1s
    2696150K .......... .......... .......... .......... .......... 99%  133M 1s
    2696200K .......... .......... .......... .......... .......... 99%  133M 1s
    2696250K .......... .......... .......... .......... .......... 99%  130M 1s
    2696300K .......... .......... .......... .......... .......... 99% 8.36M 0s
    2696350K .......... .......... .......... .......... .......... 99% 92.0M 0s
    2696400K .......... .......... .......... .......... .......... 99%  134M 0s
    2696450K .......... .......... .......... .......... .......... 99%  142M 0s
    2696500K .......... .......... .......... .......... .......... 99%  553K 0s
    2696550K .......... .......... .......... .......... .......... 99%  747K 0s
    2696600K .......... .......... .......... .......... .......... 99% 62.7M 0s
    2696650K .......... .......... .......... .......... .......... 99%  202M 0s
    2696700K .......... .......... .......... .......... .......... 99%  126M 0s
    2696750K .......... .......... .......... .......... .......... 99% 44.3M 0s
    2696800K .......... .......... .......... .......... .......... 99%  108M 0s
    2696850K .......... .......... .......... .......... .......... 99% 98.3M 0s
    2696900K .......... .......... .......... .......... .......... 99%  102M 0s
    2696950K .......... .......... .......... .......... .......... 99%  145M 0s
    2697000K .......... .......... .......... .......... .......... 99%  101M 0s
    2697050K .......... .......... .......... .......... .......... 99%  154M 0s
    2697100K .......... .......... .......... .......... .......... 99%  125M 0s
    2697150K .......... .......... .......... .......... .......... 99%  105M 0s
    2697200K .......... .......... .......... .......... .......... 99%  101M 0s
    2697250K .......... .......... .......... .......... .......... 99%  131M 0s
    2697300K .......... .......... .......... .......... .......... 99%  118M 0s
    2697350K .......... .......... .......... .......... .......... 99%  115M 0s
    2697400K .......... .......... .......... .......... .......... 99%  102M 0s
    2697450K .......... .......... .......... .......... .......... 99% 9.29M 0s
    2697500K .......... .......... .......... .......... .......... 99% 85.8M 0s
    2697550K .......... .......... .......... .......... .......... 99%  156M 0s
    2697600K .......... .......... .......... .......... .......... 99%  137M 0s
    2697650K .......... .......... .......... .......... .......... 99%  169M 0s
    2697700K .......... .......... .......... .......... .......... 99%  553K 0s
    2697750K .......... .......... .......... .......... .......... 99%  748K 0s
    2697800K .......... .......... .......... .......... .......... 99% 48.7M 0s
    2697850K .......... .......... .......... .......... .......... 99%  126M 0s
    2697900K .......... .......... .......... .......... .......... 99%  147M 0s
    2697950K .......... .......... .......... .......... .......... 99% 49.3M 0s
    2698000K .......... .......... .......... .......... .......... 99%  151M 0s
    2698050K .......... .......... .......... .......... .......... 99%  174M 0s
    2698100K .......... .......... .......... .......... .......... 99%  162M 0s
    2698150K .......... .......... .......... .......... .......... 99%  142M 0s
    2698200K .......... .......... .......... .......... .......... 99%  143M 0s
    2698250K .......... .......... .......... .......... .......... 99%  135M 0s
    2698300K .......... .......... .......... .......... .......... 99%  172M 0s
    2698350K .......... .......... .......... .......... .......... 99%  169M 0s
    2698400K .......... .......... .......... .......... .......... 99%  118M 0s
    2698450K .......... .......... .......... .......... .......... 99%  151M 0s
    2698500K .......... .......... .......... .......... .......... 99%  136M 0s
    2698550K .......... .......... .......... .......... .......... 99%  102M 0s
    2698600K .......... .......... .......... .......... .......... 99%  113M 0s
    2698650K .......... .......... .......... .......... .......... 99%  112M 0s
    2698700K .......... .......... .......... .......... .......... 99% 7.81M 0s
    2698750K .......... .......... .......... .......... .......... 99% 62.8M 0s
    2698800K .......... .......... .......... .......... .......... 99%  128M 0s
    2698850K .......... .......... .......... .......... .......... 99%  138M 0s
    2698900K .......... .......... .......... .......... .......... 99%  587K 0s
    2698950K .......... .......... .......... .......... .......... 99%  699K 0s
    2699000K .......... .......... .......... .......... .......... 99% 45.4M 0s
    2699050K .......... .......... .......... .......... .......... 99%  125M 0s
    2699100K .......... .......... .......... .......... .......... 99%  126M 0s
    2699150K .......... .......... .......... .......... .......... 99% 50.8M 0s
    2699200K .......... .......... .......... .......... .......... 99%  128M 0s
    2699250K .......... .......... .......... .......... ......... 100%  129M=7m37s

    2020-12-08 10:44:12 (5.77 MB/s) - ‘hls4ml_LHCjet_100p_train.tar.gz.1’ saved [2764083152/2764083152]

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` sh
pip install tables
```

<div class="output execute_result plain_result" execution_count="1">

    Collecting tables
      Downloading tables-3.6.1-cp37-cp37m-manylinux1_x86_64.whl (4.3 MB)
    Requirement already satisfied: numpy>=1.9.3 in /databricks/python3/lib/python3.7/site-packages (from tables) (1.18.1)
    Collecting numexpr>=2.6.2
      Downloading numexpr-2.7.1-cp37-cp37m-manylinux1_x86_64.whl (162 kB)
    Installing collected packages: numexpr, tables
    Successfully installed numexpr-2.7.1 tables-3.6.1
    WARNING: You are using pip version 20.0.2; however, version 20.3.1 is available.
    You should consider upgrading via the '/databricks/python3/bin/python3.7 -m pip install --upgrade pip' command.

</div>

</div>

<div class="cell code" execution_count="1" scrolled="true">

``` python
import h5py
import pandas as pd
## BOOKMARK FROM HERE IMPORTANT
import pyarrow as pa
import pyarrow.parquet as pq
## TO HERE
import glob

fps = glob.glob('train/*.h5')
all_key_sets = [h5py.File(fp, 'r').keys() for fp in fps]
all_keys = set().union(*all_key_sets)

print("Ignoring due to missing keys in:", [(fp, k) for fp,k in zip(fps, all_key_sets) if k != all_keys])

data_keys = ['jetImageHCAL', 'jetConstituentList', 'jetImage', 'jetImageECAL', 'jets']
name_keys = ['particleFeatureNames', 'jetFeatureNames']

assert(all_keys == set().union(data_keys, name_keys))

fps = [fp for fp,k in zip(fps, all_key_sets) if k == all_keys]

def get_unique(xs):
  x0 = next(xs)
  assert(x == x0 for x in xs)
  return x0

jetFeatureNames = [k.decode() for k in get_unique(h5py.File(fp, 'r')['jetFeatureNames'][:] for fp in fps)]
particleFeatureNames = [k.decode() for k in get_unique(h5py.File(fp, 'r')['particleFeatureNames'][:] for fp in fps)[:-1]]

## Initialise writer based on first result
writer = None

for fp in fps:
  print("Processing: ", fp)
  
  ## for chunk in h5y.File(fp, 'r', chunksize) ... or similar
  
  f = h5py.File(fp, 'r')
  row_count = get_unique(f[k].shape[0] for k in data_keys)
  assert(row_count == 10000)
  
  ## 100x100 bitmap per row
  assert(f['jetImageHCAL'].shape == (row_count, 100, 100))
  
  ## 100x100 bitmap per row
  assert(f['jetImageECAL'].shape == (row_count, 100, 100))
  
  ## 100x100 bitmap per row
  assert(f['jetImage'].shape == (row_count, 100, 100))
  
  constituent_count = f['jetConstituentList'].shape[1]
  
  assert(f['jets'].shape == (row_count, len(jetFeatureNames)))
  assert(f['jetConstituentList'].shape == (row_count, constituent_count, len(particleFeatureNames)))
  
  ## Slow, but works...
  
  #jets = pa.Table.from_arrays([f['jets'][:,i] for i,k in enumerate(jetFeatureNames)], names=jetFeatureNames)
  #print(jets.schema)
  
  #particles = pa.Table.from_pydict({ k : [f['jetConstituentList'][:,j,i] for j in range(constituent_count)] for i,k in enumerate(particleFeatureNames) })
  #print(particles.schema)
  
  ## Messy and a bit slow, but couldn't coerce the API to do anything slicker
  data = { 'file' : [fp] * row_count, 'i' : range(row_count) }
  data.update({ k : list(f['jetConstituentList'][:,:,i]) for i,k in enumerate(particleFeatureNames) })
  data.update({ k : f['jets'][:,i] for i,k in enumerate(jetFeatureNames) })
  data.update({ 'jetImageHCAL' : list(f['jetImageHCAL'][:].reshape(row_count, -1)),
                'jetImageECAL' : list(f['jetImageECAL'][:].reshape(row_count, -1)),
                'jetImage'     : list(f['jetImage'][:].reshape(row_count, -1)) })

  data_table = pa.Table.from_pandas(pd.DataFrame(data))
  
  ## print(data_table['j1_px'])
  
  if writer is None:
    ## Initialise writer based on schema from first parsed data
    
    ## BOOKMARK FROM HERE IMPORTANT
    writer = pq.ParquetWriter('jetImage.parquet', data_table.schema)
    
  writer.write_table(data_table)
  
writer.close()

## TO HERE
```

<div class="output execute_result plain_result" execution_count="1">

    Ignoring due to missing keys in: [('train/jetImage_7_100p_0_10000.h5', <KeysViewHDF5 []>)]
    Processing:  train/jetImage_4_100p_10000_20000.h5
    Processing:  train/jetImage_1_100p_50000_60000.h5
    Processing:  train/jetImage_6_100p_40000_50000.h5
    Processing:  train/jetImage_1_100p_30000_40000.h5
    Processing:  train/jetImage_2_100p_70000_80000.h5
    Processing:  train/jetImage_4_100p_80000_90000.h5
    Processing:  train/jetImage_3_100p_80000_90000.h5
    Processing:  train/jetImage_3_100p_50000_60000.h5
    Processing:  train/jetImage_6_100p_0_10000.h5
    Processing:  train/jetImage_1_100p_70000_80000.h5
    Processing:  train/jetImage_5_100p_0_10000.h5
    Processing:  train/jetImage_0_100p_0_10000.h5
    Processing:  train/jetImage_1_100p_40000_50000.h5
    Processing:  train/jetImage_5_100p_10000_20000.h5
    Processing:  train/jetImage_6_100p_60000_70000.h5
    Processing:  train/jetImage_6_100p_50000_60000.h5
    Processing:  train/jetImage_5_100p_20000_30000.h5
    Processing:  train/jetImage_5_100p_30000_40000.h5
    Processing:  train/jetImage_7_100p_20000_30000.h5
    Processing:  train/jetImage_3_100p_10000_20000.h5
    Processing:  train/jetImage_2_100p_40000_50000.h5
    Processing:  train/jetImage_0_100p_20000_30000.h5
    Processing:  train/jetImage_5_100p_80000_90000.h5
    Processing:  train/jetImage_2_100p_0_10000.h5
    Processing:  train/jetImage_2_100p_20000_30000.h5
    Processing:  train/jetImage_2_100p_60000_70000.h5
    Processing:  train/jetImage_4_100p_40000_50000.h5
    Processing:  train/jetImage_0_100p_80000_90000.h5
    Processing:  train/jetImage_4_100p_50000_60000.h5
    Processing:  train/jetImage_3_100p_30000_40000.h5
    Processing:  train/jetImage_0_100p_30000_40000.h5
    Processing:  train/jetImage_0_100p_70000_80000.h5
    Processing:  train/jetImage_2_100p_30000_40000.h5
    Processing:  train/jetImage_0_100p_40000_50000.h5
    Processing:  train/jetImage_1_100p_0_10000.h5
    Processing:  train/jetImage_3_100p_60000_70000.h5
    Processing:  train/jetImage_6_100p_10000_20000.h5
    Processing:  train/jetImage_6_100p_30000_40000.h5
    Processing:  train/jetImage_0_100p_60000_70000.h5
    Processing:  train/jetImage_1_100p_80000_90000.h5
    Processing:  train/jetImage_5_100p_40000_50000.h5
    Processing:  train/jetImage_3_100p_0_10000.h5
    Processing:  train/jetImage_0_100p_50000_60000.h5
    Processing:  train/jetImage_5_100p_60000_70000.h5
    Processing:  train/jetImage_6_100p_20000_30000.h5
    Processing:  train/jetImage_4_100p_20000_30000.h5
    Processing:  train/jetImage_4_100p_30000_40000.h5
    Processing:  train/jetImage_3_100p_40000_50000.h5
    Processing:  train/jetImage_4_100p_60000_70000.h5
    Processing:  train/jetImage_6_100p_80000_90000.h5
    Processing:  train/jetImage_3_100p_70000_80000.h5
    Processing:  train/jetImage_5_100p_50000_60000.h5
    Processing:  train/jetImage_2_100p_50000_60000.h5
    Processing:  train/jetImage_4_100p_70000_80000.h5
    Processing:  train/jetImage_2_100p_80000_90000.h5
    Processing:  train/jetImage_1_100p_20000_30000.h5
    Processing:  train/jetImage_1_100p_60000_70000.h5
    Processing:  train/jetImage_2_100p_10000_20000.h5
    Processing:  train/jetImage_5_100p_70000_80000.h5
    Processing:  train/jetImage_0_100p_10000_20000.h5
    Processing:  train/jetImage_1_100p_10000_20000.h5
    Processing:  train/jetImage_3_100p_20000_30000.h5
    Processing:  train/jetImage_4_100p_0_10000.h5

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` sh
ls -lh jetImage.parquet
pwd
```

<div class="output execute_result plain_result" execution_count="1">

    -rw-r--r-- 1 root root 6.6G Dec  4 14:21 jetImage.parquet
    /databricks/driver

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` sh
zcat hls4ml_LHCjet_100p_train.tar.gz | file -
```

<div class="output execute_result plain_result" execution_count="1">

    /dev/stdin: POSIX tar archive (GNU)

</div>

</div>

<div class="cell markdown">

I am going to download locally and see what's up... In the mean time have a read through the links in notebook `03_...` in this directory.. Raaz

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` fs
ls /datasets/physics/LHC/
```

<div class="output execute_result tabular_result" execution_count="1">

<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/datasets/physics/LHC/</td>
<td>LHC/</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
dbutils.fs.cp("file:////databricks/driver/jetImage.parquet", "dbfs:///datasets/physics/LHC/hls4ml_LHCjet_100p/", recurse=true)
```

<div class="output execute_result plain_result" execution_count="1">

    res1: Boolean = true

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
dbutils.fs.mv("dbfs:///datasets/physics/LHC/hls4ml_LHCjet_100p", "dbfs:///datasets/physics/LHC/hls4ml_LHCjet_100p.parquet")
```

<div class="output execute_result plain_result" execution_count="1">

    res6: Boolean = true

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
sqlContext.read.parquet("dbfs:///datasets/physics/LHC/hls4ml_LHCjet_100p.parquet").groupBy("file").count().collect()
```

<div class="output execute_result plain_result" execution_count="1">

    res16: Array[org.apache.spark.sql.Row] = Array([train/jetImage_2_100p_40000_50000.h5,10000], [train/jetImage_2_100p_0_10000.h5,10000], [train/jetImage_5_100p_80000_90000.h5,10000], [train/jetImage_0_100p_20000_30000.h5,10000], [train/jetImage_0_100p_70000_80000.h5,10000], [train/jetImage_3_100p_30000_40000.h5,10000], [train/jetImage_0_100p_30000_40000.h5,10000], [train/jetImage_4_100p_50000_60000.h5,10000], [train/jetImage_4_100p_10000_20000.h5,10000], [train/jetImage_1_100p_30000_40000.h5,10000], [train/jetImage_6_100p_40000_50000.h5,10000], [train/jetImage_1_100p_50000_60000.h5,10000], [train/jetImage_6_100p_50000_60000.h5,10000], [train/jetImage_5_100p_10000_20000.h5,10000], [train/jetImage_1_100p_40000_50000.h5,10000], [train/jetImage_6_100p_60000_70000.h5,10000], [train/jetImage_3_100p_60000_70000.h5,10000], [train/jetImage_0_100p_60000_70000.h5,10000], [train/jetImage_6_100p_30000_40000.h5,10000], [train/jetImage_6_100p_10000_20000.h5,10000], [train/jetImage_5_100p_40000_50000.h5,10000], [train/jetImage_1_100p_80000_90000.h5,10000], [train/jetImage_0_100p_50000_60000.h5,10000], [train/jetImage_3_100p_0_10000.h5,10000], [train/jetImage_5_100p_20000_30000.h5,10000], [train/jetImage_3_100p_10000_20000.h5,10000], [train/jetImage_5_100p_30000_40000.h5,10000], [train/jetImage_7_100p_20000_30000.h5,10000], [train/jetImage_2_100p_30000_40000.h5,10000], [train/jetImage_0_100p_40000_50000.h5,10000], [train/jetImage_1_100p_0_10000.h5,10000], [train/jetImage_4_100p_80000_90000.h5,10000], [train/jetImage_3_100p_50000_60000.h5,10000], [train/jetImage_3_100p_80000_90000.h5,10000], [train/jetImage_2_100p_70000_80000.h5,10000], [train/jetImage_4_100p_30000_40000.h5,10000], [train/jetImage_5_100p_60000_70000.h5,10000], [train/jetImage_4_100p_20000_30000.h5,10000], [train/jetImage_6_100p_20000_30000.h5,10000], [train/jetImage_3_100p_40000_50000.h5,10000], [train/jetImage_6_100p_80000_90000.h5,10000], [train/jetImage_3_100p_70000_80000.h5,10000], [train/jetImage_4_100p_60000_70000.h5,10000], [train/jetImage_4_100p_40000_50000.h5,10000], [train/jetImage_0_100p_80000_90000.h5,10000], [train/jetImage_2_100p_20000_30000.h5,10000], [train/jetImage_2_100p_60000_70000.h5,10000], [train/jetImage_2_100p_50000_60000.h5,10000], [train/jetImage_5_100p_50000_60000.h5,10000], [train/jetImage_2_100p_80000_90000.h5,10000], [train/jetImage_4_100p_70000_80000.h5,10000], [train/jetImage_6_100p_0_10000.h5,10000], [train/jetImage_5_100p_0_10000.h5,10000], [train/jetImage_0_100p_0_10000.h5,10000], [train/jetImage_1_100p_70000_80000.h5,10000], [train/jetImage_1_100p_20000_30000.h5,10000], [train/jetImage_1_100p_60000_70000.h5,10000], [train/jetImage_5_100p_70000_80000.h5,10000], [train/jetImage_2_100p_10000_20000.h5,10000], [train/jetImage_0_100p_10000_20000.h5,10000], [train/jetImage_3_100p_20000_30000.h5,10000], [train/jetImage_1_100p_10000_20000.h5,10000], [train/jetImage_4_100p_0_10000.h5,10000])

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
dbutils.fs.cp("file:////databricks/driver/hls4ml_LHCjet_100p_train.tar.gz","dbfs:///datasets/physics/LHC/")
```

<div class="output execute_result plain_result" execution_count="1">

    res1: Boolean = true

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` fs
ls /datasets/physics/LHC/
```

<div class="output execute_result tabular_result" execution_count="1">

<table>
<thead>
<tr class="header">
<th>path</th>
<th>name</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dbfs:/datasets/physics/LHC/hls4ml_LHCjet_100p_train.tar.gz</td>
<td>hls4ml_LHCjet_100p_train.tar.gz</td>
<td>2.764083152e9</td>
</tr>
</tbody>
</table>

</div>

</div>

<div class="cell markdown">

At least the file is in dbfs

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
val possiblyMalformedInput = sc.textFile("dbfs:/datasets/physics/LHC/hls4ml_LHCjet_100p_train.tar.gz")
```

<div class="output execute_result plain_result" execution_count="1">

    possiblyMalformedInput: org.apache.spark.rdd.RDD[String] = dbfs:/datasets/physics/LHC/hls4ml_LHCjet_100p_train.tar.gz MapPartitionsRDD[71] at textFile at command-738986526041468:1

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
possiblyMalformedInput.count // so it reads the lines fine
```

<div class="output execute_result plain_result" execution_count="1">

    res3: Long = 17498163

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
possiblyMalformedInput.take(1) // this is not compressed text, but hdf format... so google search (perhapos in incognito in chrome or private mode in firefox) for 
```

<div class="output execute_result plain_result" execution_count="1">

    res4: Array[String] = Array(train/jetImage_0_100p_0_10000.h5????????????????????????????????????????????????????????????????????0000644?0310007?0005316?00270271115?13605363745?015142? 0????????????????????????????????????????????????????????????????????????????????????????????????????ustar  ?dshep???????????????????????????def-cg?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????�HDF)

</div>

</div>

<div class="cell markdown">

google search returned

-   first try: https://forums.databricks.com/questions/22178/how-to-parse-hdf5-file-using-sparkreadformat.html
-   deeped dive if needed: https://www.hdfgroup.org/2015/03/from-hdf5-datasets-to-apache-spark-rdds/
-   etc

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
import org.hdfgroup.spark.hdf5._ 
import org.apache.spark.sql.SparkSession 
//val spark = SparkSession.builder().appName("Spark SQL HDF5").getOrCreate()

val df=spark.read.option("extension", "he5").option("recursion", "false").hdf5("/tmp/", "dbfs:/datasets/physics/LHC/hls4ml_LHCjet_100p_train.tar.gz")

df.show()
```

</div>

<div class="cell markdown">

Looks like libraries are needed... One need to recall how the HDF5 connector works and how these files are organized... Raaz

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` python
# try from here ...for mixing python and scala cell-specifically
1+1
```

</div>

<div class="cell markdown">

Parquet-ing the already processed h5 files.

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
dbutils.fs.ls("dbfs:///FileStore/06_LHC")
```

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
dbutils.fs.cp("dbfs:///FileStore/06_LHC", "file:////databricks/driver/06_LHC", recurse=true)
```

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` sh
ls
```

<div class="output execute_result plain_result" execution_count="1">

    conf
    derby.log
    eventlogs
    logs

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` python
import h5py
import pandas as pd
## BOOKMARK FROM HERE IMPORTANT
import pyarrow as pa
import pyarrow.parquet as pq

def get_unique(xs):
  x0 = next(xs)
  assert(x == x0 for x in xs)
  return x0

f = h5py.File('06_LHC/h5/train_multi_20v_100P.h5', 'r')
data_keys =list(f.keys())
row_count = get_unique(f[k].shape[0] for k in data_keys)
#print(len(data_keys))

data = { data_keys[0] : list(f[data_keys[0]][:].reshape(row_count,-1)),
         data_keys[1] : list(f[data_keys[1]][:].reshape(row_count,-1)),
         data_keys[2] : list(f[data_keys[2]][:].reshape(row_count,-1)),
         data_keys[3] : list(f[data_keys[3]][:]),
         data_keys[4] : list(f[data_keys[4]][:])}
data_table = pa.Table.from_pandas(pd.DataFrame(data))
writer = None
if writer is None:
  writer = pq.ParquetWriter('train.parquet', data_table.schema)
  
writer.write_table(data_table)
  
writer.close()

f = h5py.File('06_LHC/h5/test_multi_20v_100P.h5', 'r')
data_keys =list(f.keys())
row_count = get_unique(f[k].shape[0] for k in data_keys)
#print(len(data_keys))

data = { data_keys[0] : list(f[data_keys[0]][:].reshape(row_count,-1)),
         data_keys[1] : list(f[data_keys[1]][:].reshape(row_count,-1)),
         data_keys[2] : list(f[data_keys[2]][:].reshape(row_count,-1)),
         data_keys[3] : list(f[data_keys[3]][:]),
         data_keys[4] : list(f[data_keys[4]][:])}
data_table = pa.Table.from_pandas(pd.DataFrame(data))
writer = None
if writer is None:
  writer = pq.ParquetWriter('test.parquet', data_table.schema)
  
writer.write_table(data_table)
  
writer.close()
```

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
dbutils.fs.cp("file:////databricks/driver/train.parquet", "dbfs:///datasets/physics/LHC/train/", recurse=true)
dbutils.fs.cp("file:////databricks/driver/test.parquet", "dbfs:///datasets/physics/LHC/test/", recurse=true)
```

<div class="output execute_result plain_result" execution_count="1">

    res1: Boolean = true

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
dbutils.fs.mv("dbfs:///datasets/physics/LHC/train", "dbfs:///datasets/physics/LHC/train.parquet")
dbutils.fs.mv("dbfs:///datasets/physics/LHC/test", "dbfs:///datasets/physics/LHC/test.parquet")
```

<div class="output execute_result plain_result" execution_count="1">

    res2: Boolean = true

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` sh
mv train.parquet 06_LHC
mv test.parquet 06_LHC
```

</div>

<div class="cell markdown">

Preparing data for test

OK THIS WASN'T SO EASY.... ARRAYS NEED TO BE RESHAPED INTO LISTS. SO READING FROM PARQUET WILL BE COMPLICATED. BEGGING THE QUESTION.... WHY BOTHER???

</div>

<div class="cell code" execution_count="1" scrolled="true">

``` sh
pip install tensorflow==1.15 
```

<div class="output execute_result plain_result" execution_count="1">

    Collecting tensorflow==1.15
      Downloading tensorflow-1.15.0-cp37-cp37m-manylinux2010_x86_64.whl (412.3 MB)
    Collecting tensorboard<1.16.0,>=1.15.0
      Downloading tensorboard-1.15.0-py3-none-any.whl (3.8 MB)
    Collecting termcolor>=1.1.0
      Downloading termcolor-1.1.0.tar.gz (3.9 kB)
    Collecting protobuf>=3.6.1
      Downloading protobuf-3.14.0-cp37-cp37m-manylinux1_x86_64.whl (1.0 MB)
    Collecting gast==0.2.2
      Downloading gast-0.2.2.tar.gz (10 kB)
    Collecting keras-applications>=1.0.8
      Downloading Keras_Applications-1.0.8-py3-none-any.whl (50 kB)
    Collecting wrapt>=1.11.1
      Downloading wrapt-1.12.1.tar.gz (27 kB)
    Collecting absl-py>=0.7.0
      Downloading absl_py-0.11.0-py3-none-any.whl (127 kB)
    Collecting opt-einsum>=2.3.2
      Downloading opt_einsum-3.3.0-py3-none-any.whl (65 kB)
    Requirement already satisfied: six>=1.10.0 in /databricks/python3/lib/python3.7/site-packages (from tensorflow==1.15) (1.14.0)
    Requirement already satisfied: wheel>=0.26 in /databricks/python3/lib/python3.7/site-packages (from tensorflow==1.15) (0.34.2)
    Collecting keras-preprocessing>=1.0.5
      Downloading Keras_Preprocessing-1.1.2-py2.py3-none-any.whl (42 kB)
    Collecting google-pasta>=0.1.6
      Downloading google_pasta-0.2.0-py3-none-any.whl (57 kB)
    Collecting astor>=0.6.0
      Downloading astor-0.8.1-py2.py3-none-any.whl (27 kB)
    Collecting grpcio>=1.8.6
      Downloading grpcio-1.34.0-cp37-cp37m-manylinux2014_x86_64.whl (3.9 MB)
    Requirement already satisfied: numpy<2.0,>=1.16.0 in /databricks/python3/lib/python3.7/site-packages (from tensorflow==1.15) (1.18.1)
    Collecting tensorflow-estimator==1.15.1
      Downloading tensorflow_estimator-1.15.1-py2.py3-none-any.whl (503 kB)
    Collecting markdown>=2.6.8
      Downloading Markdown-3.3.3-py3-none-any.whl (96 kB)
    Collecting werkzeug>=0.11.15
      Downloading Werkzeug-1.0.1-py2.py3-none-any.whl (298 kB)
    Requirement already satisfied: setuptools>=41.0.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard<1.16.0,>=1.15.0->tensorflow==1.15) (45.2.0)
    Collecting h5py
      Downloading h5py-3.1.0-cp37-cp37m-manylinux1_x86_64.whl (4.0 MB)
    Collecting importlib-metadata; python_version < "3.8"
      Downloading importlib_metadata-3.1.1-py3-none-any.whl (9.6 kB)
    Collecting cached-property; python_version < "3.8"
      Downloading cached_property-1.5.2-py2.py3-none-any.whl (7.6 kB)
    Collecting zipp>=0.5
      Downloading zipp-3.4.0-py3-none-any.whl (5.2 kB)
    Building wheels for collected packages: termcolor, gast, wrapt
      Building wheel for termcolor (setup.py): started
      Building wheel for termcolor (setup.py): finished with status 'done'
      Created wheel for termcolor: filename=termcolor-1.1.0-py3-none-any.whl size=4830 sha256=7f7b1093b1e1a4db8723f6d7d8f1f7cc74bbe2a24115c4364fe2011c918333d6
      Stored in directory: /root/.cache/pip/wheels/3f/e3/ec/8a8336ff196023622fbcb36de0c5a5c218cbb24111d1d4c7f2
      Building wheel for gast (setup.py): started
      Building wheel for gast (setup.py): finished with status 'done'
      Created wheel for gast: filename=gast-0.2.2-py3-none-any.whl size=7539 sha256=9bdba73c820b9a007a4822b1d7c02afc0cfcd24ea63e362e31403b0a916d0b85
      Stored in directory: /root/.cache/pip/wheels/21/7f/02/420f32a803f7d0967b48dd823da3f558c5166991bfd204eef3
      Building wheel for wrapt (setup.py): started
      Building wheel for wrapt (setup.py): finished with status 'done'
      Created wheel for wrapt: filename=wrapt-1.12.1-cp37-cp37m-linux_x86_64.whl size=68653 sha256=d268cc348b28d04df96d2f7470cab7408a0756fc068700c30d2d6d92d055e217
      Stored in directory: /root/.cache/pip/wheels/62/76/4c/aa25851149f3f6d9785f6c869387ad82b3fd37582fa8147ac6
    Successfully built termcolor gast wrapt
    Installing collected packages: absl-py, zipp, importlib-metadata, markdown, protobuf, werkzeug, grpcio, tensorboard, termcolor, gast, cached-property, h5py, keras-applications, wrapt, opt-einsum, keras-preprocessing, google-pasta, astor, tensorflow-estimator, tensorflow
    Successfully installed absl-py-0.11.0 astor-0.8.1 cached-property-1.5.2 gast-0.2.2 google-pasta-0.2.0 grpcio-1.34.0 h5py-3.1.0 importlib-metadata-3.1.1 keras-applications-1.0.8 keras-preprocessing-1.1.2 markdown-3.3.3 opt-einsum-3.3.0 protobuf-3.14.0 tensorboard-1.15.0 tensorflow-1.15.0 tensorflow-estimator-1.15.1 termcolor-1.1.0 werkzeug-1.0.1 wrapt-1.12.1 zipp-3.4.0
    WARNING: You are using pip version 20.0.2; however, version 20.3.1 is available.
    You should consider upgrading via the '/databricks/python3/bin/python3.7 -m pip install --upgrade pip' command.

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` python
from tensorflow import keras

rank = 0
size= 1

(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data('MNIST-data-%d' % rank)

x_train = x_train[rank::size]

y_train = y_train[rank::size]

x_test = x_test[rank::size]

y_test = y_test[rank::size]

x_train = x_train.reshape(x_train.shape[0], 28, 28, 1)

x_test = x_test.reshape(x_test.shape[0], 28, 28, 1)

x_train = x_train.astype('float32')

x_test = x_test.astype('float32')

x_train /= 255

x_test /= 255

#y_train = keras.utils.to_categorical(y_train, num_classes)

#y_test = keras.utils.to_categorical(y_test, num_classes)
```

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` python
x_test.shape
```

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` python
import pandas as pd
## BOOKMARK FROM HERE IMPORTANT
import pyarrow as pa
import pyarrow.parquet as pq

def get_unique(xs):
  x0 = next(xs)
  assert(x == x0 for x in xs)
  return x0

#print(len(data_keys))

data = { 'x_train' : x_train,
         'y_train' : y_train}

data_table = pa.Table.from_pandas(pd.DataFrame(data))
writer = None
if writer is None:
  writer = pq.ParquetWriter('horovod_data_train.parquet', data_table.schema)
  
writer.write_table(data_table)
  
writer.close()

data = { 'x_test' : x_test,
         'y_test' : y_test}

data_table = pa.Table.from_pandas(pd.DataFrame(data))
writer = None
if writer is None:
  writer = pq.ParquetWriter('horovod_data_test.parquet', data_table.schema)
  
writer.write_table(data_table)
  
writer.close()
```

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
dbutils.fs.cp("file:////databricks/driver/horovod_data_train.parquet", "dbfs:///datasets/physics/LHC/horovod_data_train/", recurse=true)
dbutils.fs.cp("file:////databricks/driver/horovod_data_test.parquet", "dbfs:///datasets/physics/LHC/horovod_data_test/", recurse=true)
```

<div class="output execute_result plain_result" execution_count="1">

    res7: Boolean = true

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` scala
dbutils.fs.mv("dbfs:///datasets/physics/LHC/horovod_data_train", "dbfs:///datasets/physics/LHC/horovod_data_train.parquet")
dbutils.fs.mv("dbfs:///datasets/physics/LHC/horovod_data_test", "dbfs:///datasets/physics/LHC/horovod_data_test.parquet")
```

<div class="output execute_result plain_result" execution_count="1">

    res8: Boolean = true

</div>

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` python
pq.read_table('horovod_data_test.parquet', columns=['x_test'])
```

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` python
new_x_test
```

</div>

<div class="cell code" execution_count="1" scrolled="false">

``` python
import numpy as np
x_test
```

</div>

<div class="cell code" execution_count="1" scrolled="false">

</div>
